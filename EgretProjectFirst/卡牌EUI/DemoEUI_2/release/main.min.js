var AssetAdapter=function(){function e(){}var t=(__define,e),s=t.prototype;return s.getAsset=function(e,t,s){function i(i){t.call(s,i,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?i(n):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function e(){}var t=(__define,e),s=t.prototype;return s.getTheme=function(e,t,s,i){function n(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),s.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var GameEvents=function(){function e(){}var t=(__define,e);t.prototype;return e.EVT_RETURN="EVT_RETURN",e.EVT_LOAD_PAGE="EVT_LOAD_PAGE",e.EVT_CLOSE_ABOUT="EVT_CLOSE_ABOUT",e}();egret.registerClass(GameEvents,"GameEvents");var GamePages=function(){function e(){}var t=(__define,e);t.prototype;return e.PROFILE="profile",e.HEROS="heros",e.GOODS="goods",e.ABOUT="about",e.HOME="home",e}();egret.registerClass(GamePages,"GamePages");var HomeUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/homeUISkin.exml"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.uiCompHandler=function(){console.log("HomeUI uiCompHandler"),this.mbtnProfile.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbtnHandler,this),this.mbtnHeros.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbtnHandler,this),this.mbtnGoods.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbtnHandler,this),this.mbtnAbout.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbtnHandler,this),this.btns=[this.mbtnProfile,this.mbtnHeros,this.mbtnGoods,this.mbtnAbout],this.goHome()},i.resetFocus=function(){console.log(" resetFocus "),this._uiFocused&&(this._uiFocused.parent&&this._uiFocused.parent.removeChild(this._uiFocused),this._uiFocused=null),null!=this._mbtnFocused&&(this._mbtnFocused.selected=!1,this._mbtnFocused.enabled=!0,this._mbtnFocused=null)},i.goHome=function(){console.log(" ---------- HOME ---------- "),this._pageFocusedPrev=this._pageFocused=GamePages.HOME,this.imgBg.source="homeBg_jpg"},i.mbtnHandler=function(e){if(e.currentTarget==this._mbtnFocused)return void console.log(e.currentTarget.name,"已经选中不应当再处理!");for(var t=this.btns.length-1;t>-1;--t)this.btns[t].enabled=!1;switch(this._mbtnFocused&&(this._mbtnFocused.selected=!1,this._mbtnFocused.enabled=!0),this._uiFocused&&this._uiFocused.parent&&this._uiFocused.parent.removeChild(this._uiFocused),this._mbtnFocused=e.currentTarget,console.log("选中",this._mbtnFocused.name),this._mbtnFocused.enabled=!1,this._uiFocused=null,this._pageFocusedPrev=this._pageFocused,this._mbtnFocused){case this.mbtnProfile:this._pageFocused=GamePages.PROFILE;break;case this.mbtnHeros:this._pageFocused=GamePages.HEROS;break;case this.mbtnGoods:this._pageFocused=GamePages.GOODS;break;case this.mbtnAbout:this._pageFocused=GamePages.ABOUT}this.dispatchEventWith(GameEvents.EVT_LOAD_PAGE,!1,this._pageFocused)},i.createChildren=function(){e.prototype.createChildren.call(this)},i.pageReadyHandler=function(e){var t=this;console.log("页面就绪:",e);for(var s=this.btns.length-1;s>-1;--s)this.btns[s].enabled=!this.btns[s].selected;switch(e){case GamePages.PROFILE:this._profileUI||(this._profileUI=new ProfileUI,this._profileUI.addEventListener(GameEvents.EVT_RETURN,function(){t.resetFocus(),t.goHome()},this)),this.imgBg.source="commonBg_jpg",this._uiFocused=this._profileUI;break;case GamePages.HEROS:this._herosUI||(this._herosUI=new HerosUI,this._herosUI.addEventListener(GameEvents.EVT_RETURN,function(){t.resetFocus(),t.goHome()},this)),this.imgBg.source="bgListPage_jpg",this._uiFocused=this._herosUI;break;case GamePages.GOODS:this._goodsUI||(this._goodsUI=new GoodsUI,this._goodsUI.addEventListener(GameEvents.EVT_RETURN,function(){t.resetFocus(),t.goHome()},this)),this.imgBg.source="bgListPage_jpg",this._uiFocused=this._goodsUI;break;case GamePages.ABOUT:this._aboutUI||(this._aboutUI=new AboutUI,this._aboutUI.addEventListener(GameEvents.EVT_CLOSE_ABOUT,function(){switch(t.resetFocus(),console.log("关闭关于 返回:",t._pageFocusedPrev),t._pageFocusedPrev){case GamePages.PROFILE:t.mbtnProfile.selected=!0,t.mbtnProfile.dispatchEventWith(egret.TouchEvent.TOUCH_TAP);break;case GamePages.HEROS:t.mbtnHeros.selected=!0,t.mbtnHeros.dispatchEventWith(egret.TouchEvent.TOUCH_TAP);break;case GamePages.GOODS:t.mbtnGoods.selected=!0,t.mbtnGoods.dispatchEventWith(egret.TouchEvent.TOUCH_TAP)}},this)),this._uiFocused=this._aboutUI}this.addChildAt(this._uiFocused,this.getChildIndex(this.imgBg)+1)},t}(eui.Component);egret.registerClass(HomeUI,"HomeUI");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var s=(__define,t),i=s.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var s=(__define,t),i=s.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},i.onThemeLoadComplete=function(){console.log("theme load ok:",egret.getTimer()),this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(e){switch(e.groupName){case"loading":console.log("loading ok:",egret.getTimer()),this.loadingView.parent&&this.loadingView.parent.removeChild(this.loadingView),Toast.init(this,RES.getRes("toast-bg_png")),this._loadingBg=new egret.Bitmap(RES.getRes("loading_bg")),this.addChild(this._loadingBg),this._trueLoadingUI=new TrueLoadingUI,this.loadPage("home");break;case"home":console.log("home ok:",egret.getTimer()),this.isResourceLoadEnd=!0,this.createScene();break;default:console.log("	page["+e.groupName+"]ok:",egret.getTimer()),this.pageLoadedHandler(e.groupName)}},i.clearRESEvents=function(){},i.createScene=function(){console.log("createScene:",this.isThemeLoadEnd,this.isResourceLoadEnd),this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},i.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){switch(e.groupName){case"loading":this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal);break;default:this._trueLoadingUI.setProgress(e.itemsLoaded,e.itemsTotal)}},i.startCreateScene=function(){var e=this;console.log("this._trueLoadingUI.parent:",Boolean(this._trueLoadingUI.parent)),this.pageLoadedHandler("home"),this._loadingBg.parent&&this._loadingBg.parent.removeChild(this._loadingBg),this._homeUI=new HomeUI,this._homeUI.addEventListener(GameEvents.EVT_LOAD_PAGE,function(t){console.log("EVT_LOAD_PAGE:",t.data),e.loadPage(t.data)},this),this.addChild(this._homeUI)},i.loadPage=function(e){switch(this.addChild(this._trueLoadingUI),this.idLoading=e,e){case"heros":case"goods":RES.loadGroup("heros_goods");break;default:RES.loadGroup(e)}},i.pageLoadedHandler=function(e){"home"!=e&&this._homeUI.pageReadyHandler(this.idLoading),this._trueLoadingUI.parent&&this._trueLoadingUI.parent.removeChild(this._trueLoadingUI)},t}(eui.UILayer);egret.registerClass(Main,"Main");var AboutUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/aboutUISkin.exml"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.uiCompHandler=function(){var e=this;console.log("		AboutUI uiCompHandler"),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.dispatchEventWith(GameEvents.EVT_CLOSE_ABOUT)},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){e.stageX>94&&e.stageX<194&&e.stageY>314&&e.stageY<414&&Toast.launch("美术：刘国萍\n程序：王建文\n策划：范承鑫")},this)},t}(eui.Component);egret.registerClass(AboutUI,"AboutUI");var GoodsUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/goodsUISkin.exml"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.uiCompHandler=function(){var e=this;console.log("		GoodsUI uiCompHandler"),this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.dispatchEventWith(GameEvents.EVT_RETURN)},this);var t=[{icon:"goods01_png",goodsName:"魔法石",comment:"法力加成 +3"},{icon:"goods02_png",goodsName:"诅咒娃娃",comment:"咒术加成 +3"},{icon:"goods03_png",goodsName:"万圣戒指",comment:"敏捷加成 +3"},{icon:"goods04_png",goodsName:"斗篷",comment:"耐力加成 +3"},{icon:"goods05_png",goodsName:"鹅毛笔",comment:"精神加成 +3"},{icon:"goods06_png",goodsName:"血滴子",comment:"嗜血加成 +3"},{icon:"goods07_png",goodsName:"屠龙刀",comment:"力量加成 +5"}];this.listGoods.dataProvider=new eui.ArrayCollection(t),this.listGoods.itemRenderer=GoodsListIRSkin},i.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);egret.registerClass(GoodsUI,"GoodsUI");var GoodsListIRSkin=function(e){function t(){e.call(this),this.skinName="goodsListIRSkin"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.dataChanged=function(){},t}(eui.ItemRenderer);egret.registerClass(GoodsListIRSkin,"GoodsListIRSkin");var HerosUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/herosUISkin.exml"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.uiCompHandler=function(){var e=this;console.log("		HerosUI uiCompHandler"),this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.dispatchEventWith(GameEvents.EVT_RETURN)},this),this.btnOK.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){for(var t=e.listHeros.dataProvider,s=new Array,i=0;i<t.length;++i)t.getItemAt(i).checked&&s.push(t.getItemAt(i).heroName);s.length?Toast.launch("您选择了："+s.join(", ")):Toast.launch("你牛叉，一个也不选！"),e.dispatchEventWith(GameEvents.EVT_RETURN)},this);var t=[{icon:"heros01_png",heroName:"伊文捷琳",comment:"评价：樱桃小丸子",checked:!1},{icon:"heros02_png",heroName:"亚特伍德",comment:"评价：离了我你不行的",checked:!0},{icon:"heros03_png",heroName:"伊妮德",comment:"评价：猴子请来的逗比",checked:!1},{icon:"heros04_png",heroName:"鲁宾",comment:"评价：我勒个去",checked:!1},{icon:"heros05_png",heroName:"威弗列德",comment:"评价：这货碉堡了",checked:!1},{icon:"heros06_png",heroName:"史帝文",comment:"评价：咖啡不加糖",checked:!1},{icon:"heros07_png",heroName:"哈瑞斯",comment:"评价：猪一样的队友",checked:!1}];this.listHeros.dataProvider=new eui.ArrayCollection(t),this.listHeros.itemRenderer=HerosListIRSkin},i.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);egret.registerClass(HerosUI,"HerosUI");var HerosListIRSkin=function(e){function t(){e.call(this),this.skinName="herosListIRSkin"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.cb.addEventListener(egret.Event.CHANGE,function(){console.log("	Checkbox 变化:",t.data.checked),t.data.checked=t.cb.selected},this)},t}(eui.ItemRenderer);egret.registerClass(HerosListIRSkin,"HerosListIRSkin");var ProfileUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/profileUISkin.exml"}__extends(t,e);var s=(__define,t),i=s.prototype;return i.uiCompHandler=function(){var e=this;console.log("		ProfileUI uiCompHandler"),this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.dispatchEventWith(GameEvents.EVT_RETURN)},this);var t=[{icon:"skillIcon01_png",name:"旋龙幻杀"},{icon:"skillIcon02_png",name:"魔魂天咒"},{icon:"skillIcon03_png",name:"天魔舞"},{icon:"skillIcon04_png",name:"痴情咒"},{icon:"skillIcon05_png",name:"无间寂"},{icon:"skillIcon06_png",name:"霸天戮杀"},{icon:"skillIcon07_png",name:"灭魂狂飙"}];this.listSkills.itemRendererSkinName="profileSkillListIRSkin",this.listSkills.dataProvider=new eui.ArrayCollection(t)},i.createChildren=function(){e.prototype.createChildren.call(this),this.scrListSkills.horizontalScrollBar=null},t}(eui.Component);egret.registerClass(ProfileUI,"ProfileUI");var Toast=function(e){function t(s,i,n){var o=this;e.call(this),console.log("Toast:",s);var r=new egret.Bitmap(t._txtrToastBg);this.addChild(r);var a=new egret.TextField;a.multiline=!0,a.size=20,a.bold=!0,a.textColor=16777215,a.stroke=2,a.strokeColor=0,a.text=s,a.fontFamily="微软雅黑",a.textAlign=egret.HorizontalAlign.CENTER,a.width=.84*i,a.x=(t._txtrToastBg.textureWidth-a.width)/2,a.y=6,this.addChild(a),r.height=12+a.height,this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.x=.5*i,this.y=.618*n,this.alpha=0,egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){o.parent&&o.parent.removeChild(o)})}__extends(t,e);var s=(__define,t);s.prototype;return t.init=function(e,t){console.log("Toast.init",t),this._cont=e,this._txtrToastBg=t},t.launch=function(e){if(this._cont){var s=new t(e,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(s)}},t}(egret.DisplayObjectContainer);egret.registerClass(Toast,"Toast");var TrueLoadingUI=function(e){function t(){var t=this;e.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){t.hasEventListener(egret.Event.ENTER_FRAME)&&t.removeEventListener(egret.Event.ENTER_FRAME,t.runLoading,t)},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t.setProgress(0,1),t.addEventListener(egret.Event.ENTER_FRAME,t.runLoading,t)},this)}__extends(t,e);var s=(__define,t),i=s.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._loadingRun=new egret.Bitmap(RES.getRes("loading_run")),this.addChild(this._loadingRun),this._loadingRun.anchorOffsetX=.5*this._loadingRun.width,this._loadingRun.anchorOffsetY=.5*this._loadingRun.height,this._loadingRun.x=.5*this.stage.stageWidth,this._loadingRun.y=.5*this.stage.stageHeight,this._txProgress=new egret.TextField,this._txProgress.textAlign=egret.HorizontalAlign.CENTER,this._txProgress.verticalAlign=egret.VerticalAlign.MIDDLE,this._txProgress.x=.5*this.stage.stageWidth-100,this._txProgress.width=200,this._txProgress.y=.5*this.stage.stageHeight-100,this._txProgress.height=200,this._txProgress.size=14,this._txProgress.stroke=1,this._txProgress.strokeColor=0,this.addChild(this._txProgress)},i.runLoading=function(e){this._loadingRun.rotation+=3},i.setProgress=function(e,t){this._txProgress&&(this._txProgress.text=Math.round(e/t*100)+"%")},t}(eui.Group);egret.registerClass(TrueLoadingUI,"TrueLoadingUI");