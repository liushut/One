var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(a,o){function n(t){try{h(s.next(t))}catch(e){o(e)}}function r(t){try{h(s["throw"](t))}catch(e){o(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,r)}h((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,o&&(n=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,o=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(n=h.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){h.label=i[1];break}if(6===i[0]&&h.label<n[1]){h.label=n[1],n=i;break}if(n&&h.label<n[2]){h.label=n[2],h.ops.push(i);break}n[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(s){i=[6,s],o=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,o,n,r,h={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},ZJ;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.skinName=t.Util.getClassName(i)+"Skin",i}return __extends(i,e),i.prototype.onDestroy=function(){return 0},i}(eui.Component);t.ComponentBase=e,__reflect(e.prototype,"ZJ.ComponentBase",["eui.UIComponent","egret.DisplayObject"])}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setData=function(t){},e.prototype.show=function(){},e.prototype.onProgress=function(t,e){},e.prototype.onDestroy=function(){return t.prototype.onDestroy.call(this)},e}(t.ComponentBase);t.ViewBase=e,__reflect(e.prototype,"ZJ.ViewBase",["RES.PromiseTaskReporter"])}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=null),this.viewName="",this.layer=0,this.viewClass=null,this.viewName=t,this.layer=e,this.viewClass=i}return t}();t.UIData=e,__reflect(e.prototype,"ZJ.UIData")}(ZJ||(ZJ={}));var GameView=function(t){function e(){var e=t.call(this)||this;return e.FORCE_SCALE_X=2500,e.FORCE_SCALE_Y=1e3,e.BASKETBALL_SIZE=40,e.DOWN_BASKETBALL_ORIGIN_X=152,e.DOWN_BASKETBALL_ORIGIN_Y=1530,e.TOP_BASKETBALL_ORIGIN_X=152,e.TOP_BASKETBALL_ORIGIN_Y=1530,e.BASKETBALL_RESTITUTION=.6,e.BASKETBALL_FICTIONAIR=0,e.BASKETBALL_MASS=6.3,e.BASKETBALL_SHOT_CD_SINGLE=1e3,e.BASKETBALL_LABEL="BASKETBALL",e.SCORE_COLLIDER_TOP_LABEL="COLLIDER_TOP",e.SCORE_COLLIDER_MIDDLE_LABEL="COLLIDER_MIDDLE",e.SCORE_COLLIDER_BOTTOM_LABEL="COLLIDER_BOTTOM",e.EXTRA_POWER_LABEL="EXTRA_POWER",e.GROUND_LABEL="GROUND",e.PRE_G_CONSTANT=.043,e.PRE_PATH_CONSTANT=44,e.PRE_VELOC_CONSTANT=.06,e.BASKET_CANMOVE=!0,e.BASKET_MOVE_OFFSET_X=250,e.BASKET_MOVE_OFFSET_Y=250,e.BASKET_ORIGIN_X=650,e.BASKET_ORIGIN_Y=800,e.BASKET_LIMIT_MOVE_COUNT=0,e.BASKET_FIVEBALL_POS_MIN_X=500,e.BASKET_FIVEBALL_POS_MAX_X=700,e.BASKET_FIVEBALL_POS_MIN_Y=600,e.BASKET_FIVEBALL_POS_MAX_Y=800,e.BASKET_NORMAL_ROTATION=-3,e.BASKET_OFFSET_X=e.BASKETBALL_SIZE+20,e.BASKET_OFFSET_Y=3,e.BASKET_FRAME_WIDTH=2,e.BASKET_FRAME_HEIGHT=15,e.BASKET_MOVE_ANIMATE_TIME=200,e.BASKET_STAY_TIME_SINGLE=1e3,e.BASKET_STAY_TIME_DOUBLE=500,e.BASKET_STAY_TIME_COMPETITION=500,e.BASKET_LEFT_LABEL="BASKET_LEFT",e.BASKET_RIGHT_LABEL="BASKET_RIGHT",e.WIND_FORCE=7e-4,e.PATH_ALL_POINTS=50,e.PATH_POINTS_OFFSET=50,e.PLAYER_JUMP_HEIGHT=150,e.PLAYER_JUMP_TIME=300,e.SCENE_GROUP_ID=-2,e.SCENE_CATEGORY_ID=4,e.SCENE_MASK_ID=1,e.BALL_GROUP_ID=-1,e.BALL_CATEGORY_ID=1,e.BALL_MASK_ID=4,e.sqrt2_2=Math.pow(2,.5),e.sbBasketballOriginX=152,e.sbBasketballOriginY=1530,e.SB_FLAG="SB",e.isJumping=!1,e.myBasketballOriginX=152,e.myBasketballOriginY=1530,e.MINE_FLAG="MINE",e.netNodes=[],e.netNodeYs=[0,0,0,0],e.powerPos=[],e.lifeCount=3,e.extraPowerScoreFlag=0,e.score=0,e.myShotCombo=0,e.sbShotCombo=0,e.myScore=0,e.sbScore=0,e.gameTime=0,e.realGameTime=0,e.basketballImgs=[],e.basketballImgPoolWorkingRecord=[],e.sbBasketballImgs=[],e.sbBasketballImgPoolWorkingRecord=[],e.pathCircles=[],e.basketMovePathEndCircles=[],e.basketMovePathCircles=[],e.basketScored=!1,e.isWindy=!1,e.windDirection=0,e.basketballs={},e.ballCount=1,e.shotSuccessCount=0,e.useSeed=!1,e.myRandSeed=0,e.isTeaching=!1,e.isGameEnd=!1,e.timeOutIDs=[],e.netImageName="net_png",e.stageScaleType=0,e.scaleOffset=0,e.GS_OFFLINE_SINGLE=0,e.GS_ONLINE_SINGLE=1,e.GS_OFFLINE_DOUBLE=2,e.GS_ONLINE_DOUBLE=3,e.GS_OFFLINE_COMPETITION=4,e.GS_ONLINE_COMPETITION=5,e.GS_REPLAY=6,e.gameStyle=0,e.weekTopScore=-1,e.friendRank=-1,e.gameRank=-1,e.PVP_SHOT_DELAY_TIME=500,e.DOUBLE_GAME_TIME=0,e.CHANGE_POS_TIME=0,e.CHECK_SOCKET_TIME=5e3,e.SB_WAIT_TIME=2e4,e.BASKETBALL_SHOT_CD_DOUBLE=1e3,e.round=1,e.pvpSettleViewIsShown=!1,e.waitSbTimeoutID=0,e.MODE_ID=101,e.COMPETITION_SHOT_DELAY_TIME=500,e.COMPETITION_LIMIT_TIME=0,e.COMPETITION_LIMIT_SCORE=0,e.COMPETITION_LIMIT_SHOT=0,e.COMPETITION_LIMIT_THREE=0,e.BASKETBALL_SHOT_CD_COMPETITION=200,e.COMPETITION_DATA_ID=0,e.shootIndex=0,e.basketNowRound=0,e.basketNextData={posX:0,posY:0,windDr:0,windL:0,style:0},e.basketMoveOnlyThree=!0,e.isPause=!1,e.replaySpeed=1,e.pauseReplaySpeed=1,e.competitionNetProcess=1,e.lastTime=0,e.standradWindFrameTime=1e3/30,e.basketNetNodeOffsetX=.5*e.BASKET_OFFSET_X+3,e.lastPauseSpeed=1,e.pauseBasketballsData={},e.dtime=100,e.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X=e.PRE_PATH_CONSTANT/e.FORCE_SCALE_X,e.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y=e.PRE_PATH_CONSTANT/e.FORCE_SCALE_Y,e.resetRobotTimeoutID=0,e.armature1Timescale=.5,e.tc=0,e.lastMoveType=0,e.lastMoveTypeTimes=0,e.BASKET_MOVE_MIN_LENGTH=100,e.BASKETBALL_ORIGIN_X_pow_2=e.myBasketballOriginX*e.myBasketballOriginX,e.PRE_PATH_CONSTANT_x_PRE_VELOC_CONSTANT=e.PRE_PATH_CONSTANT*e.PRE_VELOC_CONSTANT,e.PRE_PATH_CONSTANT_chu_PRE_G_CONSTANT=e.PRE_PATH_CONSTANT/e.PRE_G_CONSTANT,e.lastTickTime=0,e.competitionTimeoutWarningOffsetTime=-1,e.competitionWarningTimeoutID=0,e.showSettleViewBackCountID=0,e.lastWindDr=0,e.lastWindDrTimes=0,e.replayWholeTime=0,e.replayDataIndex=0,e.replayTime=0,e.replayStart=!1,e.replayProcessTime=0,e.skinName="resource/eui_skins/view/GameViewSkin.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"isSinglePlayer",{get:function(){return this.gameStyle==this.GS_ONLINE_SINGLE||this.gameStyle==this.GS_OFFLINE_SINGLE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDoublePlayer",{get:function(){return this.gameStyle==this.GS_ONLINE_DOUBLE||this.gameStyle==this.GS_OFFLINE_DOUBLE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCompetition",{get:function(){return this.gameStyle==this.GS_ONLINE_COMPETITION||this.gameStyle==this.GS_OFFLINE_COMPETITION},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOfflineGame",{get:function(){return this.gameStyle==this.GS_OFFLINE_SINGLE||this.gameStyle==this.GS_OFFLINE_DOUBLE||this.gameStyle==this.GS_OFFLINE_COMPETITION},enumerable:!0,configurable:!0}),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.setData=function(t){},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this);var i=16777215,s=.4;if(console.log("gameview"),ModuleConfig.compile.danji)if(ModuleConfig.compile.single_player){this.gameStyle=this.GS_ONLINE_COMPETITION;var a=new eui.TextInput;a.width=100,a.height=40,a.x=this.game.width/2-50,a.y=this.game.height/2-20,this.game.addChild(a);var o=new eui.Button;this.game.addChild(o),o.width=60,o.height=40,o.x=this.game.width/2-30,o.y=this.game.height/2+30,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.MODE_ID=Number(a.text),e.loadCompetitionData(e.MODE_ID),MyCDM.instance.ConnectLANServerForCompetition(),e.startNetCheckForCompetition(),e.game.removeChild(a),e.game.removeChild(o)},this),this.setBasketScale(1.05),this.competitionStyle={limitTime:!0,mustThree:!1,randMove:!1,limitShot:!1};var n=2;this.bg.source="bg"+n.toString()+"_jpg",2==n&&(i=16733473,s=.6),ZJ.AudioManager.Instance.bgm="bg",ZJ.AudioManager.Instance.playBgm(0,.6)}else this.gameStyle=this.GS_OFFLINE_DOUBLE;else if("20"==chushouGameConfig.launchMode)this.gameStyle=this.GS_ONLINE_SINGLE,this.setBasketScale(1.05);else if("30"==chushouGameConfig.launchMode)this.gameStyle=this.GS_ONLINE_DOUBLE;else if("50"==chushouGameConfig.launchMode){this.gameStyle=this.GS_ONLINE_COMPETITION,this.competitionStyle={limitTime:!0,mustThree:!1,randMove:!1,limitShot:!1},this.MODE_ID=chushouGameConfig.factor,this.loadCompetitionData(chushouGameConfig.factor),this.stageLabel.text=chushouGameConfig.level.toString(),this.setBasketScale(1.05);var n=Number(chushouGameConfig.level)%6;this.bg.source="bg"+n.toString()+"_jpg",2==n?(i=16733473,s=.6):5==n&&(this.netImageName="net_light_png"),ZJ.AudioManager.Instance.bgm="bg",ZJ.AudioManager.Instance.playBgm(0,.6)}else"60"==chushouGameConfig.launchMode&&(this.gameStyle=this.GS_REPLAY,this.competitionStyle={limitTime:!0,mustThree:!1,randMove:!1,limitShot:!1},this.setBasketScale(1.05));this.gameStyle!=this.GS_ONLINE_COMPETITION?(this.WIND_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"WIND_RATE",xlsx.c_toulan_data)),this.WIND_FORCE_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"WIND_FORCE_RATE",xlsx.c_toulan_data)),this.WIND_DIRECTION_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"WIND_DIRECTION_RATE",xlsx.c_toulan_data)),this.BASKET_LIMIT_MOVE_COUNT=LYNtools.getTableData(xlsx.cfg_c_toulan,"BASKET_LIMIT_MOVE_COUNT",xlsx.c_toulan_data),this.BASKET_MOVING_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"BASKET_MOVING_RATE",xlsx.c_toulan_data)),this.MOVING_TYPE_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"MOVING_TYPE_RATE",xlsx.c_toulan_data)),this.MOVING_SPEED_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"MOVING_SPEED_RATE",xlsx.c_toulan_data)),this.MOVING_LENGTH_RATE=JSON.parse(LYNtools.getTableData(xlsx.cfg_c_toulan,"MOVING_LENGTH_RATE",xlsx.c_toulan_data)),this.DOUBLE_GAME_TIME=LYNtools.getTableData(xlsx.cfg_c_toulan,"DOUBLE_GAME_TIME",xlsx.c_toulan_data),this.CHANGE_POS_TIME=LYNtools.getTableData(xlsx.cfg_c_toulan,"CHANGE_POS_TIME",xlsx.c_toulan_data),this.COMPETITION_LIMIT_TIME=60,this.COMPETITION_LIMIT_SCORE=65,this.COMPETITION_LIMIT_THREE=10):this.BASKET_LIMIT_MOVE_COUNT=-1,ZJ.EventManager.instance.addEventListener(EventName.GAME_RESTART,this.resetGame,this);for(var r=0;6>r;++r)this.basketballImgs.push(this.createImage("ball_png")),this.basketballImgPoolWorkingRecord.push(!1);if(this.isDoublePlayer)for(var r=0;6>r;++r)this.sbBasketballImgs.push(this.createImage("sbball_png")),this.sbBasketballImgPoolWorkingRecord.push(!1);for(var h=this.PATH_ALL_POINTS,r=0;h>r;++r){var c=new egret.Shape;c.graphics.beginFill(i,s),c.graphics.drawCircle(0,0,r%2==0?9:12),c.graphics.endFill(),this.game.addChild(c),this.pathCircles.push(c),c.x=6e3,c.y=6e3}this.addEventListener(egret.Event.ENTER_FRAME,this.refreshPerFrame,this),this.stage.stageHeight>this.game.height?(this.stageScaleType=1,this.scaleOffset=(this.stage.stageHeight-this.game.height)/2):this.stage.stageWidth>this.game.width&&(this.stageScaleType=2,this.scaleOffset=(this.stage.stageWidth-this.game.width)/2,this.doubleMyGroup.x-=this.scaleOffset,this.doubleSbGroup.x+=this.scaleOffset);for(var r=0;40>r;++r){var c=new egret.Shape;c.graphics.beginFill(16768863,.7),c.graphics.drawCircle(0,0,8),c.graphics.endFill(),this.basketPath.addChild(c),this.basketMovePathCircles.push(c),c.x=6e3,c.y=6e3}for(var r=0;2>r;++r){var c=new egret.Shape;c.graphics.beginFill(16768863,.7),c.graphics.drawCircle(0,0,12),c.graphics.endFill(),this.basketPath.addChild(c),this.basketMovePathEndCircles.push(c),c.x=6e3,c.y=6e3}if(this.myBasketballOriginX=this.DOWN_BASKETBALL_ORIGIN_X,this.myBasketballOriginY=this.DOWN_BASKETBALL_ORIGIN_Y,this.initWorld(),this.isSinglePlayer){this.game.removeChild(this.doubleTop),this.game.removeChild(this.sb),this.game.removeChild(this.competitionTop),this.game.removeChild(this.replayTop),this.removeChild(this.replayBottom),this.removeWaitView(),1==this.stageScaleType&&(this.singleTop.y=this.singleTop.y-this.scaleOffset/2);var l=this.singleTop.localToGlobal(this.power1.x+.5*this.power1.width,this.power1.y+.5*this.power1.width),p=this.game.globalToLocal(l.x,l.y),u=this.singleTop.localToGlobal(this.power2.x+.5*this.power2.width,this.power2.y+.5*this.power2.width),d=this.game.globalToLocal(u.x,u.y),g=this.singleTop.localToGlobal(this.power3.x+.5*this.power3.width,this.power3.y+.5*this.power3.width),m=this.game.globalToLocal(g.x,g.y);this.powerPos.push(new ZJ.Vector3(p.x,p.y)),this.powerPos.push(new ZJ.Vector3(d.x,d.y)),this.powerPos.push(new ZJ.Vector3(m.x,m.y)),this.powerArmature=ZJ.ResManager.instance.loadDragonBones("dianchi","dianchiA"),this.powerArmature.x=6e3,this.powerAmtPos=new ZJ.Vector3(.5*this.width,.5*this.height),this.game.addChild(this.powerArmature),this.powerArmature.addEventListener(dragonBones.EventObject.COMPLETE,this.powerAnimationEnd,this),this.extraPower.x=6e3}else if(this.isDoublePlayer){this.game.removeChild(this.singleTop),this.game.removeChild(this.competitionTop),this.game.removeChild(this.replayTop),this.removeChild(this.replayBottom),1==this.stageScaleType&&(this.doubleTop.y=this.doubleTop.y-this.scaleOffset/2),this.sbBasketballOriginX=this.TOP_BASKETBALL_ORIGIN_X,this.sbBasketballOriginY=this.TOP_BASKETBALL_ORIGIN_Y,this.doublePlayerChangePosTimes=[];var _=this.gameTime;do this.doublePlayerChangePosTimes.push(_-this.CHANGE_POS_TIME),_-=this.CHANGE_POS_TIME;while(_-this.CHANGE_POS_TIME>0);this.gameTimeBackcountArmature=ZJ.ResManager.instance.loadDragonBones("djs","djs"),this.gameTimeBackcountArmature.x=6e3,this.doubleTop.addChild(this.gameTimeBackcountArmature),this.resetDoubleGameTime(),this.gameStyle==this.GS_OFFLINE_DOUBLE?this.ai=new SuperAI(this.PRE_PATH_CONSTANT,this.PRE_VELOC_CONSTANT,this.PRE_G_CONSTANT,this.BASKET_ORIGIN_X-this.BASKET_MOVE_OFFSET_X,this.BASKET_ORIGIN_Y-this.BASKET_MOVE_OFFSET_Y,this.sbBasketballOriginX,this.sbBasketballOriginY):this.gameStyle==this.GS_ONLINE_DOUBLE&&(this.pvpShotDataList=[],PvpData.instance.init(function(t){e.pvpReceiveMyShot(t)},function(t){e.pvpReceiveSbShot(t)},function(t){e.pvpReceiveScoreChange(t)},function(t){e.pvpCorrectRound(t)}),this.initMyShotAnimation(),this.showWaitView())}else this.isCompetition?(this.game.removeChild(this.doubleTop),this.game.removeChild(this.sb),this.game.removeChild(this.singleTop),this.game.removeChild(this.replayTop),this.removeChild(this.replayBottom),this.removeWaitView(),this.fingerMoveDatas=[],this.boardWarningImg.visible=!0,1==this.stageScaleType&&(this.competitionTop.y=this.competitionTop.y-this.scaleOffset/2),this.gameStyle==this.GS_ONLINE_COMPETITION?(this.pvpShotDataList=[],this.initMyShotAnimation(),CompetitionData.instance.init(function(t){e.competitionReceiveShot(t)}),this.round=0):this.initCompetitionUI()):this.gameStyle==this.GS_REPLAY&&(this.game.removeChild(this.doubleTop),this.game.removeChild(this.singleTop),this.game.removeChild(this.sb),this.removeWaitView(),1==this.stageScaleType&&(this.competitionTop.y=this.competitionTop.y-this.scaleOffset/2,this.replayTop.y=this.replayTop.y-this.scaleOffset/2),this.initCompetitionUI(),this.initReplayUI(),this.replayData=[],LYNtools.InitBtnWithLight(this.replayExitBtnLight,function(){e.showExitViewForReplayExit()},this));this.countArmature=ZJ.ResManager.instance.loadDragonBones("count","countA"),this.game.addChild(this.countArmature),this.countArmature.x=6e3,this.countArmature.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.addEventListeners(),e.isTeaching=!1,e.countArmature.x=6e3,e.isDoublePlayer?(e.startGameTimeCount(),e.gameStyle==e.GS_OFFLINE_DOUBLE&&e.ai.GameStart(function(){e.sbShot()})):e.isCompetition?(e.startGameTimeCount(),CompetitionData.instance.GameStart(),e.resetBasket(),e.checkWind(0)):e.gameStyle==e.GS_REPLAY&&(e.replayStart=!0,e.startGameTimeCount(),e.removeEventListeners())},this),this.isOfflineGame?this.showCountAnimation():(this.initDataModel(),ModuleConfig.compile.danji||(this.gameStyle==this.GS_ONLINE_COMPETITION?this.startNetCheckForCompetition():this.initExitView())),ModuleConfig.compile.runtime&&egret.ExternalInterface.call("callNativeGameLoaded","")},e.prototype.setBasketScale=function(t){this.BASKET_OFFSET_X*=t,this.boardFather.scaleX*=t,this.boardFather.scaleY*=t},e.prototype.initDataModel=function(){var t=this,e=MyCDM.instance;e.CsAuthRequestCallBack=function(){1==e.gameStyle?ChushouSDK.instance.csGetFriendList(function(t){for(var e=t,i=e.friends,s=[],a=0;a<i.length;++a)s.push(i[a].openUid);MyCDM.instance.SendFriendList({openId:s})}):2==e.gameStyle?(t.myAvatarImage.source=ChushouSDK.instance.csAuthRequestData.avatar,t.myNameLabel.text=ChushouSDK.instance.csAuthRequestData.nickname,"male"!=ChushouSDK.instance.csAuthRequestData.gender&&(t.mySexImage.source="femaleflag_png")):5==e.gameStyle&&(t.competitionNetProcess=2,t.c_myAvatarImage.source=ChushouSDK.instance.csAuthRequestData.avatar,t.c_myNameLabel.text=ChushouSDK.instance.csAuthRequestData.nickname,"male"!=ChushouSDK.instance.csAuthRequestData.gender&&(t.c_mySexImage.source="femaleflag_png"))},e.OnData10000=function(i){5==e.gameStyle?(t.competitionNetProcess=3,MyCDM.instance.GetCompetitionData11110(t.MODE_ID),ModuleConfig.compile.danji&&(t.c_myAvatarImage.source=i.avatarUrl,t.c_myNameLabel.text=i.nickname)):6==e.gameStyle},e.OnData10001=function(i){2==e.gameStyle&&(t.waitSbTimeoutID=egret.setTimeout(function(){t.removeWaitView(),t.showExitViewForSbLeave()},t,t.SB_WAIT_TIME))},e.OnData11003=function(i){t.waitView&&(t.removeWaitView(),egret.clearTimeout(t.waitSbTimeoutID)),1==e.gameStyle?(e.myData.battleTimes<10?t.showTeach():t.showCountAnimation(),e.GetHighestScore11008()):2==e.gameStyle&&(t.showCountAnimation(),t.exitView.visible&&(t.exitView.visible=!1),e.SendProcessData11010({processData:PvpData.instance.PackageStartTime()}),t.myRandSeed=i.seeds[0],t.useSeed=!0,t.sbAvatarImage.source=e.sbData.avatarUrl,t.sbNameLabel.text=e.sbData.nickname,"1"!=e.sbData.gender&&(t.sbSexImage.source="femaleflag_png"),t.isGameEnd=!1)},e.OnData11007=function(t){1==e.gameStyle&&e.GetHighestScore11008()},e.OnData11008=function(e){e.weekScore>t.weekTopScore&&(t.weekTopScore=e.weekScore)},e.OnData11010=function(t){PvpData.instance.UnpackageTimeData(t)},e.OnData11012=function(e){if(0==e.result)if(t.gameStyle==t.GS_ONLINE_SINGLE)t.gameRank=e.rank,t.friendRank=e.friendRank,0!=t.showSettleViewBackCountID&&t.showSettleView(),egret.clearTimeout(t.showSettleViewBackCountID),t.showSettleViewBackCountID=0;else if(t.gameStyle==t.GS_ONLINE_DOUBLE)if(t.isGameEnd||(t.clearGame(),t.clearTimeout(),t.removeEventListeners()),1==e.reason&&e.winPlayerId!=MyCDM.instance.myData.playerId)t.showExitViewForNetBroke();else if(!t.pvpSettleViewIsShown){var i=ZJ.UIManager.instance.openView(UIName.PvpSettle);i.setData({myScore:t.myScore,sbScore:t.sbScore,sbLeave:1==e.reason,winId:e.winPlayerId}),t.pvpSettleViewIsShown=!0}},e.OnData11101=function(t){PvpData.instance.UnpackageShotData(t)},e.OnData11102=function(e){t.round++,PvpData.instance.UnpackageScoreData(e)},e.OnData11110=function(i){0==i.result&&t.initCompetitionStyle(i.timeLimit,i.scoreLimit,i.shootLimit,i.cleanShootLimit,i.lifeLimit),t.competitionNetProcess=4,t.initCompetitionUI(),e.CompetitionStart11111()},e.OnData11111=function(e){t.competitionNetProcess=5,t.useSeed=!0,t.myRandSeed=e.seeds[0],t.myRandSeed=1e4*Math.random(),t.showCountAnimation()},e.OnData11112=function(t){CompetitionData.instance.UnpackShotData(t)},e.OnData11113=function(e){0==e.result&&0!=e.score&&(t.score=e.score,t.limitTimeScoreLabel.text=t.score.toString(),0!=e.isHit&&(t.basketNowRound<e.round&&(t.basketNowRound=e.round,t.COMPETITION_REFRESH_BASKET&&t.doActionAfterDelay(t.BASKET_STAY_TIME_COMPETITION,function(){t.resetBasket(),t.checkWind(t.score)})),t.scoreBroadcast(2==e.isHit,!0,null)))},e.OnData11114=function(e){t.round++,t.myBasketball&&(t.myBasketball.shotRound=t.round)},e.OnData11115=function(e){t.gameEnd(),t.removeEventListeners(),ZJ.AudioManager.Instance.stopBgm(),egret.stopTick(function(t){return!1},t),ChushouSDK.instance.csRecordReport("1"==e.result?"0":"1")},e.OnData11120=function(e){t.loadReplayData(e),t.showCountAnimation()}},e.prototype.pvpReceiveMyShot=function(t){var e=LYNtools.now();if(t.shottime<e)return this.isJumping=!1,this.me1.x=0,void(this.myRobotShotArmature.x=6e3);var i={isMe:!0,time:t.shottime,vx:t.vx,vy:t.vy};egret.clearTimeout(this.resetRobotTimeoutID),this.addItemInShotDataListOrderByTime(i)},e.prototype.pvpReceiveSbShot=function(t){if(!(t.shottime<LYNtools.now())){var e={isMe:!1,time:t.shottime,vx:t.vx,vy:t.vy};this.addItemInShotDataListOrderByTime(e)}},e.prototype.pvpReceiveScoreChange=function(t){var e=this;this.myScore=t.myScore,this.sbScore=t.sbScore,this.myScoreLabel.text=this.myScore.toString(),this.sbScoreLabel.text=this.sbScore.toString(),this.shotSuccessCount++,this.gameTime>t.gametime+1&&(this.gameTime=t.gametime,this.gameTime-100<0&&(this.gameTimeLabel.scaleX=1,this.gameTimeLabel.scaleY=1)),this.myRandSeed=t.seed,this.round=t.round+1,this.shotSuccessCount=t.round,this.basketScored=!0;var i=Math.max(0,t.time-LYNtools.now());this.doActionAfterDelay(i,function(){e.resetBasket(),e.checkWind(e.myScore+e.sbScore)})},e.prototype.pvpCorrectRound=function(t){this.round=t,this.shotSuccessCount=t-1},e.prototype.getNowData=function(){return{id:MyCDM.instance.myData.playerId,seed:this.myRandSeed,time:LYNtools.now()+this.BASKET_STAY_TIME_DOUBLE,gametime:this.gameTime}},e.prototype.competitionReceiveShot=function(t){var e=LYNtools.now();if(t.shottime<e)return this.isJumping=!1,this.me1.x=0,void(this.myRobotShotArmature.x=6e3);var i={isMe:!0,time:t.shottime,vx:t.vx,vy:t.vy};egret.clearTimeout(this.resetRobotTimeoutID),this.addItemInShotDataListOrderByTime(i)},e.prototype.refreshPerFrame=function(){var t=LYNtools.now(),e=egret.getTimer(),i=e-this.lastTime;for(var s in this.basketballs){var a=this.basketballs[s];if(!a)return;var o=a.image,n=a.body;if(o.x=n.position.x,o.y=n.position.y,o.rotation=-(n.angle/Math.PI*-180),this.isWindy)if(a.frames>2){var r=i/this.standradWindFrameTime;n.force=Matter.Vector.create(this.windForce.x*r,this.windForce.y*r)}else a.frames++;a.missFlag||a.isScored||!(n.position.x>this.basketFather.x+this.BASKET_OFFSET_X+2*this.BASKETBALL_SIZE||n.velocity.y>0&&n.position.y>this.basketFather.y+4*this.BASKETBALL_SIZE)||(a.missFlag=!0,this.missBroadcast(a.body.label.split("_")[2]==this.MINE_FLAG,Number(a.body.label.split("_")[1])))}for(var h=this.netNodes.length,c=0;h>c;++c){var o=this.netNodes[c],n=this.basketNet.bodies[c+4];o.x=n.position.x,o.y=n.position.y}if(this.gameStyle==this.GS_ONLINE_DOUBLE||this.gameStyle==this.GS_ONLINE_COMPETITION){for(var l=0,c=0;c<this.pvpShotDataList.length&&this.pvpShotDataList[c].time<=t;++c)this.pvpShotDataList[c].isMe?this.myShot(this.pvpShotDataList[c].vx,this.pvpShotDataList[c].vy):this.sbShot(this.pvpShotDataList[c].vx,this.pvpShotDataList[c].vy),l++;for(var c=0;l>c;++c)this.pvpShotDataList.shift()}else this.gameStyle==this.GS_REPLAY&&(this.readReplayData(i),this.replayProcessBarUpdate(i));this.lastTime=e,this.basketMovePerFrame()},e.prototype.initWorld=function(){var t=this;this.engine=Matter.Engine.create(),this.world=this.engine.world,this.world.gravity={scale:.0025,x:0,y:1},this.render=Matter.Render.create({engine:this.engine,element:document.body,options:{width:1080,height:1920,wireframes:!1}}),Matter.Engine.run(this.engine),Matter.Events.on(this.engine,"collisionStart",function(e){for(var i=function(e){var i=e.bodyA.label.split("_")[0]==t.BASKETBALL_LABEL?e.bodyA:e.bodyB,s=e.bodyA.label.split("_")[0]!=t.BASKETBALL_LABEL?e.bodyA:e.bodyB;if(i.label.split("_")[0]==t.BASKETBALL_LABEL&&s.label.split("_")[0]!=t.BASKETBALL_LABEL)if(s.label==t.SCORE_COLLIDER_TOP_LABEL)t.basketballs[i.label].missFlag||(t.basketballs[i.label].touchTop=!0);else if(s.label==t.SCORE_COLLIDER_MIDDLE_LABEL)!t.basketballs[i.label].missFlag&&t.basketballs[i.label].touchTop&&(t.basketballs[i.label].scoreFlag=!0);else if(s.label==t.SCORE_COLLIDER_BOTTOM_LABEL){if(t.basketballs[i.label].noUseFlag)return"continue";ZJ.AudioManager.Instance.play("touchnet",1,.5);var a=t.basketballs[i.label];if(!a.isScored&&!a.missFlag)if(a.scoreFlag){if(a.isScored=!0,t.scoreAnimation(),t.gameStyle!=t.GS_REPLAY){if(t.gameStyle==t.GS_ONLINE_COMPETITION?MyCDM.instance.SendCompetitionShotResult11113(Number(a.body.label.split("_")[1]),a.isCleanShot?2:1,a.isCleanShot?3+t.myShotCombo:1,t.round,LYNtools.now()-CompetitionData.instance.startTime):t.scoreBroadcast(a.isCleanShot,i.label.split("_")[2]!=t.SB_FLAG,a),!t.basketScored&&t.gameStyle!=t.GS_ONLINE_DOUBLE&&t.gameStyle!=t.GS_ONLINE_COMPETITION){var o=0;t.isSinglePlayer?o=t.BASKET_STAY_TIME_SINGLE:t.gameStyle==t.GS_OFFLINE_DOUBLE?o=t.BASKET_STAY_TIME_DOUBLE:t.gameStyle==t.GS_OFFLINE_COMPETITION&&(o=t.BASKET_STAY_TIME_COMPETITION),t.doActionAfterDelay(o,function(){t.resetBasket(),t.checkWind(t.isSinglePlayer||t.isCompetition?t.score:t.myScore+t.sbScore)}),t.basketScored=!0}if(t.isDoublePlayer)for(var n in t.basketballs)t.basketballs[n].body.label!=i.label&&(t.basketballs[n].image.alpha=.2,t.basketballs[n].missFlag=!0,t.basketballs[n].noUseFlag=!0,t.basketballs[n].body.restitution=0,t.basketballs[n].body.label,Matter.Body.set(t.basketballs[n].body,"velocity",Matter.Vector.create(0,0)))}}else t.basketballs[i.label].missFlag=!0,t.missBroadcast(i.label.split("_")[2]==t.MINE_FLAG,Number(i.label.split("_")[1]))}else if(s.label==t.GROUND_LABEL){if(t.basketballs[i.label]&&!t.basketballs[i.label].isKilling){t.basketballs[i.label].isKilling=!0,t.basketballs[i.label].noUseFlag||ZJ.AudioManager.Instance.play("hitgroundbig",1);var r=i.label;t.doActionAfterDelay(500,function(){null!=t.basketballs[r]&&egret.Tween.get(t.basketballs[r].image).to({alpha:0},500).call(function(){null!=t.basketballs[r]&&(t.basketballs[r].image.x=6e3,r.split("_")[2]!=t.SB_FLAG?t.basketballImgPoolWorkingRecord[t.basketballImgs.indexOf(t.basketballs[r].image)]=!1:t.sbBasketballImgPoolWorkingRecord[t.sbBasketballImgs.indexOf(t.basketballs[r].image)]=!1,Matter.World.remove(t.world,t.basketballs[r].body),delete t.basketballs[r])})})}t.basketballs[i.label].noUseFlag||ZJ.AudioManager.Instance.play("hitgroundsmall",1)}else if(s.label==t.BASKET_LEFT_LABEL){if(t.basketballs[i.label].noUseFlag)return"continue";t.basketballs[i.label].isCleanShot=!1,i.label.split("_")[2]!=t.SB_FLAG&&(t.myShotCombo=0),t.hitLeftBasket(1),ZJ.AudioManager.Instance.play("hitbasket",1,.3)}else if(s.label==t.BASKET_RIGHT_LABEL){if(t.basketballs[i.label].noUseFlag)return"continue";t.basketballs[i.label].isCleanShot=!1,i.label.split("_")[2]!=t.SB_FLAG&&(t.myShotCombo=0),t.hitRightBasket(1),ZJ.AudioManager.Instance.play("hitbasket",1,.3)}else s.label==t.EXTRA_POWER_LABEL&&(Matter.World.remove(t.world,s),t.extraPowerBody=null,t.extraPower.x=6e3,t.getExtraPower())},s=0,a=e.pairs;s<a.length;s++){var o=a[s];i(o)}});var e,i;this.isCompetition?(e=6e3,i=6e3):(e=this.BASKET_ORIGIN_X,i=this.BASKET_ORIGIN_Y);var s=this.BASKET_OFFSET_X,a=this.BASKET_OFFSET_Y,o=this.BASKET_FRAME_WIDTH,n=this.BASKET_FRAME_HEIGHT,r=this.SCENE_GROUP_ID,h=this.SCENE_CATEGORY_ID,c=this.SCENE_MASK_ID;this.basket1=Matter.Bodies.rectangle(e-s,i+a,o,n,{isStatic:!0,label:this.BASKET_LEFT_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.basket11=Matter.Bodies.circle(e-s,i+a-.5*n,.5*n,{isStatic:!0,label:this.BASKET_LEFT_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.basket2=Matter.Bodies.rectangle(e+s,i-a,o,n,{isStatic:!0,label:this.BASKET_RIGHT_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.basket22=Matter.Bodies.circle(e+s,i-a-.5*n,.5*n,{isStatic:!0,label:this.BASKET_RIGHT_LABEL,collisionFilter:{group:r,category:h,mask:c}});for(var l=this.basketNet=Matter.Composites.softBody(this.basket1.position.x-o/2-4,this.basket1.position.y-2*n,4,4,this.basketNetNodeOffsetX,30,!1,1,{render:{visible:!1},mass:.1,collisionFilter:{group:r,category:h,mask:c}},{}),p=0;2>p;++p)l.constraints[10+7*p].length-=3*(p+1),l.constraints[11+7*p].length-=3*(p+1),l.constraints[12+7*p].length-=3*(p+1);for(var p=0;4>p;++p)l.bodies[p].isStatic=!0,l.bodies[p].isSensor=!0,l.bodies[p].position.y-=1.5*p,this.netNodeYs[p]=l.bodies[p].position.y;for(var u=this.netImageName,p=4,d=this.basketNet.bodies.length;d>p;++p){var g=new eui.Image(u);g.x=l.bodies[p].position.x,g.y=l.bodies[p].position.y,this.netNodes.push(g),this.netFather.addChild(g)}this.basketNet=l,this.basketFather.x=(this.basket1.position.x+this.basket2.position.x)/2,this.basketFather.y=(this.basket1.position.y+this.basket2.position.y)/2,this.boardFather.x=this.basketFather.x,this.boardFather.y=this.basketFather.y,this.scoreTop=Matter.Bodies.rectangle((this.basket1.position.x+this.basket2.position.x)/2,(this.basket1.position.y+this.basket2.position.y)/2,this.basket2.position.x-this.basket1.position.x,2,{isSensor:!0,isStatic:!0,label:this.SCORE_COLLIDER_TOP_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.scoreMiddle=Matter.Bodies.rectangle((this.basket1.position.x+this.basket2.position.x)/2,(this.basket1.position.y+this.basket2.position.y)/2+this.BASKETBALL_SIZE,(this.basket2.position.x-this.basket1.position.x)/3,2,{isSensor:!0,isStatic:!0,label:this.SCORE_COLLIDER_MIDDLE_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.scoreBottom=Matter.Bodies.rectangle((this.basket1.position.x+this.basket2.position.x)/2,(this.basket11.position.y+this.basket22.position.y)/2-3+2*this.BASKETBALL_SIZE,this.basket22.position.x-this.basket11.position.x,2,{isSensor:!0,isStatic:!0,label:this.SCORE_COLLIDER_BOTTOM_LABEL,collisionFilter:{group:r,category:h,mask:c}}),this.createMyBasketball(),Matter.World.add(this.world,[this.basket1,this.basket11,this.basket2,this.basket22,this.scoreTop,this.scoreMiddle,this.scoreBottom,Matter.Bodies.rectangle(540,1880,1e4,100,{isStatic:!0,label:this.GROUND_LABEL,collisionFilter:{group:r,category:h,mask:c}})]),Matter.World.add(this.world,this.basketNet)},e.prototype.initMyShotAnimation=function(){this.myRobotShotArmature=ZJ.ResManager.instance.loadDragonBones("JS_1","JS_1A"),this.myRobotShotArmature.x=6e3,this.myRobotShotArmature.y=this.myRobotShotArmature.height+10,this.me.addChild(this.myRobotShotArmature)},e.prototype.initExitView=function(){var t=this;this.gameStyle==this.GS_REPLAY?(LYNtools.InitBtnWithLight(this.exitViewOkBtnLight,function(){ChushouSDK.instance.csExitGame()},this),LYNtools.InitBtnWithLight(this.exitViewCancelBtnLight,function(){t.exitView.visible=!1},this),LYNtools.InitBtnWithLight(this.exitCountBtnLight,function(){ChushouSDK.instance.csExitGame()},this),this.replayExitBackcount=5):(LYNtools.InitBtnWithLight(this.exitBtnLight,function(){ChushouSDK.instance.csExitGame()},this),this.intervalCheck=setInterval(function(){ZJ.SocketManager.instance.connected||t.showExitViewForNetBroke()},this.CHECK_SOCKET_TIME))},e.prototype.startNetCheckForCompetition=function(){var t=this;this.intervalCheck=setInterval(function(){if(ZJ.SocketManager.instance.connected){if(5!=t.competitionNetProcess)switch(t.competitionNetProcess){case 1:console.log("do csAuthRequest again"),MyCDM.instance.DoCompetitionAuthRequest();break;case 2:console.log("do Login10000 again"),MyCDM.instance.Login10000();break;case 3:console.log("do GetCompetitionData11110 again"),MyCDM.instance.GetCompetitionData11110(t.MODE_ID);
break;case 4:console.log("do CompetitionStart11111 again"),MyCDM.instance.CompetitionStart11111()}}else MyCDM.instance.reconnect10002()},this.CHECK_SOCKET_TIME)},e.prototype.showExitViewForNetBroke=function(){this.removeEventListeners(),this.clearTimeout(),this.clearGame(),this.netBrokenText.visible=!0,this.sbMissText.visible=!1,this.exitViewNormalBtn.visible=!0,this.exitView.visible=!0,this.pvpSettleViewIsShown&&ZJ.UIManager.instance.destroyView(UIName.PvpSettle)},e.prototype.showExitViewForReplayExit=function(){this.exitViewDoubleBtns.visible=!0,this.exitReplayText.visible=!0,this.exitView.visible=!0},e.prototype.showExitViewForSbLeave=function(){this.netBrokenText.visible||(this.sbMissText.visible=!0,this.exitViewNormalBtn.visible=!0,this.exitView.visible=!0)},e.prototype.showExitViewForReplayEnd=function(){var t=this;this.exitViewDoubleBtns.visible=!1,this.exitReplayText.text="本次回放已经结束。",this.exitReplayText.visible=!0,this.exitViewCountBtn.visible=!0,setInterval(function(){t.replayExitBackcount>1?(t.replayExitBackcount--,t.exitCountBtnLabel.text=t.replayExitBackcount.toString()+" s"):ChushouSDK.instance.csExitGame()},1e3),this.exitView.visible=!0},e.prototype.initCompetitionUI=function(){1==this.stageScaleType&&(this.replayTop.y-=this.scaleOffset/2),this.competitionStyle.limitTime?(this.gameTime=this.COMPETITION_LIMIT_TIME,this.realGameTime=1e3*this.gameTime,this.limitTimeLabel.text=this.gameTime.toString(),this.limitTimeScoreConditionLabel.text=this.COMPETITION_LIMIT_SCORE.toString()+"分"):this.limitTimeUI.visible=!1,this.competitionStyle.mustThree&&(this.scored2.text="1"),!this.competitionStyle.limitShot},e.prototype.initCompetitionStyle=function(t,e,i,s,a){0==t?this.competitionStyle.limitTime=!1:(this.competitionStyle.limitTime=!0,this.COMPETITION_LIMIT_TIME=t),0==i?this.competitionStyle.limitShot=!1:(this.competitionStyle.limitShot=!0,this.COMPETITION_LIMIT_SHOT=i),0==s?this.competitionStyle.mustThree=!1:(this.competitionStyle.mustThree=!0,this.COMPETITION_LIMIT_THREE=s),this.COMPETITION_LIMIT_SCORE=e},e.prototype.initReplayUI=function(){var t=this;LYNtools.InitBtnWithLight(this.ppBtnLight,function(){t.isPause?(t.isPause=!1,t.ppBtnIconImg.source="pause_png",t.replaySpeed=t.pauseReplaySpeed,t.replaySpeedChange(t.replaySpeed)):(t.isPause=!0,t.ppBtnIconImg.source="play_png",t.replaySpeed=0,t.replaySpeedChange(t.replaySpeed))},this),this.reduceSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){1!=t.pauseReplaySpeed&&(t.reduceSpeedBtnLight.alpha=0,2==t.pauseReplaySpeed?(t.pauseReplaySpeed=1,t.reduceSpeedIconImg.source="reduce_grey_png",t.reduceSpeedBtnBgImg.source="replay_bg_grey_png"):(t.pauseReplaySpeed=2,t.addSpeedIconImg.source="add_light_png",t.addSpeedBtnBgImg.source="replay_bg_light_png"),t.isPause||(t.replaySpeed=t.pauseReplaySpeed,t.replaySpeedChange(t.replaySpeed)),t.replaySpeedLabel.text=t.pauseReplaySpeed.toString()+"X")},this),this.reduceSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){1!=t.pauseReplaySpeed&&(t.reduceSpeedBtnLight.alpha=1)},this),this.reduceSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.reduceSpeedBtnLight.alpha=0},this),this.addSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){3!=t.pauseReplaySpeed&&(t.addSpeedBtnLight.alpha=0,2==t.pauseReplaySpeed?(t.pauseReplaySpeed=3,t.addSpeedIconImg.source="add_grey_png",t.addSpeedBtnBgImg.source="replay_bg_grey_png"):(t.pauseReplaySpeed=2,t.reduceSpeedIconImg.source="reduce_light_png",t.reduceSpeedBtnBgImg.source="replay_bg_light_png"),t.isPause||(t.replaySpeed=t.pauseReplaySpeed,t.replaySpeedChange(t.replaySpeed)),t.replaySpeedLabel.text=t.pauseReplaySpeed.toString()+"X")},this),this.addSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){3!=t.pauseReplaySpeed&&(t.addSpeedBtnLight.alpha=1)},this),this.addSpeedBtnLight.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.addSpeedBtnLight.alpha=0},this)},e.prototype.resetGame=function(){this.isWindy=!1,this.createMyBasketball(),this.showCountAnimation(),this.shotSuccessCount=0,this.round=1,this.resetBasket(),this.isSinglePlayer?(egret.Tween.removeTweens(this.power1),egret.Tween.removeTweens(this.power2),egret.Tween.removeTweens(this.power3),this.power1.alpha=1,this.power2.alpha=1,this.power3.alpha=1,this.powerArmature.x=6e3,this.lifeCount=3,this.extraPower.x=6e3,this.extraPowerBody&&Matter.World.remove(this.world,this.extraPowerBody),this.score=0,this.scoreLabel.text=this.score.toString(),MyCDM.instance.PlayAgain11007()):this.isDoublePlayer?(this.myScore=0,this.myShotCombo=0,this.myScoreLabel.text="0",this.sbScore=0,this.sbShotCombo=0,this.sbScoreLabel.text="0",this.pvpSettleViewIsShown=!1,this.resetDoubleGameTime()):this.gameStyle==this.GS_OFFLINE_COMPETITION&&(this.gameTime=this.COMPETITION_LIMIT_TIME,this.realGameTime=1e3*this.gameTime,this.score=0,this.limitTimeLabel.text=this.COMPETITION_LIMIT_TIME.toString(),this.limitTimeScoreLabel.text="0")},e.prototype.resetDoubleGameTime=function(){this.gameTime=this.DOUBLE_GAME_TIME,this.realGameTime=1e3*this.gameTime,this.gameTime-100>=0&&(this.gameTimeLabel.scaleX=.8,this.gameTimeLabel.scaleY=.8),this.gameTimeLabel.text=this.gameTime.toString(),this.gameTimeLabel.x=this.doubleTop.width/2,this.gameTimeBackcountArmature.animation.gotoAndPlayByFrame("newAnimation",1),this.gameTimeBackcountArmature.x=6e3},e.prototype.showCountAnimation=function(){this.countArmature.x=.5*this.game.width,this.countArmature.y=.5*this.game.height,this.countArmature.animation.play("newAnimation",1)},e.prototype.showWaitView=function(){this.setChildIndex(this.waitView,3),this.wait1AnimationLoop()},e.prototype.removeWaitView=function(){egret.Tween.removeTweens(this.wait1),this.removeChild(this.waitView),this.waitView=null},e.prototype.wait1AnimationLoop=function(){this.wait1.rotation=0,egret.Tween.get(this.wait1).to({rotation:-360},3e3).call(this.wait1AnimationLoop,this)},e.prototype.replaySpeedChange=function(t){var e=!1;for(var i in this.basketballs){if(!this.basketballs[i])return;if(this.isPause){var s=this.basketballs[i].body;this.pauseBasketballsData[i]={vx:s.velocity.x,vy:s.velocity.y,angle:s.angularVelocity},Matter.Body.set(s,"velocity",Matter.Vector.create(0,0)),Matter.Body.set(s,"angularVelocity",0)}else{var s=this.basketballs[i].body,a=void 0,o=void 0,n=void 0;0==s.timeScale?(e=!0,a=this.pauseBasketballsData[i].vx*t/this.lastPauseSpeed,o=this.pauseBasketballsData[i].vy*t/this.lastPauseSpeed,n=this.pauseBasketballsData[i].angle):(a=s.velocity.x*t/this.lastPauseSpeed,o=s.velocity.y*t/this.lastPauseSpeed),Matter.Body.set(s,"velocity",Matter.Vector.create(a,o)),this.lastPauseSpeed=t}this.basketballs[i].body.timeScale=t}e&&(this.pauseBasketballsData={}),this.myBasketball&&(this.myBasketball.body.timeScale=t)},e.prototype.hitLeftBasket=function(t){this.doHitAnimation(this.basket,!0),this.doHitAnimation(this.board,!0),this.doNetAnimation(!0)},e.prototype.hitRightBasket=function(t){this.doHitAnimation(this.basket,!1),this.doHitAnimation(this.board,!1),this.doNetAnimation(!1)},e.prototype.doHitAnimation=function(t,e){var i=e?1:-1,s=this.dtime;egret.Tween.get(t).to({y:20,rotation:this.BASKET_NORMAL_ROTATION+-5*i},s,egret.Ease.cubicInOut).to({y:-10,rotation:this.BASKET_NORMAL_ROTATION+3*i},s,egret.Ease.cubicInOut).to({y:5,rotation:this.BASKET_NORMAL_ROTATION+-2*i},s,egret.Ease.cubicInOut).to({y:-2,rotation:this.BASKET_NORMAL_ROTATION+1*i},s,egret.Ease.cubicInOut).to({y:0,rotation:this.BASKET_NORMAL_ROTATION},s,egret.Ease.cubicInOut)},e.prototype.doNetAnimation=function(t){if(!this.basketMoveData)for(var e=this.dtime,i=0;4>i;++i)egret.Tween.get(this.basketNet.bodies[i].position).to({y:this.netNodeYs[i]+20},e,egret.Ease.cubicInOut).to({y:this.netNodeYs[i]-10},e,egret.Ease.cubicInOut).to({y:this.netNodeYs[i]+5},e,egret.Ease.cubicInOut).to({y:this.netNodeYs[i]-2},e,egret.Ease.cubicInOut).to({y:this.netNodeYs[i]},e,egret.Ease.cubicInOut)},e.prototype.scoreAnimation=function(){egret.Tween.removeTweens(this.board),egret.Tween.removeTweens(this.basket),1!=this.basket.alpha&&egret.Tween.get(this.basket).to({alpha:1},this.BASKET_MOVE_ANIMATE_TIME*(1-this.basket.alpha)),egret.Tween.get(this.board).to({y:10,rotation:this.BASKET_NORMAL_ROTATION+-3},100,egret.Ease.sineInOut).to({y:-5,rotation:this.BASKET_NORMAL_ROTATION+1},75,egret.Ease.sineInOut).to({y:0,rotation:this.BASKET_NORMAL_ROTATION},50,egret.Ease.sineInOut),egret.Tween.get(this.basket).to({y:10,rotation:this.BASKET_NORMAL_ROTATION+-3},100,egret.Ease.sineInOut).to({y:-5,rotation:this.BASKET_NORMAL_ROTATION+1},75,egret.Ease.sineInOut).to({y:0,rotation:this.BASKET_NORMAL_ROTATION},50,egret.Ease.sineInOut)},e.prototype.myShot=function(t,e){var i=this;if(this.myBasketball){this.gameStyle==this.GS_REPLAY&&(t*=this.replaySpeed,e*=this.replaySpeed),this.myBasketball.body.isStatic=!1,this.myBasketball.body.torque=-3,this.myBasketball.body.isSensor=!1,Matter.Body.set(this.myBasketball.body,"velocity",Matter.Vector.create(t,e)),this.myBasketball.frames=0,this.myBasketball.shotRound=this.round,this.basketballs[this.myBasketball.body.label]=this.myBasketball,this.myBasketball=null;var s=0;this.isSinglePlayer?s=this.BASKETBALL_SHOT_CD_SINGLE:this.isDoublePlayer?s=this.BASKETBALL_SHOT_CD_DOUBLE:this.isCompetition?s=2*this.PLAYER_JUMP_TIME:this.gameStyle==this.GS_REPLAY&&(s=this.BASKETBALL_SHOT_CD_DOUBLE),this.doActionAfterDelay(s,function(){i.isSinglePlayer?0!=i.lifeCount&&i.createMyBasketball():i.isDoublePlayer?i.createMyBasketball():i.isCompetition?i.createMyBasketball():i.gameStyle==i.GS_REPLAY&&i.createMyBasketball()}),this.me1.x=6e3,this.me2.x=6e3,(this.gameStyle==this.GS_ONLINE_DOUBLE||this.gameStyle==this.GS_ONLINE_COMPETITION)&&(this.myRobotShotArmature.x=6e3,this.myRobotShotArmature.animation.gotoAndStopByFrame("newAniamtion",1)),this.me3.x=0,this.isJumping=!0,egret.Tween.get(this.me3).to({y:-this.PLAYER_JUMP_HEIGHT},this.PLAYER_JUMP_TIME,egret.Ease.quadOut).to({y:0},this.PLAYER_JUMP_TIME,egret.Ease.quadIn).call(function(){i.me3.x=6e3,i.me1.x=0,i.isJumping=!1})}},e.prototype.sbShot=function(t,e){var i,s=this;i=this.gameStyle==this.GS_OFFLINE_DOUBLE?this.ai.Shot(this.basketFather.x,this.basketFather.y,this.isWindy,this.windDirection,this.windForceLevel):Matter.Vector.create(t,e);var a=this.createSbBasketball();a.body.isStatic=!1,a.body.torque=-3,a.body.isSensor=!1,a.frames=0,a.shotRound=this.round,Matter.Body.set(a.body,"velocity",i),this.sb1.x=6e3,this.sb2.x=6e3,this.sb3.x=0,egret.Tween.get(this.sb3).to({y:-this.PLAYER_JUMP_HEIGHT},this.PLAYER_JUMP_TIME,egret.Ease.quadOut).to({y:0},this.PLAYER_JUMP_TIME,egret.Ease.quadIn).call(function(){s.sb3.x=6e3,s.sb1.x=0})},e.prototype.createMyBasketball=function(){this.myBasketball=new BasketBall(this.createBasketball(this.myBasketballOriginX,this.myBasketballOriginY),this.getBasketballImage(!1)),this.isDoublePlayer&&(this.myBasketball.body.label+="_"+this.MINE_FLAG)},e.prototype.createSbBasketball=function(){var t=new BasketBall(this.createBasketball(this.sbBasketballOriginX,this.sbBasketballOriginY),this.getBasketballImage(!0));return t.body.label+="_"+this.SB_FLAG,this.basketballs[t.body.label]=t,t},e.prototype.createBasketball=function(t,e){var i=Matter.Bodies.circle(t,e,this.BASKETBALL_SIZE,{restitution:this.BASKETBALL_RESTITUTION,frictionAir:this.BASKETBALL_FICTIONAIR,mass:6.3,friction:1,isSensor:!0,isStatic:!1,label:this.BASKETBALL_LABEL+"_"+this.ballCount++,collisionFilter:{group:this.BALL_GROUP_ID,category:this.BALL_CATEGORY_ID,mask:this.BALL_MASK_ID}});return this.gameStyle==this.GS_REPLAY&&(i.timeScale=this.replaySpeed),i.isStatic=!0,Matter.World.add(this.world,i),i},e.prototype.createPower=function(){var t=200,e=200+.9*(this.basketFather.x-400),i=1920-(1200+.5*(1e3-this.basketFather.y)),s=i+400;this.extraPower.alpha=0;var a,o,n=.25*(e+t+s+i);do a=this.getRandom(t,e),o=this.getRandom(i,s);while(a-t+o-i>n);this.extraPower.x=a,this.extraPower.y=o,egret.Tween.get(this.extraPower).to({alpha:1},this.BASKET_MOVE_ANIMATE_TIME),this.extraPowerBody=Matter.Bodies.rectangle(this.extraPower.x,this.extraPower.y,.8*this.extraPower.width,.8*this.extraPower.height,{isSensor:!0,isStatic:!1,label:this.EXTRA_POWER_LABEL}),this.extraPowerBody.isStatic=!0,Matter.World.add(this.world,this.extraPowerBody)},e.prototype.getExtraPower=function(){switch(ZJ.AudioManager.Instance.play("getpower",1,.5),this.lifeCount){case 2:egret.Tween.removeTweens(this.power1),egret.Tween.get(this.power1).to({alpha:1},1500);break;case 1:egret.Tween.removeTweens(this.power2),egret.Tween.get(this.power2).to({alpha:1},1500);break;case 0:egret.Tween.removeTweens(this.power3),egret.Tween.get(this.power3).to({alpha:1},1500),this.addEventListeners();break;default:return}egret.Tween.removeTweens(this.powerArmature),this.powerArmature.alpha=1,this.powerArmature.scaleX=1,this.powerArmature.scaleY=1,this.powerArmature.x=this.powerAmtPos.x,this.powerArmature.y=this.powerAmtPos.y,this.powerArmature.animation.play("newAnimation2",1),this.lifeCount++},e.prototype.startMove=function(t){this.createPath(t),this.touchingEvent=t,this.isJumping||(this.me1.x=6e3,this.me2.x=0)},e.prototype.onMove=function(t){this.createPath(t),this.touchingEvent=t},e.prototype.stopMove=function(t){var e=this;if(this.touchingEvent=null,this.myBasketball){var i=void 0,s=void 0;1==this.stageScaleType?(s=t.stageY<this.scaleOffset?(-this.game.height-100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y:t.stageY>this.game.height+this.scaleOffset?-100*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y:(t.localY-this.game.height-100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y,i=(t.stageX+100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X):2==this.stageScaleType?(i=t.stageX<this.scaleOffset?100*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X:t.stageX>this.game.width+this.scaleOffset?(this.game.width+100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X:(t.localX+100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X,s=(t.stageY-this.game.height-100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y):(i=(t.localX+100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X,s=(t.localY-this.game.height-100)*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y);var a=function(){e.myRobotShotArmature.x=e.myRobotShotArmature.width/2,e.myRobotShotArmature.animation.play("newAnimation",1),e.me2.x=6e3,e.me1.x=6e3,e.isJumping=!0,e.resetRobotTimeoutID=e.doActionAfterDelay(e.PVP_SHOT_DELAY_TIME+50,e.resetRobotWhenNetworkFail)};if(this.gameStyle==this.GS_ONLINE_DOUBLE)this.isJumping||(MyCDM.instance.SendShotData11101(this.round,PvpData.instance.PackageShotData(i,s,this.PVP_SHOT_DELAY_TIME)),a());else if(this.gameStyle==this.GS_ONLINE_COMPETITION){if(!this.isJumping){var o=CompetitionData.instance.PackageShotData(i,s,this.COMPETITION_SHOT_DELAY_TIME,this.fingerMoveDatas);MyCDM.instance.SendCompetitionShotData11112(o.timeStamp,Number(this.myBasketball.body.label.split("_")[1]),o.shootData,this.round),a(),this.fingerMoveDatas=[]}}else this.myShot(i,s)}if(this.pathCircles&&0!=this.pathCircles.length)for(var n=0,r=this.pathCircles;n<r.length;n++){var h=r[n];h.x=6e3,h.y=6e3}},e.prototype.resetRobotWhenNetworkFail=function(){this.me1.x=0,this.isJumping=!1,this.myRobotShotArmature.x=6e3},e.prototype.showTeach=function(){var t=this;this.doActionAfterDelay(1e3,function(){t.isTeaching=!0,t.addEventListener(egret.Event.ENTER_FRAME,t.teachPerFrame,t);var e=ZJ.ResManager.instance.loadDragonBones("shou","shouA");e.x=187,e.y=1535,t.game.addChild(e),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){if(t.teachShot(),t.pathCircles&&0!=t.pathCircles.length)for(var i=0,s=t.pathCircles;i<s.length;i++){var a=s[i];a.x=6e3,a.y=6e3}t.game.removeChild(e),t.removeEventListener(egret.Event.ENTER_FRAME,t.teachPerFrame,t)},t),e.animation.play("newAnimation",1).timeScale=t.armature1Timescale,t.showCountAnimation()})},e.prototype.teachShot=function(){this.myShot(380*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_X,-820*this.PRE_PATH_CONSTANT_chu_FORCE_SCALE_Y),this.basketballs[this.BASKETBALL_LABEL+"_1"].missFlag=!0},e.prototype.teachPerFrame=function(){this.tc>60&&this.realCreatePath(150+3.2*(this.tc-58),-200-10*(this.tc-58)),this.tc++},e.prototype.resetBasket=function(){var t=this;0!=this.windbg.alpha&&(egret.Tween.get(this.windbg).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.winddr).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.windbd).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.windf).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME)),egret.Tween.get(this.basket).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME);for(var e=0,i=this.netNodes;e<i.length;e++){var s=i[e];egret.Tween.get(s).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME)}egret.Tween.get(this.boardImg).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME).call(function(){t.basketScored=!1,egret.Tween.removeTweens(t.board),egret.Tween.removeTweens(t.basket),t.board.x=0,t.board.y=0,t.board.rotation=t.BASKET_NORMAL_ROTATION,t.basket.x=0,t.basket.y=0,t.basket.rotation=t.BASKET_NORMAL_ROTATION;var e,i=0;t.gameStyle==t.GS_ONLINE_COMPETITION?e=t.getBasketPos(!0,t.score):(t.isSinglePlayer||t.gameStyle==t.GS_OFFLINE_COMPETITION?i=t.score:t.isDoublePlayer&&(i=Math.max(t.myScore,t.sbScore)),e=t.getBasketPos(t.getRandom(0,100)<t.BASKET_MOVING_RATE[t.getDataFitKey(t.BASKET_MOVING_RATE,i)],i)),Matter.Body.set(t.basket1,"position",Matter.Vector.create(e[0],e[1])),Matter.Body.set(t.basket11,"position",Matter.Vector.create(e[2],e[3])),Matter.Body.set(t.basket2,"position",Matter.Vector.create(e[4],e[5])),Matter.Body.set(t.basket22,"position",Matter.Vector.create(e[6],e[7])),Matter.Body.set(t.scoreTop,"position",Matter.Vector.create((t.basket1.position.x+t.basket2.position.x)/2,(t.basket1.position.y+t.basket2.position.y)/2)),Matter.Body.set(t.scoreMiddle,"position",Matter.Vector.create((t.basket1.position.x+t.basket2.position.x)/2,(t.basket1.position.y+t.basket2.position.y)/2+t.BASKETBALL_SIZE)),Matter.Body.set(t.scoreBottom,"position",Matter.Vector.create((t.basket1.position.x+t.basket2.position.x)/2,(t.basket11.position.y+t.basket22.position.y)/2-3+2*t.BASKETBALL_SIZE)),Matter.World.remove(t.world,t.basketNet,!0);var s=Matter.Composites.softBody(e[0]-t.BASKET_FRAME_WIDTH/2-4,e[1]-2*t.BASKET_FRAME_HEIGHT,4,4,(t.basket2.position.x-t.basket1.position.x)/4+3,30,!1,1,{render:{visible:!1},mass:.1,collisionFilter:{group:t.SCENE_GROUP_ID,category:t.SCENE_CATEGORY_ID,mask:t.SCENE_MASK_ID}},{});Matter.World.add(t.world,s);for(var a=0;2>a;++a)s.constraints[10+7*a].length-=3*(a+1),s.constraints[11+7*a].length-=3*(a+1),s.constraints[12+7*a].length-=3*(a+1);for(var a=0;4>a;++a)s.bodies[a].isStatic=!0,s.bodies[a].isSensor=!0,s.bodies[a].position.y-=1.5*a,t.netNodeYs[a]=s.bodies[a].position.y;t.basketNet=s,t.basketFather.x=(t.basket1.position.x+t.basket2.position.x)/2,t.basketFather.y=(t.basket1.position.y+t.basket2.position.y)/2,t.basket.rotation=t.BASKET_NORMAL_ROTATION,t.boardFather.x=t.basketFather.x,t.boardFather.y=t.basketFather.y,t.board.rotation=t.BASKET_NORMAL_ROTATION;for(var o=0,n=t.netNodes;o<n.length;o++){var r=n[o];egret.Tween.get(r).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME)}if(egret.Tween.get(t.basket).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(t.boardImg).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME),t.isWindy&&(t.windf.text=t.windForceLevel.toString(),t.winddr.rotation=45*t.windDirection,egret.Tween.get(t.windbg).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(t.winddr).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(t.windbd).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(t.windf).to({alpha:1},t.BASKET_MOVE_ANIMATE_TIME)),t.gameStyle==t.GS_ONLINE_COMPETITION){var h=CompetitionData.instance.PackageBasketData(t.basketNextData);MyCDM.instance.SendCompetitionBasketData11114(h.timeStamp-t.BASKET_MOVE_ANIMATE_TIME,t.round+1,h.basketData)}},this)},e.prototype.doActionAfterDelay=function(t,e){var i=egret.setTimeout(e,this,t);return this.timeOutIDs.push(i),i},e.prototype.getBasketPos=function(t,e){var i,s,a,o,n,r;if(this.gameStyle==this.GS_ONLINE_COMPETITION&&0==this.COMPETITION_MOVE_TYPE_RATE.length&&(t=!1),this.BASKET_CANMOVE){if(t){var h=void 0,c=void 0,l=void 0;if(this.gameStyle==this.GS_ONLINE_COMPETITION){if(this.COMPETITION_MOVE_TYPE_RATE.length>1)if(this.lastMoveTypeTimes>=2){for(;;)if(h=this.COMPETITION_MOVE_TYPE_RATE[this.getRandom(0,this.COMPETITION_MOVE_TYPE_RATE.length)],h!=this.lastMoveType){this.lastMoveType=h,this.lastMoveTypeTimes=1;break}}else h=this.COMPETITION_MOVE_TYPE_RATE[this.getRandom(0,this.COMPETITION_MOVE_TYPE_RATE.length)],this.lastMoveType==h?this.lastMoveTypeTimes++:this.lastMoveType=h;else h=this.COMPETITION_MOVE_TYPE_RATE[0];c=this.COMPETITION_MOVE_LENGHT_DATA[1]?this.getRandom(this.COMPETITION_MOVE_LENGHT_DATA[0],this.COMPETITION_MOVE_LENGHT_DATA[1]+1):this.getRandom(this.COMPETITION_MOVE_LENGHT_DATA[0],this.COMPETITION_MOVE_LENGHT_DATA[0]+1),l=this.COMPETITION_MOVE_SPEED_DATA[h][1]?this.getRandom(this.COMPETITION_MOVE_SPEED_DATA[h][0],this.COMPETITION_MOVE_SPEED_DATA[h][1]+1):this.getRandom(this.COMPETITION_MOVE_SPEED_DATA[h][0],this.COMPETITION_MOVE_SPEED_DATA[h][0]+1),this.basketNextData.style=h}else{var p=this.MOVING_TYPE_RATE[this.getDataFitKey(this.MOVING_TYPE_RATE,e)],u=this.getRandom(0,100),d=this.MOVING_SPEED_RATE[this.getDataFitKey(this.MOVING_SPEED_RATE,e)];l=this.getRandom(d[0],d[1]);var g=this.MOVING_LENGTH_RATE[this.getDataFitKey(this.MOVING_LENGTH_RATE,e)];c=this.getRandom(g[0],g[1]),h=u<p[0]?this.getRandom(0,100)<50?1:2:u<p[0]+p[1]?this.getRandom(0,100)<50?3:4:5}var m=c/this.sqrt2_2;switch(h){case 1:var _=this.getRandom(this.BASKET_ORIGIN_Y-this.BASKET_MOVE_OFFSET_Y,this.BASKET_ORIGIN_Y+this.BASKET_MOVE_OFFSET_Y-c),T=_+c;i=this.BASKET_ORIGIN_X+this.getRandom(-this.BASKET_MOVE_OFFSET_X,this.BASKET_MOVE_OFFSET_X),s=_,this.basketMoveData=BasketMoveData.createLine(i,_,i,T,c,l);break;case 2:var E=this.getRandom(this.BASKET_ORIGIN_X-this.BASKET_MOVE_OFFSET_X,this.BASKET_ORIGIN_X+this.BASKET_MOVE_OFFSET_X-c),y=E+c;s=this.BASKET_ORIGIN_Y+this.getRandom(-this.BASKET_MOVE_OFFSET_Y,this.BASKET_MOVE_OFFSET_Y),i=E,this.basketMoveData=BasketMoveData.createLine(E,s,y,s,c,l);break;case 3:i=this.getRandom(this.BASKET_ORIGIN_X-this.BASKET_MOVE_OFFSET_X,this.BASKET_ORIGIN_X+this.BASKET_MOVE_OFFSET_X-m),s=this.getRandom(this.BASKET_ORIGIN_Y+this.BASKET_MOVE_OFFSET_Y-m,this.BASKET_ORIGIN_Y+this.BASKET_MOVE_OFFSET_Y),this.basketMoveData=BasketMoveData.createLine(i,s,i+m,s-m,c,l);break;case 4:i=this.getRandom(this.BASKET_ORIGIN_X-this.BASKET_MOVE_OFFSET_X,this.BASKET_ORIGIN_X+this.BASKET_MOVE_OFFSET_X-m),s=this.getRandom(this.BASKET_ORIGIN_Y-this.BASKET_MOVE_OFFSET_Y,this.BASKET_ORIGIN_Y+this.BASKET_MOVE_OFFSET_Y-m),this.basketMoveData=BasketMoveData.createLine(i,s,i+m,s+m,c,l);break;case 5:var S=c/2,b=this.getRandom(this.BASKET_ORIGIN_X-this.BASKET_MOVE_OFFSET_X+S,this.BASKET_ORIGIN_X+this.BASKET_MOVE_OFFSET_X-S),f=this.getRandom(this.BASKET_ORIGIN_Y-this.BASKET_MOVE_OFFSET_Y+S,this.BASKET_ORIGIN_Y+this.BASKET_MOVE_OFFSET_Y-S);i=b+S,s=f,this.basketMoveData=BasketMoveData.createCircle(S,b,f,l)}a=i-this.BASKET_OFFSET_X,o=s+this.BASKET_OFFSET_Y,n=i+this.BASKET_OFFSET_X,r=s-this.BASKET_OFFSET_Y;for(var I=this.basketMovePathCircles.length,v=this.basketMoveData.pathCirclePos.length,A=0;I>A;++A)if(v>A)this.basketMovePathCircles[A].x=this.basketMoveData.pathCirclePos[A].x,this.basketMovePathCircles[A].y=this.basketMoveData.pathCirclePos[A].y;else{if(6e3==this.basketMovePathCircles[A].x)break;this.basketMovePathCircles[A].x=6e3}if(1==this.basketMoveData.style)for(var A=0;A<this.basketMoveData.pathEndCirclePos.length;++A)this.basketMovePathEndCircles[A].x=this.basketMoveData.pathEndCirclePos[A].x,this.basketMovePathEndCircles[A].y=this.basketMoveData.pathEndCirclePos[A].y;else for(var A=0;A<this.basketMovePathEndCircles.length;++A)this.basketMovePathEndCircles[A].x=6e3}else if(this.basketMoveData=null,this.shotSuccessCount>=this.BASKET_LIMIT_MOVE_COUNT?(i=this.getRandom(0,this.BASKET_MOVE_OFFSET_X)*(1==this.getRandom(0,2)?1:-1),s=this.getRandom(0,this.BASKET_MOVE_OFFSET_Y)*(1==this.getRandom(0,2)?1:-1),a=this.BASKET_ORIGIN_X-this.BASKET_OFFSET_X+i,o=this.BASKET_ORIGIN_Y+this.BASKET_OFFSET_Y+s,n=this.BASKET_ORIGIN_X+this.BASKET_OFFSET_X+i,r=this.BASKET_ORIGIN_Y-this.BASKET_OFFSET_Y+s):(i=this.getRandom(this.BASKET_FIVEBALL_POS_MIN_X,this.BASKET_FIVEBALL_POS_MAX_X),s=this.getRandom(this.BASKET_FIVEBALL_POS_MIN_Y,this.BASKET_FIVEBALL_POS_MAX_Y),a=i-this.BASKET_OFFSET_X,o=s+this.BASKET_OFFSET_Y,n=i+this.BASKET_OFFSET_X,r=s-this.BASKET_OFFSET_Y),6e3!=this.basketMovePathCircles[0].x){for(var O=this.basketMovePathCircles.length,A=0;O>A&&6e3!=this.basketMovePathCircles[A].x;++A)this.basketMovePathCircles[A].x=6e3;for(var A=0;A<this.basketMovePathEndCircles.length;++A)this.basketMovePathEndCircles[A].x=6e3}}else i=0,s=0,a=this.BASKET_ORIGIN_X-this.BASKET_OFFSET_X+i,o=this.BASKET_ORIGIN_Y+this.BASKET_OFFSET_Y+s,n=this.BASKET_ORIGIN_X+this.BASKET_OFFSET_X+i,r=this.BASKET_ORIGIN_Y-this.BASKET_OFFSET_Y+s;return this.basketNextData.posX=i,this.basketNextData.posY=s,0!=this.basketNextData.style&&(5==this.basketNextData.style?(this.basketNextData.centerX=this.basketMoveData.centerX,this.basketNextData.centerY=this.basketMoveData.centerY,this.basketNextData.radius=this.basketMoveData.radius,this.basketNextData.offset_angle=this.basketMoveData.offset_angle):(this.basketNextData.offsetX=this.basketMoveData.offsetX,this.basketNextData.offsetY=this.basketMoveData.offsetY,this.basketNextData.max_x=this.basketMoveData.max_x,this.basketNextData.min_x=this.basketMoveData.min_x,this.basketNextData.max_y=this.basketMoveData.max_y,this.basketNextData.min_y=this.basketMoveData.min_y)),[a,o,a,o-.5*this.BASKET_FRAME_HEIGHT,n,r,n,r-.5*this.BASKET_FRAME_HEIGHT]},e.prototype.createPath=function(t){var e,i;1==this.stageScaleType?(i=t.stageY<this.scaleOffset?-this.game.height-100:t.stageY>this.game.height+this.scaleOffset?-100:t.localY-this.game.height-100,e=t.stageX+100):2==this.stageScaleType?(e=t.stageX<this.scaleOffset?100:t.stageX>this.game.width+this.scaleOffset?this.game.width+100:t.localX+100,i=t.stageY-this.game.height-100):(e=t.localX+100,i=t.localY-this.game.height-100),this.gameStyle==this.GS_ONLINE_COMPETITION&&this.fingerMoveDatas.push({x:e,y:i,time:LYNtools.now()-CompetitionData.instance.startTime}),this.realCreatePath(e,i)},e.prototype.realCreatePath=function(t,e){for(var i=t/this.FORCE_SCALE_X,s=e/this.FORCE_SCALE_Y,a=this.PRE_PATH_CONSTANT_x_PRE_VELOC_CONSTANT*i,o=(this.PRE_PATH_CONSTANT_x_PRE_VELOC_CONSTANT*s,Math.abs(this.PRE_PATH_CONSTANT_chu_PRE_G_CONSTANT*s)),n=-s/(a*i*o*2),r=s/i-n*this.myBasketballOriginX*2,h=this.myBasketballOriginY-n*this.BASKETBALL_ORIGIN_X_pow_2-r*this.myBasketballOriginX,c=-r/(2*n),l=7*c/8,p=0,u=this.PATH_ALL_POINTS,d=0;u-1>d;++d){var g=r,m=this.myBasketballOriginX;if(d>0&&(g=2*n*this.pathCircles[d-1].x+r,m=this.pathCircles[d-1].x+this.PATH_POINTS_OFFSET*Math.cos(Math.atan(g))),m>l){for(var _=d;u>_&&6e3!=this.pathCircles[_].x;++_)this.pathCircles[_].x=6e3;break}this.pathCircles[d].x=m,this.pathCircles[d].y=n*Math.pow(m,2)+r*m+h,p=d}this.pathCircles[p+1].x=l,this.pathCircles[p+1].y=n*Math.pow(l,2)+r*l+h},e.prototype.startGameTimeCount=function(){egret.startTick(this.timeTickContent,this)},e.prototype.timeTickContent=function(t){if(0==this.lastTickTime)this.lastTickTime=t;else{var e=t-this.lastTickTime;this.lastTickTime=t,this.gameStyle==this.GS_REPLAY?this.realGameTime-=e*this.replaySpeed:this.realGameTime-=e;var i=Math.floor(this.realGameTime/1e3);if(this.gameTime>i){if(this.gameTime=i,this.isDoublePlayer){99==this.gameTime?(this.gameTimeLabel.scaleX=1,this.gameTimeLabel.scaleY=1):9==this.gameTime&&(this.gameTimeLabel.x=6e3,this.gameTimeBackcountArmature.x=this.doubleTop.width/2,this.gameTimeBackcountArmature.y=this.doubleTop.height/2,this.gameTimeBackcountArmature.animation.play("newAnimation",1)),this.gameTimeLabel.text=this.gameTime.toString();for(var s=0,a=this.doublePlayerChangePosTimes;s<a.length;s++){var o=a[s];this.gameTime==o}}else this.isCompetition?(this.limitTimeLabel.text=this.gameTime.toString(),this.gameTime<10&&this.doCompetitionTimeoutAnimation(50*this.gameTime),0==this.gameTime&&(egret.Tween.removeTweens(this.boardWarningImg),clearTimeout(this.competitionWarningTimeoutID),this.boardWarningImg.alpha=0)):this.gameStyle==this.GS_REPLAY&&(this.limitTimeLabel.text=this.gameTime.toString());0==this.gameTime&&(this.gameEnd(),this.removeEventListeners(),this.clearTimeout())}}return!1},e.prototype.doCompetitionTimeoutAnimation=function(t){-1==this.competitionTimeoutWarningOffsetTime?(this.competitionTimeoutWarningOffsetTime=t,this.competitionTimeoutWarningAnimationLoop(!0)):this.competitionTimeoutWarningOffsetTime=t},e.prototype.competitionTimeoutWarningAnimationLoop=function(t){var e=this;this.competitionWarningTimeoutID=setTimeout(function(){egret.Tween.get(e.boardWarningImg).to({alpha:1},200).call(function(){egret.Tween.get(e.boardWarningImg).to({alpha:0},200).call(function(){e.competitionTimeoutWarningAnimationLoop(!t)},e)},e)},this.competitionTimeoutWarningOffsetTime)},e.prototype.changePlayerPos=function(){var t=this.sb.y;this.sb.y=this.me.y,this.me.y=t,this.game.getChildIndex(this.sb)>this.game.getChildIndex(this.me)?this.game.setChildIndex(this.sb,this.game.getChildIndex(this.me)):this.game.setChildIndex(this.me,this.game.getChildIndex(this.sb));var e=this.myBasketballOriginX,i=this.myBasketballOriginY;this.myBasketballOriginX=this.sbBasketballOriginX,this.myBasketballOriginY=this.sbBasketballOriginY,this.sbBasketballOriginX=e,this.sbBasketballOriginY=i,this.gameStyle==this.GS_OFFLINE_DOUBLE&&this.ai.resetMyPos(this.sbBasketballOriginX,this.sbBasketballOriginY),this.myBasketball&&(this.myBasketball.body.position.y==this.DOWN_BASKETBALL_ORIGIN_Y?Matter.Body.set(this.myBasketball.body,"position",Matter.Vector.create(this.TOP_BASKETBALL_ORIGIN_X,this.TOP_BASKETBALL_ORIGIN_Y)):Matter.Body.set(this.myBasketball.body,"position",Matter.Vector.create(this.DOWN_BASKETBALL_ORIGIN_X,this.DOWN_BASKETBALL_ORIGIN_Y))),this.touchingEvent&&this.createPath(this.touchingEvent)},e.prototype.scored=function(t,e,i){switch(this.gameStyle){case this.GS_OFFLINE_SINGLE:case this.GS_ONLINE_SINGLE:this.score+=t,this.scoreLabel.text=this.score.toString(),MyCDM.instance.SendScoredData11011({score:this.score,resultData:""}),this.shotSuccessCount++;break;case this.GS_OFFLINE_DOUBLE:e?(this.myScore+=t,this.myScoreLabel.text=this.myScore.toString()):(this.sbScore+=t,this.sbScoreLabel.text=this.sbScore.toString()),this.shotSuccessCount++;break;case this.GS_ONLINE_DOUBLE:e&&MyCDM.instance.SendScoreData11102(i.shotRound,t,this.getNowData());break;case this.GS_OFFLINE_COMPETITION:this.competitionStyle.limitTime&&(this.score+=t,this.score>=this.COMPETITION_LIMIT_SCORE&&(this.score=this.COMPETITION_LIMIT_SCORE,this.gameEnd()),this.limitTimeScoreLabel.text=this.score.toString()),this.competitionStyle.mustThree&&3==t&&(this.score++,this.score>=this.COMPETITION_LIMIT_THREE&&this.gameEnd());break;case this.GS_ONLINE_COMPETITION:}},e.prototype.scoreBroadcast=function(t,e,i){var s=600;e?(this.sbShotCombo=0,t?(ZJ.AudioManager.Instance.play("cleanshot",1,.5),ZJ.AudioManager.Instance.play("cleanshotcheer",1,.5),this.isCompetition&&this.competitionStyle.mustThree?(egret.Tween.get(this.plus2).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.scored2).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.cleanShot).to({alpha:1},100).to({alpha:0},s),this.scored(3,e,i)):(egret.Tween.get(this.plus2).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.scored2).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.cleanShot).to({alpha:1},100).to({alpha:0},s),this.myShotCombo>0?(egret.Tween.get(this.plus3).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.scored3).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.combo).to({alpha:1},100).to({alpha:0},s),this.scored3.text=this.myShotCombo.toString(),this.scored(3+this.myShotCombo,e,i)):this.scored(3,e,i),this.myShotCombo++)):this.competitionStyle&&this.competitionStyle.mustThree||(egret.Tween.get(this.plus1).to({alpha:1},100).to({alpha:0},s),egret.Tween.get(this.scored1).to({alpha:1},100).to({alpha:0},s),this.scored(1,e,i))):(this.myShotCombo=0,t?(this.scored(3,e,i),this.sbShotCombo++):this.scored(1,e,i))
},e.prototype.missBroadcast=function(t,e){if(void 0===t&&(t=!1),6e3!=this.extraPower.x&&(this.extraPower.x=6e3,this.extraPowerBody&&(Matter.World.remove(this.world,this.extraPowerBody),this.extraPowerBody=null)),this.isSinglePlayer){this.myShotCombo=0;var i=void 0;switch(this.lifeCount){case 3:i=this.power1;break;case 2:i=this.power2;break;case 1:i=this.power3;break;default:return}if(i&&(egret.Tween.get(i).to({alpha:0},1500),egret.Tween.removeTweens(this.powerArmature),this.powerArmature.alpha=1,this.powerArmature.scaleX=1,this.powerArmature.scaleY=1,this.powerArmature.x=this.powerAmtPos.x,this.powerArmature.y=this.powerAmtPos.y,this.powerArmature.animation.play("newAnimation1",1),this.lifeCount--,this.lifeCount<=0&&(this.removeEventListeners(),this.clearTimeout(),0!=this.pathCircles.length)))for(var s=0,a=this.pathCircles;s<a.length;s++){var o=a[s];o.x=6e3,o.y=6e3}}else this.isDoublePlayer?t&&(this.myShotCombo=0):this.isCompetition&&(this.myShotCombo=0,MyCDM.instance.SendCompetitionShotResult11113(e,0,0,this.round,LYNtools.now()-CompetitionData.instance.startTime))},e.prototype.powerAnimationEnd=function(t){"newAnimation1"==t.movementID?this.lifeCount<=0?this.gameEnd():egret.Tween.get(this.powerArmature).to({x:this.powerPos[2-this.lifeCount].x,y:this.powerPos[2-this.lifeCount].y,scaleX:.4,scaleY:.4},300,egret.Ease.quadOut).to({alpha:0},400):egret.Tween.get(this.powerArmature).to({x:this.powerPos[3-this.lifeCount].x,y:this.powerPos[3-this.lifeCount].y,scaleX:.4,scaleY:.4},300,egret.Ease.quadOut).to({alpha:0},400)},e.prototype.gameEnd=function(){var t=this;switch(this.clearGame(),this.gameStyle){case this.GS_OFFLINE_SINGLE:case this.GS_OFFLINE_COMPETITION:var e=ZJ.UIManager.instance.openView(UIName.Settle);e.setData({score:this.score,top:this.weekTopScore,friend:-1,game:-1}),this.score>this.weekTopScore&&(this.weekTopScore=this.score);break;case this.GS_OFFLINE_DOUBLE:var i=ZJ.UIManager.instance.openView(UIName.PvpSettle);i.setData({myScore:this.myScore,sbScore:this.sbScore,sbLeave:!1}),this.ai.GameEnd();break;case this.GS_ONLINE_SINGLE:MyCDM.instance.SendGameResult11012({winPlayerId:MyCDM.instance.myData.playerId}),this.showSettleViewBackCountID=this.doActionAfterDelay(5e3,function(){t.showSettleView()});break;case this.GS_ONLINE_DOUBLE:MyCDM.instance.SendGameResult11012({winPlayerId:this.myScore==this.sbScore?0:this.myScore>this.sbScore?MyCDM.instance.myData.playerId:MyCDM.instance.sbData.playerId}),this.showSettleViewBackCountID=this.doActionAfterDelay(5e3,function(){var e=ZJ.UIManager.instance.openView(UIName.PvpSettle);e.setData({myScore:t.myScore,sbScore:t.sbScore,sbLeave:!1})}),this.isGameEnd=!0;break;case this.GS_ONLINE_COMPETITION:}},e.prototype.showSettleView=function(){var t=ZJ.UIManager.instance.openView(UIName.Settle);t.setData({score:this.score,top:this.weekTopScore,friend:this.friendRank,game:this.gameRank}),this.score>this.weekTopScore&&(this.weekTopScore=this.score)},e.prototype.clearGame=function(){for(var t in this.basketballs)Matter.World.remove(this.world,this.basketballs[t].body);if(this.basketballs={},this.isDoublePlayer){for(var e=0,i=this.sbBasketballImgs;e<i.length;e++){var s=i[e];s.x=6e3}for(var a=0;a<this.sbBasketballImgPoolWorkingRecord.length;++a)this.sbBasketballImgPoolWorkingRecord[a]=!1}for(var o=0,n=this.basketballImgs;o<n.length;o++){var s=n[o];s.x=6e3}for(var a=0;a<this.basketballImgPoolWorkingRecord.length;++a)this.basketballImgPoolWorkingRecord[a]=!1;if(0!=this.pathCircles.length)for(var r=0,h=this.pathCircles;r<h.length;r++){var c=h[r];c.x=6e3,c.y=6e3}this.lastTickTime=0,egret.stopTick(this.timeTickContent,this),this.pvpShotDataList=[],this.myBasketball&&this.myBasketball.body&&Matter.World.remove(this.world,this.myBasketball.body),this.myBasketball=null,this.basketMoveData=null,this.myRobotShotArmature&&this.myRobotShotArmature.animation.isPlaying&&(this.myRobotShotArmature.animation.gotoAndStopByFrame("newAnimation",1),this.me1.x=0,this.isJumping=!1,this.myRobotShotArmature.x=6e3)},e.prototype.checkWind=function(t){if(this.windDirection=0,this.gameStyle==this.GS_ONLINE_COMPETITION){var e=void 0;if(0!=this.COMPETITION_WIND_DIRECTION_RATE.length){if(this.COMPETITION_WIND_DIRECTION_RATE.length>1)if(this.lastWindDrTimes>=2){for(;;)if(e=this.COMPETITION_WIND_DIRECTION_RATE[this.getRandom(0,this.COMPETITION_WIND_DIRECTION_RATE.length)],e!=this.lastWindDr){this.lastWindDr=e,this.lastWindDrTimes=1;break}}else e=this.COMPETITION_WIND_DIRECTION_RATE[this.getRandom(0,this.COMPETITION_WIND_DIRECTION_RATE.length)],this.lastWindDr==e?this.lastWindDrTimes++:this.lastWindDr=e;else e=this.COMPETITION_MOVE_TYPE_RATE[0];this.windDirection=e,this.windForceLevel=this.COMPETITION_WIND_FORCE_DATA[e]}}else if(this.WIND_RATE[this.getDataFitKey(this.WIND_RATE,t)]>this.getRandom(0,100)){var i=this.getRandom(0,100),s=this.getRandom(0,100),a=this.getDataFitKey(this.WIND_FORCE_RATE,t);if(this.WIND_FORCE_RATE[a][0]>i?this.windForceLevel=1:this.WIND_FORCE_RATE[a][0]+this.WIND_FORCE_RATE[a][1]>i?this.windForceLevel=2:this.windForceLevel=3,this.WIND_DIRECTION_RATE[this.getDataFitKey(this.WIND_DIRECTION_RATE,t)][0]>s)this.getRandom(0,100)<50?this.windDirection=2:this.windDirection=6;else{var o=this.getRandom(0,100);25>o?this.windDirection=1:50>o?this.windDirection=3:75>o?this.windDirection=5:this.windDirection=7}}if(0!=this.windDirection){switch(this.windDirection){case 1:this.windForce=new ZJ.Vector3(1,-1,0).multiply(this.WIND_FORCE*this.windForceLevel/this.sqrt2_2);break;case 2:this.windForce=new ZJ.Vector3(1,0,0).multiply(this.WIND_FORCE*this.windForceLevel);break;case 3:this.windForce=new ZJ.Vector3(1,1,0).multiply(this.WIND_FORCE*this.windForceLevel/this.sqrt2_2);break;case 5:this.windForce=new ZJ.Vector3(-1,1,0).multiply(this.WIND_FORCE*this.windForceLevel/this.sqrt2_2);break;case 6:this.windForce=new ZJ.Vector3(-1,0,0).multiply(this.WIND_FORCE*this.windForceLevel);break;case 7:this.windForce=new ZJ.Vector3(-1,-1,0).multiply(this.WIND_FORCE*this.windForceLevel/this.sqrt2_2)}this.isWindy=!0,this.basketNextData.windL=this.windForceLevel,this.basketNextData.windDr=this.windDirection}else this.isWindy&&(this.basketNextData.windL=0,this.isWindy=!1)},e.prototype.getDataFitKey=function(t,e){var i=0;for(var s in t){if(e<Number(s))break;i=Number(s)}return i},e.prototype.basketMovePerFrame=function(){if(this.basketMoveData){var t=this.basketMoveData;switch(t.style){case 1:var e=t.offsetX*this.replaySpeed,i=t.offsetY*this.replaySpeed;this.moveBasketWithOffset(e*t.cycleFlag,i*t.cycleFlag),(this.basketFather.x>t.max_x||this.basketFather.x<t.min_x||this.basketFather.y>t.max_y||this.basketFather.y<t.min_y)&&(t.cycleFlag*=-1);break;case 2:t.nowAngle+=t.offset_angle*this.replaySpeed;var s=t.centerX+Math.cos(t.nowAngle)*t.radius,a=Math.pow(t.radius_2-Math.pow(s-t.centerX,2),.5)*(Math.floor(t.nowAngle/Math.PI)%2==0?1:-1)+t.centerY;this.moveBasketWithOffset(s-this.basketFather.x,a-this.basketFather.y)}}},e.prototype.moveBasketWithOffset=function(t,e){Matter.Body.set(this.basket1,"position",Matter.Vector.create(this.basket1.position.x+t,this.basket1.position.y+e)),Matter.Body.set(this.basket11,"position",Matter.Vector.create(this.basket11.position.x+t,this.basket11.position.y+e)),Matter.Body.set(this.basket2,"position",Matter.Vector.create(this.basket2.position.x+t,this.basket2.position.y+e)),Matter.Body.set(this.basket22,"position",Matter.Vector.create(this.basket22.position.x+t,this.basket22.position.y+e)),Matter.Body.set(this.scoreTop,"position",Matter.Vector.create(this.scoreTop.position.x+t,this.scoreTop.position.y+e)),Matter.Body.set(this.scoreMiddle,"position",Matter.Vector.create(this.scoreMiddle.position.x+t,this.scoreMiddle.position.y+e)),Matter.Body.set(this.scoreBottom,"position",Matter.Vector.create(this.scoreBottom.position.x+t,this.scoreBottom.position.y+e));for(var i=0;4>i;++i)Matter.Body.set(this.basketNet.bodies[i],"position",Matter.Vector.create(this.basketNet.bodies[i].position.x+t,this.basketNet.bodies[i].position.y+e)),this.netNodeYs[i]+=e;this.basketFather.x+=t,this.basketFather.y+=e,this.boardFather.x+=t,this.boardFather.y+=e},e.prototype.getRandom=function(t,e){return this.useSeed?(this.myRandSeed=ZJ.MathUtil.randomSeed(this.myRandSeed),ZJ.MathUtil.randomRange(t,e,this.myRandSeed)):ZJ.MathUtil.randomRange(t,e)},e.prototype.addItemInShotDataListOrderByTime=function(t){if(0==this.pvpShotDataList.length)this.pvpShotDataList.push(t);else{for(var e=[],i=!1,s=0;s<this.pvpShotDataList.length;++s)this.pvpShotDataList[s].time>t.time&&!i&&(e.push(t),i=!0),e.push(this.pvpShotDataList[s]);i||e.push(t),this.pvpShotDataList=e}},e.prototype.loadCompetitionData=function(t){var e=ZJ.TableManager.instance.tables[xlsx.cfg_c_competition][t],i=JSON.parse(e[xlsx.c_competition_wind_force]),s=JSON.parse(e[xlsx.c_competition_wind_direction]),a=e[xlsx.c_competition_basket_refresh],o=JSON.parse(e[xlsx.c_competition_moving_type]),n=JSON.parse(e[xlsx.c_competition_moving_speed]),r=JSON.parse(e[xlsx.c_competition_moving_length]);this.COMPETITION_WIND_DIRECTION_RATE=[];for(var h in s)for(var c=Number(s[h]),l=Number(h),p=0;c>p;++p)this.COMPETITION_WIND_DIRECTION_RATE.push(l);this.COMPETITION_WIND_FORCE_DATA=i,this.COMPETITION_REFRESH_BASKET="1"==a,this.COMPETITION_MOVE_TYPE_RATE=[];for(var h in o)for(var c=Number(o[h]),u=Number(h),p=0;c>p;++p)this.COMPETITION_MOVE_TYPE_RATE.push(u);this.COMPETITION_MOVE_SPEED_DATA=n,this.COMPETITION_MOVE_LENGHT_DATA=r},e.prototype.loadReplayData=function(t){this.c_myAvatarImage.source=t.playerInfo.avatarUrl,this.c_myNameLabel.text=t.playerInfo.nickname,"1"!=t.playerInfo.gender&&(this.c_mySexImage.source="femaleflag_png");var e=t.roundDatas,i=[],s=[],a=[],o=[];this.initCompetitionStyle(t.timeLimit,t.scoreLimit,t.shootLimit,t.cleanShootLimit,t.lifeLimit),this.initCompetitionUI(),this.replayWholeTime=t.endMillisecond,this.progressWholeTimeLabel.text=" / "+LYNtools.ConvertMillisecondToStandradString(t.endMillisecond);for(var n=0,r=e;n<r.length;n++){var h=r[n],c=new egret.ByteArray(h.basketData),l=JSON.parse(c.readUTF()),p=void 0;p=0==l.style?{posX:l.posX,posY:l.posY,windDr:l.windDr,windL:l.windL,style:0}:5==l.style?{posX:l.posX,posY:l.posY,windDr:l.windDr,windL:l.windL,style:5,radius:l.radius,centerX:l.centerX,centerY:l.centerY,offset_angle:l.offset_angle}:{posX:l.posX,posY:l.posY,windDr:l.windDr,windL:l.windL,style:l.style,offsetX:l.offsetX,offsetY:l.offsetY,max_x:l.max_x,min_x:l.min_x,max_y:l.max_y,min_y:l.min_y},i.push({time:h.millisecond,type:2,data:p});for(var u=0,d=h.shootDatas;u<d.length;u++){var g=d[u],m=ZJ.Util.bytesToObj(g.shootData),_={vx:m.vx,vy:m.vy};if(s.push({time:g.millisecond,type:1,data:_}),0!=g.isHit){var T={isHit:g.isHit,combo:g.addScore>2?g.addScore-3:0,nowScore:g.score};a.push({time:g.resultMillisecond,type:3,data:T})}for(var E=0,y=m.fingerMoveDatas;E<y.length;E++){var S=y[E];o.push({time:S.time,type:0,data:{x:S.x,y:S.y}})}}}var b=o.concat(s,i,a);b.sort(function(t,e){return t.time>e.time?1:t.time<e.time?-1:t.time==e.time?0:void 0}),this.replayData=b;var f={time:t.endMillisecond,type:4,data:{}};this.replayData.push(f)},e.prototype.readReplayData=function(t){if(this.replayStart){var e=this.replayTime+t*this.replaySpeed;for(this.replayTime=e;;){var i=this.replayData[this.replayDataIndex];if(!(i.time<=e))break;switch(i.type){case 0:this.realCreatePath(i.data.x,i.data.y);break;case 1:if(this.myShot(i.data.vx,i.data.vy),this.pathCircles&&0!=this.pathCircles.length)for(var s=0,a=this.pathCircles;s<a.length;s++){var o=a[s];o.x=6e3,o.y=6e3}break;case 2:this.replayResetBasket(i.data);break;case 3:this.replayScoreBroadcast(2==i.data.isHit,i.data.combo),this.score=i.data.nowScore,this.limitTimeScoreLabel.text=this.score.toString();break;case 4:return this.clearGame(),this.removeEventListeners(),this.removeEventListener(egret.Event.ENTER_FRAME,this.refreshPerFrame,this),void this.showExitViewForReplayEnd()}this.replayDataIndex++}}},e.prototype.replayResetBasket=function(t){var e=this;0!=this.windbg.alpha&&(egret.Tween.get(this.windbg).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.winddr).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.windbd).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(this.windf).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME)),egret.Tween.get(this.basket).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME);for(var i=0,s=this.netNodes;i<s.length;i++){var a=s[i];egret.Tween.get(a).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME)}egret.Tween.get(this.boardImg).to({alpha:0},this.BASKET_MOVE_ANIMATE_TIME).call(function(){e.basketScored=!1,egret.Tween.removeTweens(e.board),egret.Tween.removeTweens(e.basket);var i=t.posX,s=t.posY,a=i-e.BASKET_OFFSET_X,o=s+e.BASKET_OFFSET_Y,n=i+e.BASKET_OFFSET_X,r=s-e.BASKET_OFFSET_Y;Matter.Body.set(e.basket1,"position",Matter.Vector.create(a,o)),Matter.Body.set(e.basket11,"position",Matter.Vector.create(a,o-.5*e.BASKET_FRAME_HEIGHT)),Matter.Body.set(e.basket2,"position",Matter.Vector.create(n,r)),Matter.Body.set(e.basket22,"position",Matter.Vector.create(n,r-.5*e.BASKET_FRAME_HEIGHT)),Matter.Body.set(e.scoreTop,"position",Matter.Vector.create((e.basket1.position.x+e.basket2.position.x)/2,(e.basket1.position.y+e.basket2.position.y)/2)),Matter.Body.set(e.scoreMiddle,"position",Matter.Vector.create((e.basket1.position.x+e.basket2.position.x)/2,(e.basket11.position.y+e.basket22.position.y)/2+e.BASKETBALL_SIZE)),Matter.Body.set(e.scoreBottom,"position",Matter.Vector.create((e.basket1.position.x+e.basket2.position.x)/2,(e.basket11.position.y+e.basket22.position.y)/2-3+2*e.BASKETBALL_SIZE)),Matter.World.remove(e.world,e.basketNet,!0),e.basketNet=Matter.Composites.softBody(a-e.BASKET_FRAME_WIDTH/2-4,o-2*e.BASKET_FRAME_HEIGHT,4,4,(e.basket2.position.x-e.basket1.position.x)/4+3,30,!1,1,{render:{visible:!1},mass:.1,collisionFilter:{group:e.SCENE_GROUP_ID,category:e.SCENE_CATEGORY_ID,mask:e.SCENE_MASK_ID}},{}),Matter.World.add(e.world,e.basketNet);for(var h=0;2>h;++h)e.basketNet.constraints[10+7*h].length-=3*(h+1),e.basketNet.constraints[11+7*h].length-=3*(h+1),e.basketNet.constraints[12+7*h].length-=3*(h+1);for(var h=0;4>h;++h)e.basketNet.bodies[h].isStatic=!0,e.basketNet.bodies[h].isSensor=!0,e.basketNet.bodies[h].position.y-=1.5*h,e.netNodeYs[h]=e.basketNet.bodies[h].position.y;e.basketFather.x=(e.basket1.position.x+e.basket2.position.x)/2,e.basketFather.y=(e.basket1.position.y+e.basket2.position.y)/2,e.basket.rotation=e.BASKET_NORMAL_ROTATION,e.boardFather.x=e.basketFather.x,e.boardFather.y=e.basketFather.y,e.board.rotation=e.BASKET_NORMAL_ROTATION;for(var c=0,l=e.netNodes;c<l.length;c++){var p=l[c];egret.Tween.get(p).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME)}if(egret.Tween.get(e.basket).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(e.boardImg).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),0!=t.windL)switch(e.windForceLevel=t.windL,e.windDirection=t.windDr,e.windf.text=e.windForceLevel.toString(),e.winddr.rotation=45*e.windDirection,egret.Tween.get(e.windbg).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(e.winddr).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(e.windbd).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),egret.Tween.get(e.windf).to({alpha:1},e.BASKET_MOVE_ANIMATE_TIME),e.isWindy=!0,e.windDirection){case 1:e.windForce=new ZJ.Vector3(1,-1,0).multiply(e.WIND_FORCE*e.windForceLevel/e.sqrt2_2);break;case 2:e.windForce=new ZJ.Vector3(1,0,0).multiply(e.WIND_FORCE*e.windForceLevel);break;case 3:e.windForce=new ZJ.Vector3(1,1,0).multiply(e.WIND_FORCE*e.windForceLevel/e.sqrt2_2);break;case 5:e.windForce=new ZJ.Vector3(-1,1,0).multiply(e.WIND_FORCE*e.windForceLevel/e.sqrt2_2);break;case 6:e.windForce=new ZJ.Vector3(-1,0,0).multiply(e.WIND_FORCE*e.windForceLevel);break;case 7:e.windForce=new ZJ.Vector3(-1,-1,0).multiply(e.WIND_FORCE*e.windForceLevel/e.sqrt2_2)}else e.isWindy=!1;if(0!=t.style){5==t.style?e.basketMoveData=BasketMoveData.createReplayCircle(t.centerX,t.centerY,t.radius,t.offset_angle):e.basketMoveData=BasketMoveData.createReplayLine(t.posX,t.posY,t.style,t.offsetX,t.offsetY,t.max_x,t.max_y,t.min_x,t.min_y);for(var u=e.basketMovePathCircles.length,h=0;u>h;++h)if(h<e.basketMoveData.pathCirclePos.length)e.basketMovePathCircles[h].x=e.basketMoveData.pathCirclePos[h].x,e.basketMovePathCircles[h].y=e.basketMoveData.pathCirclePos[h].y;else{if(6e3==e.basketMovePathCircles[h].x)break;e.basketMovePathCircles[h].x=6e3}if(1==e.basketMoveData.style)for(var h=0;h<e.basketMoveData.pathEndCirclePos.length;++h)e.basketMovePathEndCircles[h].x=e.basketMoveData.pathEndCirclePos[h].x,e.basketMovePathEndCircles[h].y=e.basketMoveData.pathEndCirclePos[h].y;else for(var h=0;h<e.basketMovePathEndCircles.length;++h)e.basketMovePathEndCircles[h].x=6e3}},this)},e.prototype.replayScoreBroadcast=function(t,e){var i=600;t?(ZJ.AudioManager.Instance.play("cleanshot",1,.5),ZJ.AudioManager.Instance.play("cleanshotcheer",1,.5),this.competitionStyle.mustThree?(egret.Tween.get(this.plus2).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.scored2).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.cleanShot).to({alpha:1},100).to({alpha:0},i)):(egret.Tween.get(this.plus2).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.scored2).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.cleanShot).to({alpha:1},100).to({alpha:0},i),e>0&&(egret.Tween.get(this.plus3).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.scored3).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.combo).to({alpha:1},100).to({alpha:0},i),this.scored3.text=e.toString()))):this.competitionStyle&&this.competitionStyle.mustThree||(egret.Tween.get(this.plus1).to({alpha:1},100).to({alpha:0},i),egret.Tween.get(this.scored1).to({alpha:1},100).to({alpha:0},i))},e.prototype.replayProcessBarUpdate=function(t){this.replayStart&&0!=this.replayWholeTime&&(this.replayProcessTime+=t*this.replaySpeed,this.progressBarImg.width=20+373*this.replayProcessTime/this.replayWholeTime,this.progressTimeLabel.text=LYNtools.ConvertMillisecondToStandradString(this.replayProcessTime))},e.prototype.clearTimeout=function(){for(var t=0,e=this.timeOutIDs;t<e.length;t++){var i=e[t];egret.clearTimeout(i)}this.timeOutIDs=[]},e.prototype.getBasketballImage=function(t){var e,i,s;t?(e=this.sbBasketballImgs,i=this.sbBasketballImgPoolWorkingRecord,s="sbball_png"):(e=this.basketballImgs,i=this.basketballImgPoolWorkingRecord,s="ball_png");for(var a=e.length,o=0;a>o;++o)if(!i[o])return i[o]=!0,e[o].alpha=1,e[o];var n=this.createImage(s);return e.push(n),i.push(!0),n},e.prototype.createImage=function(t){var e=new eui.Image(t);return e.anchorOffsetX=this.BASKETBALL_SIZE,e.anchorOffsetY=this.BASKETBALL_SIZE,e.x=6e3,e.y=0,this.ballFather.addChild(e),e},e.prototype.addEventListeners=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},e.prototype.removeEventListeners=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},e.prototype.onDestroy=function(){return t.prototype.onDestroy.call(this),this.removeEventListeners(),this.removeEventListener(egret.Event.ENTER_FRAME,this.refreshPerFrame,this),this.clearTimeout(),0},e}(ZJ.ViewBase);__reflect(GameView.prototype,"GameView");var PvpSettleView=function(t){function e(){var e=t.call(this)||this;return e.againBtnDidClick=!1,e.sbDidStart=!1,e.sbDidLeave=!1,e.skinName="resource/eui_skins/view/PvpSettleViewSkin.exml",e}return __extends(e,t),e.prototype.childrenCreated=function(){var t=this;if(!MyCDM.instance.gameStyle||0==MyCDM.instance.gameStyle)return void this.btnLightImage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){ZJ.EventManager.instance.dispatchEvent(new egret.Event(EventName.GAME_RESTART)),ZJ.UIManager.instance.destroyView(UIName.PvpSettle)},this);this.myNameLabel.text=MyCDM.instance.myData.nickname,this.myAvatarImage.source=MyCDM.instance.myData.avatarUrl;var e=new egret.Shape;e.graphics.beginFill(16711680),e.graphics.drawCircle(0,0,this.myAvatarImage.width/2-4),e.graphics.endFill(),this.settleGroup.addChild(e),e.x=this.myAvatarImage.x+this.myAvatarImage.width/2+1,e.y=this.myAvatarImage.y+this.myAvatarImage.height/2+1,this.myAvatarImage.mask=e,this.sbNameLabel.text=MyCDM.instance.sbData.nickname,this.sbAvatarImage.source=MyCDM.instance.sbData.avatarUrl;var i=new egret.Shape;i.graphics.beginFill(16711680),i.graphics.drawCircle(0,0,this.sbAvatarImage.width/2-4),i.graphics.endFill(),this.settleGroup.addChild(i),i.x=this.sbAvatarImage.x+this.sbAvatarImage.width/2+1,i.y=this.sbAvatarImage.y+this.sbAvatarImage.height/2+1,this.sbAvatarImage.mask=i,MyCDM.instance.sbIsFriend?this.makeFriendImage.source="pvp_hmf_png":this.makeFriendImage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.makeFriendImage.source="pvp_hmf_png",ChushouSDK.instance.csFollowUser(MyCDM.instance.sbData.openId.toString(),function(t){0==t.code&&(MyCDM.instance.sbIsFriend=!0)})},this),MyCDM.instance.OnData11003=function(t){ZJ.EventManager.instance.dispatchEvent(new egret.Event(EventName.GAME_RESTART)),MyCDM.instance.SendProcessData11010({processData:PvpData.instance.PackageStartTime()}),ZJ.UIManager.instance.destroyView(UIName.PvpSettle)},MyCDM.instance.OnData11007=function(e){0!=e.result&&(t.btnImage.source="pvp_leave_png",t.stateImage.visible=!1,t.btnLightImage.visible=!1,t.sbStartImage.visible=!1,t.sbDidLeave=!0)},MyCDM.instance.OnData11009=function(e){t.againBtnDidClick||(t.stateImage.source="pvp_accept_png",t.sbStartImage.visible=!0,t.sbDidStart=!0)},this.btnLightImage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){ChushouSDK.instance.csCheckEntryFee(function(e){"0"==e.code?(t.againBtnDidClick=!0,t.btnLightImage.visible=!1,t.btnLightImage.alpha=0,MyCDM.instance.PlayAgain11007(),t.sbDidStart||(t.stateImage.source="pvp_waitaccept_png")):"100"==e.code?ChushouSDK.instance.csInvokeRecharge(2,function(t){"0"==t.code?console.log("拉起充值页面成功"):console.log(t.errMsg)}):console.log(e.errMsg)})},this),this.btnLightImage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.btnLightImage.alpha=1},this),this.btnLightImage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.btnLightImage.alpha=0},this),this.btnImage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.sbDidLeave&&ChushouSDK.instance.csExitGame()},this)},e.prototype.setData=function(t){0==MyCDM.instance.gameStyle?t.myScore==t.sbScore?this.resultImage.source="pvp_draw_png":t.myScore<t.sbScore&&(this.resultImage.source="pvp_fail_png",this.ballImage.source="pvp_failball_png"):0==t.winId?this.resultImage.source="pvp_draw_png":t.winId!=MyCDM.instance.myData.playerId&&(this.resultImage.source="pvp_fail_png",this.ballImage.source="pvp_failball_png"),this.myScoreLabel.text=t.myScore.toString(),this.sbScoreLabel.text=t.sbLeave?"0":t.sbScore.toString(),t.sbLeave&&(this.btnImage.source="pvp_leave_png",this.stateImage.visible=!1,this.btnLightImage.visible=!1,this.sbDidLeave=!0)},e}(ZJ.ViewBase);__reflect(PvpSettleView.prototype,"PvpSettleView");var SettleView=function(t){function e(){var e=t.call(this)||this;return e.canContinue=!1,e.skinName="resource/eui_skins/view/SettleViewSkin.exml",e}return __extends(e,t),e.prototype.childrenCreated=function(){var t=this;this.restartLight.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.canContinue&&(t.restartLight.alpha=1)},this),this.restartLight.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.restartLight.alpha=0},this),this.restartLight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restartBtnOnClick,this),this.sortLight.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.canContinue&&(t.sortLight.alpha=1)},this),this.sortLight.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.sortLight.alpha=0},this),this.sortLight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sortBtnOnClick,this);var e=ZJ.ResManager.instance.loadDragonBones("sz","szA");e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.settleGroup.removeChild(e),t.canContinue=!0},this),this.settleGroup.addChild(e),e.x=this.sx00.x+.5*e.width+3,e.y=this.sx00.y+.5*e.height,e.animation.play("sz1",9);var i=ZJ.ResManager.instance.loadDragonBones("sz","szA");i.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.settleGroup.removeChild(i)},this),this.settleGroup.addChild(i),i.x=this.s0x0.x+.5*i.width+3,i.y=this.s0x0.y+.5*i.height,i.animation.play("sz2",7);var s=ZJ.ResManager.instance.loadDragonBones("sz","szA");s.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.settleGroup.removeChild(s)},this),this.settleGroup.addChild(s),s.x=this.s00x.x+.5*s.width+3,s.y=this.s00x.y+.5*s.height,s.animation.play("sz3",5)},e.prototype.setData=function(t){-1==t.friend?(this.fRank.visible=!1,this.fRanknull.visible=!0):this.fRank.text=t.friend.toString(),-1==t.game?(this.gRank.visible=!1,this.gRanknull.visible=!0):this.gRank.text=t.game.toString();for(var e=t.top>t.score?t.top.toString():t.score.toString(),i="",s=0;s<e.length;s++)i+=e[s],i+=" ";this.bestScore.text=i,this.showScore(t.score)},e.prototype.showScore=function(t){var e=t.toString();switch(e.length){case 3:this.sx00.text=e.charAt(0),this.s0x0.text=e.charAt(1),this.s00x.text=e.charAt(2);break;case 2:this.sx00.text="0",this.s0x0.text=e.charAt(0),this.s00x.text=e.charAt(1);break;case 1:this.sx00.text="0",this.s0x0.text="0",this.s00x.text=e.charAt(0);break;default:this.sx00.text="9",this.s0x0.text="9",this.s00x.text="9"}},e.prototype.restartBtnOnClick=function(){this.canContinue&&(ZJ.EventManager.instance.dispatchEvent(new egret.Event(EventName.GAME_RESTART)),ZJ.UIManager.instance.destroyView(UIName.Settle))},e.prototype.sortBtnOnClick=function(){this.canContinue&&(ModuleConfig.compile.danji||ChushouSDK.instance.csExitGame())},e.prototype.onDestroy=function(){return t.prototype.onDestroy.call(this),0},e}(ZJ.ViewBase);__reflect(SettleView.prototype,"SettleView");var ChushouDataModel=function(){function t(){this.INTERVAL_PING=5e3,this.gameStyle=0,this.sbIsFriend=!1,this.intervalPing=0,ZJ.SocketManager.instance.addEventListener(ZJ.CommonEventName.SOCKET_CONNECTED,this.onConnect,this),ZJ.SocketManager.instance.addEventListener(ZJ.CommonEventName.SOCKET_DATA,this.onData,this),"20"==chushouGameConfig.launchMode?(this.gameStyle=1,ZJ.SocketManager.instance.connectByUrl(ModuleConfig.ws+"://"+ModuleConfig.ip+":"+ModuleConfig.singlePort)):"30"==chushouGameConfig.launchMode&&(this.gameStyle=2,ZJ.SocketManager.instance.connectByUrl(ModuleConfig.ws+"://"+ModuleConfig.ip+":"+ModuleConfig.doublePort))}return t.prototype.onConnect=function(){var t=this;ChushouSDK.instance.csAuthRequest(function(e){t.Login10000(),t.ping11004(),t.CsAuthRequestCallBack()})},t.prototype.onData=function(t){var e=this,i=t.data.data;switch(console.log(t.data.protoID),console.log(JSON.stringify(i)),t.data.protoID){case 1e4:0==i.result?(5!=this.gameStyle&&6!=this.gameStyle?this.match10001():5==this.gameStyle&&(this.myData={playerId:i.playerId,openId:i.openId,nickname:i.nickname,avatarUrl:i.avatarUrl,gender:"male",isRobot:0,battleTimes:1}),this.myReconnectTicket=i.ticket,this.doAction(this.OnData10000,i)):ChushouSDK.instance.csExitGame();break;case 10001:0==i.result?(this.doAction(this.OnData10001,i),2==this.gameStyle?(ChushouSDK.instance.gameRoomId=i.roomId,ChushouSDK.instance.csJoinRoom(function(t){0==t.code?e.gamePreStart11002():ChushouSDK.instance.csExitGame()})):1==this.gameStyle&&this.gamePreStart11002()):2==i.result?ChushouSDK.instance.csExitGame():ChushouSDK.instance.csExitGame();break;case 10010:0==i.result?ChushouSDK.instance.csPayEntryFee(i.cpOrderId,i.cpPropId,i.cpPropName,function(t){"0"==t.code?console.log("成功扣除入场费"):("100"==t.code&&console.log("触手豆余额不足"),console.log(t.code+","+t.errMsg))}):console.log("商品不存在"),this.doAction(this.OnData10010,i);break;case 11002:0==i.result?this.doAction(this.OnData11002,i):ChushouSDK.instance.csExitGame();break;case 11003:2==this.gameStyle?(ZJ.SocketManager.instance.send(10010,{cpPropId:"11"}),i.playerInfos[0].openId==ChushouSDK.instance.csAuthRequestData.openUid?(this.myData=i.playerInfos[0],this.sbData=i.playerInfos[1]):(this.myData=i.playerInfos[1],this.sbData=i.playerInfos[0]),ChushouSDK.instance.csGetUserRelationship([this.sbData.openId],function(t){e.sbIsFriend=!1,0==t.code&&0!=t.users[0].relationship&&(e.sbIsFriend=!0)})):1==this.gameStyle&&(this.myData=i.playerInfos[0]),this.doAction(this.OnData11003,i);break;case 11005:this.doAction(this.OnData11005,i);break;case 11006:this.doAction(this.OnData11006,i);break;case 11007:this.doAction(this.OnData11007,i);break;case 11008:this.doAction(this.OnData11008,i);break;case 11009:this.doAction(this.OnData11009,i);break;case 11010:this.doAction(this.OnData11010,i);break;case 11011:this.doAction(this.OnData11011,i);break;case 11012:this.doAction(this.OnData11012,i);default:this.extendOnData(t.data.protoID,i)}},t.prototype.extendOnData=function(t,e){},t.prototype.doAction=function(t,e){t&&t(e)},t.prototype.Login10000=function(){egret.log("do Login"),ZJ.SocketManager.instance.send(1e4,{openId:ChushouSDK.instance.csAuthRequestData.openUid,sign:"sign",timestamp:ZJ.Util.timeStamp(),appId:ModuleConfig.compile.channel_id,params:[ChushouSDK.instance.csAuthRequestData.nickname,ChushouSDK.instance.csAuthRequestData.gender,ChushouSDK.instance.csAuthRequestData.avatar]})},t.prototype.match10001=function(){egret.log("do Match"),1==this.gameStyle?ZJ.SocketManager.instance.send(10001,{gameMode:this.gameStyle,matchType:1}):2==this.gameStyle&&ZJ.SocketManager.instance.send(10001,{gameMode:this.gameStyle,matchType:2,matchId:ChushouSDK.instance.csAuthRequestData.csGroupId.toString()})},t.prototype.gamePreStart11002=function(){egret.log("do Ready"),ZJ.SocketManager.instance.send(11002)},t.prototype.ping11004=function(){egret.log("do Ping"),this.intervalPing=setInterval(function(){ZJ.SocketManager.instance.send(11004)},this.INTERVAL_PING)},t.prototype.GetGameState11005=function(){0!=this.gameStyle&&(egret.log("get game state"),ZJ.SocketManager.instance.send(11005))},t.prototype.GetPlayerData11006=function(){0!=this.gameStyle&&(egret.log("get player data"),ZJ.SocketManager.instance.send(11006))},t.prototype.PlayAgain11007=function(){0!=this.gameStyle&&(egret.log("play again"),ZJ.SocketManager.instance.send(11007))},t.prototype.GetHighestScore11008=function(){0!=this.gameStyle&&(egret.log("get highest score"),ZJ.SocketManager.instance.send(11008))},t.prototype.SendProcessData11010=function(t){0!=this.gameStyle&&ZJ.SocketManager.instance.send(11010,{processData:ZJ.Util.objToByteArray(t.processData).bytes})},t.prototype.SendScoredData11011=function(t){0!=this.gameStyle&&(egret.log("do Upload Score : "+t.score),ZJ.SocketManager.instance.send(11011,{score:t.score,resultData:ZJ.Util.objToByteArray(t.resultData).bytes}))},t.prototype.SendGameResult11012=function(t){0!=this.gameStyle&&(egret.log("win id : "+t.winPlayerId),ZJ.SocketManager.instance.send(11012,{winPlayerId:t.winPlayerId}))},t.prototype.SendFriendList=function(t){0!=this.gameStyle&&(egret.log("send friendList : "+t.openId),ZJ.SocketManager.instance.send(11014,{openId:t.openId}))},t}();__reflect(ChushouDataModel.prototype,"ChushouDataModel");var ChushouLoadingView=function(t){function e(){var e=t.call(this)||this;return e.intervalID=0,e.ran1=0,e.ran2=0,e.SEND_PROGRESS=10,e.progressIndex=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=ZJ.ShapeUtil.getRect(0,1,this.stage.stageWidth,this.stage.stageHeight);this.addChild(e)},e.prototype.startCount=function(){var t=this;this.intervalID=setInterval(function(){t.ran2=Math.min(t.ran2+8*Math.random()+2,99),t.progress.value=Math.floor((t.ran1+t.ran2)/2)},200)},e.prototype.onProgress=function(t,e){console.log(t+" / "+e),this.progressIndex==this.SEND_PROGRESS-1&&ChushouSDK.instance.csNotifyLoadProgress(t/e*100),this.progressIndex=++this.progressIndex%this.SEND_PROGRESS
},e.prototype.onDestroy=function(){return t.prototype.onDestroy.call(this),0},e}(ZJ.ViewBase);__reflect(ChushouLoadingView.prototype,"ChushouLoadingView");var ZJ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.cb=null,t.leftSecond=0,t.intervalID=0,t.isPause=!1,t.skinName="CountDownSkin",t}return __extends(i,e),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.start=function(t){var e=this;this.stop(),this.isPause=!1,this.leftSecond=t,this.count(),this.intervalID=setInterval(function(){e.count()},1e3)},i.prototype.pause=function(){this.isPause=!0},i.prototype.resume=function(){this.isPause=!1},i.prototype.stop=function(){clearInterval(this.intervalID)},i.prototype.setSecond=function(e){var i=Math.floor(e/60)%60,s=e%60,a=this.checkTime(i),o=this.checkTime(s);this.label.text=t.Util.strFormat("{0}:{1}",a,o)},i.prototype.count=function(){return this.setSecond(this.leftSecond),0==this.leftSecond?(this.stop(),void(null!=this.cb&&this.cb())):void(this.isPause||this.leftSecond--)},i.prototype.checkTime=function(t){return 10>t&&(t="0"+t),t},i.prototype.OnDestroy=function(){this.cb=null,this.stop()},i}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ZJ.CountDown",["eui.UIComponent","egret.DisplayObject"])}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function e(){this.aa=null,this.stage=null,this.dbFactory=dragonBones.EgretFactory.factory,this.dbFileNames=[]}return Object.defineProperty(e,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.stage=t,this.aa=new AssetAdapter,[4,this.loadConfig("resource/default.res.json?v="+Math.random(),"resource/")];case 1:return e.sent(),[4,this.loadTheme()];case 2:return e.sent(),[2]}})})},e.prototype.loadRes=function(t,e,i,s){this.aa.getAsset(t,e,i,s)},e.prototype.loadExistRes=function(t){return RES.getRes(t)},e.prototype.loadConfig=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,RES.loadConfig(t,e)];case 1:return i.sent(),[2]}})})},e.prototype.loadGroup=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=null),__awaiter(this,void 0,void 0,function(){var s;return __generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,RES.loadGroup(t,e,i)];case 1:return a.sent(),[3,3];case 2:return s=a.sent(),console.error(s),[3,3];case 3:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var s=new eui.Theme("resource/default.thm.json",t.stage);s.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.loadMovieClip=function(e,i,s){t.ResManager.instance.loadRes(e+"_json",function(a,o){var n=a;t.ResManager.instance.loadRes(e+"_png",function(t,e){var a=t,o=new egret.MovieClipDataFactory(n,a),r=new egret.MovieClip(o.generateMovieClipData(i));s(r,o)},this)},this)},e.prototype.loadDragonBones=function(t,e){if(void 0===e&&(e=""),""==e&&(e=t),-1==this.dbFileNames.indexOf(t)){var i=this.loadExistRes(t+"_ske_json"),s=this.loadExistRes(t+"_tex_json"),a=this.loadExistRes(t+"_tex_png");this.dbFactory.parseDragonBonesData(i),this.dbFactory.parseTextureAtlasData(s,a),this.dbFileNames.push(t)}var o=this.dbFactory.buildArmatureDisplay(e);return o},e.prototype.replaceDBSlotDisplay=function(t,e,i,s,a){void 0===e&&(e=""),""==e&&(e=t),this.dbFactory.replaceSlotDisplay(t,e,i,s,a)},e._instance=new e,e}();t.ResManager=e,__reflect(e.prototype,"ZJ.ResManager")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(){}return t.getRect=function(t,e,i,s,a,o){void 0===a&&(a=0),void 0===o&&(o=0);var n=new egret.Shape;return n.graphics.beginFill(t,e),n.graphics.drawRect(a,o,i,s),n.graphics.endFill(),n},t.getCircle=function(t,e,i,s,a){void 0===s&&(s=0),void 0===a&&(a=0);var o=new egret.Shape;return o.graphics.beginFill(t,e),o.graphics.drawCircle(s,a,i),o.graphics.endFill(),o},t.getLine=function(t,e,i,s,a,o,n){var r=new egret.Shape;return r.graphics.lineStyle(i,t,e),r.graphics.moveTo(s,a),r.graphics.lineTo(o,n),r.graphics.endFill(),r},t.getArc=function(t,e,i,s,a,o,n,r,h){void 0===n&&(n=!1),void 0===r&&(r=0),void 0===h&&(h=0);var c=new egret.Shape;return c.graphics.lineStyle(i,t,e),c.graphics.drawArc(r,h,s,Math.PI/180*a,Math.PI/180*o,n),c.graphics.endFill(),c},t.getArch=function(t,e,i,s,a,o,n,r){void 0===o&&(o=!1),void 0===n&&(n=0),void 0===r&&(r=0);var h=new egret.Shape;return h.graphics.beginFill(t,e),h.graphics.drawArc(n,r,i,Math.PI/180*s,Math.PI/180*a,o),h.graphics.endFill(),h},t}();t.ShapeUtil=e,__reflect(e.prototype,"ZJ.ShapeUtil")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(t){function e(e,i,s,a){var o=t.call(this,e,i,s,a)||this;return o.data=null,o}return __extends(e,t),e}(egret.Event);t.SocketDataEvent=e,__reflect(e.prototype,"ZJ.SocketDataEvent")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.socket=null,t.ProtoBufRoot=new protobuf.Root,t.send=null,t.onSocketData=null,t.getProtoByID=null,t._company=1,t.clientIndex=0,t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),i.prototype.init=function(){return this.parseProto(),this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.setCompany(1),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketConnect,this),0},Object.defineProperty(i.prototype,"connected",{get:function(){return this.socket.connected},enumerable:!0,configurable:!0}),i.prototype.parseProto=function(){for(var t=this.ProtoBufRoot,e=ModuleConfig.protoFiles,i=0,s=e.length;s>i;++i){var a=RES.getRes(e[i]);protobuf.parse(a,t)}},i.prototype.parseProtoByText=function(t){protobuf.parse(t,this.ProtoBufRoot)},i.prototype.setCompany=function(t){switch(this._company=t,t){case 2:this.send=this.sendYouai,this.onSocketData=this.onSocketDataYouai,this.getProtoByID=this.getProtoByIDYouai;break;case 3:this.send=this.sendAli,this.getProtoByID=this.getProtoByIDHuoshu;break;default:this.send=this.sendHuoshu,this.onSocketData=this.onSocketDataHuoshu,this.getProtoByID=this.getProtoByIDHuoshu}},i.prototype.connect=function(t,e){this.socket.connect(t,e)},i.prototype.connectByUrl=function(t){this.socket.connectByUrl(t)},i.prototype.close=function(){this.socket.close()},i.prototype.onSocketConnect=function(e){var i=new egret.Event(t.CommonEventName.SOCKET_CONNECTED);this.dispatchEvent(i)},i.prototype.buildSmallShitByID=function(t,e){var i=this.getProtoByID(t,!0),s=this.buildSmallShit(i,e);return s},i.prototype.decodeShitByID=function(t,e){var i=this.getProtoByID(t,!1),s=this.decodeShit(i,e);return s},i.prototype.buildSmallShit=function(t,e){var i=t.create(e),s=t.encode(i),a=s.finish();return a},i.prototype.decodeShit=function(t,e){var i=t.decode(e);return i},i.prototype.sendHuoshu=function(t,e){void 0===e&&(e={});var i=this.buildSmallShitByID(t,e),s=new egret.ByteArray;s.writeInt(i.byteLength),s.writeShort(t),s._writeUint8Array(i),this.socket.writeBytes(s)},i.prototype.onSocketDataHuoshu=function(e){var i=new egret.ByteArray;this.socket.readBytes(i);var s=(i.readInt(),i.readShort()),a=this.decodeShitByID(s,i.bytes.subarray(6)),o=new t.SocketDataEvent(t.CommonEventName.SOCKET_DATA);o.data={data:a,protoID:s},this.dispatchEvent(o)},i.prototype.getProtoByIDHuoshu=function(e,i){var s=(Math.floor(e/1e3),""),a="";a=i?"cs_":"sc_",s=a+e;var o=t.SocketManager.instance.ProtoBufRoot,n=o.lookupType(s);return n},i.prototype.sendYouai=function(t,e){void 0===e&&(e={});var i=this.buildSmallShitByID(t,e),s=this.buildSmallShitByID(99999,{messageId:t,clientIndex:this.clientIndex++,data:i}),a=new egret.ByteArray(s);this.socket.writeBytes(a)},i.prototype.onSocketDataYouai=function(e){var i=new egret.ByteArray;this.socket.readBytes(i);var s=this.decodeShitByID(99999,i.bytes),a="",o={},n=s.result,r=s.messageId;s.result?o=this.decodeShitByID(s.messageId,s.data):a=t.Util.Utf8ArrayToStr(s.data);var h=new t.SocketDataEvent(t.CommonEventName.SOCKET_DATA);h.data={data99999:s,error:a,result:n,data:o,protoID:r},this.dispatchEvent(h)},i.prototype.getProtoByIDYouai=function(e,i){var s="";if(i)switch(e){case 99999:s="ClientCmdData";break;case 1e3:s="CmdLoginGameReqMsg";break;case 1001:s="CmdPingReqMsg";break;case 1300:s="CmdJumperUploadAnswerReqMsg";break;case 1303:s="CmdJumperGameOverReqMsg"}else switch(e){case 99999:s="ServerCmdData";break;case 1e3:s="CmdLoginGameRspMsg";break;case 1001:s="CmdPingRspMsg";break;case 1300:s="CmdJumperUploadAnswerRspMsg";break;case 1303:s="CmdJumperGameOverRspMsg";break;case 1399:s="CmdBroadcastJumperBC"}var a=t.SocketManager.instance.ProtoBufRoot,o=a.lookupType(s);return o},i.prototype.sendAli=function(t,e){void 0===e&&(e={});var i=this.buildSmallShitByID(t,e),s=new egret.ByteArray;s.writeInt(i.byteLength),s.writeShort(t),s._writeUint8Array(i),ALISDK.CatcherSDK.instance().sendData(s.buffer)},i.prototype.onSocketDataAli=function(e){var i=new egret.ByteArray(e),s=(i.readInt(),i.readShort()),a=this.decodeShitByID(s,i.bytes.subarray(6));console.log("receive: "+s),console.log(a);var o=new t.SocketDataEvent(t.CommonEventName.SOCKET_DATA);o.data={data:a,protoID:s},this.dispatchEvent(o)},i.prototype.connectByUrlAli=function(e){var i=this;ALISDK.CatcherSDK.init({url:"ws://"+e.ip+":"+e.port+"/ws/game",gameVersion:"0.0.1",gameId:"123123",messageType:"ARRAYBUFFER"}),ALISDK.CatcherSDK.instance().on("CONNECT",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"CONNECT",event:e},i.dispatchEvent(s)}).on("PROGRESS",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"PROGRESS",event:e},i.dispatchEvent(s)}).on("READY",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"READY",event:e},i.dispatchEvent(s)}).on("KICK",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"KICK",event:e},i.dispatchEvent(s)}).on("GAMEOVER",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"GAMEOVER",event:e},i.dispatchEvent(s)}).on("BREAK",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"BREAK",event:e},i.dispatchEvent(s)}).on("CONTINUE",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"CONTINUE",event:e},i.dispatchEvent(s)}).on("ERROR",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"ERROR",event:e},i.dispatchEvent(s)}).on("MIC_CHANGE",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"MIC_CHANGE",event:e},i.dispatchEvent(s)}).on("AUDIO_CHANGE",function(e){var s=new t.ChannelDataEvent(t.CommonEventName.CHANNEL_DATA);s.data={eventName:"AUDIO_CHANGE",event:e},i.dispatchEvent(s)}).on("MESSAGE",function(t){i.onSocketDataAli(t.data)}).start()},i._instance=new i,i}(egret.EventDispatcher);t.SocketManager=e,__reflect(e.prototype,"ZJ.SocketManager")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function e(){this._tables={}}return Object.defineProperty(e,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){return this.load("bg_djw_png"),0},Object.defineProperty(e.prototype,"tables",{get:function(){return this._tables},enumerable:!0,configurable:!0}),e.prototype.load=function(e){t.ResManager.instance.loadRes(e,function(e){for(var i=new JSZip(e),s=i.file(/^[tc].*/),a=0,o=s.length;o>a;a++){var n=s[a],r=t.Util.strFormat("shared/{0}",n.name);this._tables[r]=JSON.parse(n.asText())}t.EventManager.instance.dispatchEvent(new egret.Event(t.CommonEventName.TABLE_LOADED))},this)},e._instance=new e,e}();t.TableManager=e,__reflect(e.prototype,"ZJ.TableManager")}(ZJ||(ZJ={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,s){function a(t){e.call(s,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(s))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(s,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i,s){function a(s){e.call(i,s,t)}if(void 0===s&&(s=RES.ResourceItem.TYPE_IMAGE),RES.hasRes(t)){var o=RES.getRes(t);o?a(o):RES.getResAsync(t,a,this)}else RES.getResByUrl(t,a,this,s)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ZJ;!function(t){var e=function(){function t(){this._uiLayers=[],this.uiDatas={},this.uiroot=null,this.views={}}return Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){return this.uiroot=t,0},Object.defineProperty(t.prototype,"uiLayers",{set:function(t){if(this._uiLayers.length>0)egret.warn("uiLayers已经设定。");else{this._uiLayers=t;for(var e=0,i=this._uiLayers.length;i>e;++e){var s=new eui.Group;s.name="layer"+e,s.touchEnabled=!1,this.uiroot.addChild(s),s.percentWidth=100,s.percentHeight=100}}},enumerable:!0,configurable:!0}),t.prototype.getUIData=function(t){return this.uiDatas[t]},t.prototype.getView=function(t){return this.views[t]},t.prototype.openView=function(t){var e=this.getUIData(t);if(void 0==e)return egret.log("ModuleConfig没有界面配置: "+t),null;var i=this.getView(t);if(void 0!=i);else{if(i=new e.viewClass,void 0==i)return console.warn("viewClass不存在 请检查ModuleConfig.uiDatas"),null;i.percentWidth=100,i.percentHeight=100,this.views[t]=i;var s=0;e.layer<this.uiroot.numChildren&&(s=e.layer),this.uiroot.getChildAt(s).addChild(i)}return i.visible=!0,i.parent.setChildIndex(i,9999),i.show(),i},t.prototype.destroyView=function(t){var e=this.getView(t);return void 0!=e&&null!=e&&(e.onDestroy(),e.parent.removeChild(e),this.views[t]=null),0},t._instance=new t,t}();t.UIManager=e,__reflect(e.prototype,"ZJ.UIManager")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(){}return t.getChar=function(t,e){var i=new egret.ByteArray;return i.writeUTFBytes(t),i.length<e?t:(i.position=0,i.readUTFBytes(e)+"...")},t.strFormat=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.replace(/\{(\d+)\}/g,function(t,i){return e[i]})},t.timeStamp=function(t){return t=t||(new Date).toString(),Date.parse(t)/1e3},t.Utf8ArrayToStr=function(t){var e,i,s,a,o,n;for(e="",s=t.length,i=0;s>i;)switch(a=t[i++],a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(a);break;case 12:case 13:o=t[i++],e+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=t[i++],n=t[i++],e+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&n)<<0)}return e},t.getClassName=function(t){if(t&&t.constructor&&t.constructor.toString()){if(t.constructor.name)return t.constructor.name;var e=t.constructor.toString();if("["==e.charAt(0))var i=e.match(/\[\w+\s*(\w+)\]/);else var i=e.match(/function\s*(\w+)/);if(i&&2==i.length)return i[1]}},t.objToByteArray=function(t){var e=JSON.stringify(t),i=new egret.ByteArray;return i.writeUTF(e),i},t.bytesToObj=function(t){var e=new egret.ByteArray(t),i=JSON.parse(e.readUTF());return i},t.rmArrayObj=function(t,e){return-1!=t.indexOf(e)?t.splice(t.indexOf(e),1):void 0},t}();t.Util=e,__reflect(e.prototype,"ZJ.Util")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=i}return t.prototype.multiply=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t}();t.Vector3=e,__reflect(e.prototype,"ZJ.Vector3")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function e(){this.bgm="bgm",this._isMute=!1,this.sounds={},this.soundsChannel={}}return Object.defineProperty(e,"Instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMute",{get:function(){return this._isMute},set:function(t){this._isMute=t,this._isMute?this.stopAll():(this.stopBgm(),this.playBgm())},enumerable:!0,configurable:!0}),e.prototype.playBgm=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this._isMute||null!=this.bgm&&""!=this.bgm&&this.play(this.bgm,t,e,!0)},e.prototype.stopBgm=function(){this.stop(this.bgm)},e.prototype.play=function(e,i,s,a){var o=this;void 0===i&&(i=1),void 0===s&&(s=1),void 0===a&&(a=!1);var n=e+"_mp3";if(!this._isMute)if(null!=this.sounds[e]){a&&this.stop(e);var r=this.sounds[e].play(0,i);this.soundsChannel[e]=r,r.volume=s}else t.ResManager.instance.loadRes(n,function(t,a){var n=t,r=n.play(0,i);r.volume=s,o.sounds[e]=n,o.soundsChannel[e]=r},this)},e.prototype.stop=function(t){null!=this.soundsChannel[t]&&(this.soundsChannel[t].stop(),this.soundsChannel[t]=null)},e.prototype.stopAll=function(){for(var t in this.soundsChannel)this.stop(t)},e.prototype.getSound=function(t){return this.sounds[t]},e.prototype.getChannel=function(t){return this.soundsChannel[t]},e._instance=new e,e}();t.AudioManager=e,__reflect(e.prototype,"ZJ.AudioManager")}(ZJ||(ZJ={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ZJ;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.INTERVAL=60,i.DISTANCE=20,i.pastTime=0,i.lastPos=new t.Vector3,i.nowPos=new t.Vector3,i.isBegin=!1,i.intervalID=0,i}return __extends(i,e),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},i.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.layer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.layer.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.layer.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.intervalID=setInterval(function(){t.onInterval()},this.INTERVAL)},i.prototype.onInterval=function(){if(this.isBegin){var e=this.nowPos.x-this.lastPos.x,i=this.nowPos.y-this.lastPos.y,s=Math.abs(e),a=Math.abs(i),o={};if(s>a?s>this.DISTANCE&&(e>0?o.direct=t.CommonConfig.RIGHT:o.direct=t.CommonConfig.LEFT,this.isBegin=!1):a>this.DISTANCE&&(i>0?o.direct=t.CommonConfig.DOWN:o.direct=t.CommonConfig.UP,this.isBegin=!1),!this.isBegin){var n=new egret.Event(t.CommonEventName.GESTURE_DIRECT);n.data=o,t.EventManager.instance.dispatchEvent(n)}this.lastPos.x=this.nowPos.x,this.lastPos.y=this.nowPos.y}},i.prototype.onTouchBegin=function(t){this.pastTime=0,this.nowPos.x=t.stageX,this.nowPos.y=t.stageY,this.lastPos.x=t.stageX,this.lastPos.y=t.stageY,this.isBegin=!0},i.prototype.onTouchEnd=function(t){this.isBegin=!1},i.prototype.onTouchMove=function(t){this.nowPos.x=t.stageX,this.nowPos.y=t.stageY},i.prototype.OnDestroy=function(){return clearInterval(this.intervalID),0},i}(t.ComponentBase);t.Gesture=e,__reflect(e.prototype,"ZJ.Gesture")}(ZJ||(ZJ={}));var ImgAnim=function(t){function e(e){var i=t.call(this)||this;return i.interval=0,i.loop=!0,i.index=0,i.imgArray=e,i.source=e[0],i}return __extends(e,t),e.prototype.play=function(){var t=this;this.id=setInterval(function(){t.index++,t.index>=t.imgArray.length&&(t.loop?t.index=0:t.stop()),t.source=t.imgArray[t.index]},this.interval,this)},e.prototype.replay=function(){this.index=0,clearInterval(this.id),this.play()},e.prototype.pause=function(){clearInterval(this.id)},e.prototype.stop=function(){this.index=0,clearInterval(this.id)},e}(eui.Image);__reflect(ImgAnim.prototype,"ImgAnim");var LYNtools=function(){function t(){}return t.getTableData=function(t,e,i){return ZJ.TableManager.instance.tables[t][e][i]},t.BytesToObject=function(t){var e=new egret.ByteArray(t);return JSON.parse(e.readUTF())},t.InitBtnWithLight=function(t,e,i){t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.alpha=0,e()},i),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=1},i),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=0},i)},t.now=function(){return+new Date},t.ConvertMillisecondToStandradString=function(t){var e,i=Math.floor(t/1e3),s=Math.floor(i/60);e=10>s?"0"+s.toString():s.toString();var a,o=i%60;return a=10>o?"0"+o.toString():o.toString(),e+":"+a},t}();__reflect(LYNtools.prototype,"LYNtools");var UILayer=function(){function t(){}return t.View=0,t.Pop=1,t.SDK=2,t}();__reflect(UILayer.prototype,"UILayer");var UIName=function(){function t(){}return t.Loading="Loading",t.Game="Game",t.Settle="Settle",t.PvpSettle="PvpSettle",t}();__reflect(UIName.prototype,"UIName");var ModuleConfig=function(){function t(){}return t.uiLayers=[UILayer.View,UILayer.Pop,UILayer.SDK],t.uiDatas=(_a={},_a[UIName.Game]=new ZJ.UIData(UIName.Game,UILayer.View,GameView),_a[UIName.Settle]=new ZJ.UIData(UIName.Settle,UILayer.View,SettleView),_a[UIName.PvpSettle]=new ZJ.UIData(UIName.PvpSettle,UILayer.View,PvpSettleView),_a[UIName.Loading]=new ZJ.UIData(UIName.Loading,UILayer.View,ChushouLoadingView),_a),t.compile={danji:!1,single_player:!0,isCompetition:!0,runtime:!0,channel_id:10},t.ip="dev-game.u17games.com",t.singlePort="12021",t.doublePort="12022",t.ws="ws",t.protoFiles=["p10_proto","p11_proto"],t}();__reflect(ModuleConfig.prototype,"ModuleConfig");var EventName=function(){function t(){}return t.GAME_RESTART="GAME_RESTART",t}();__reflect(EventName.prototype,"EventName");var _a,ModuleStartUp=function(){function t(){}return t.init=function(){return ZJ.AudioManager.Instance.bgm="theme",ZJ.UIManager.instance.openView(UIName.Game),0},t}();__reflect(ModuleStartUp.prototype,"ModuleStartUp");var ModuleUtil=function(){function t(){}return Object.defineProperty(t,"tables",{get:function(){return ZJ.TableManager.instance.tables},enumerable:!0,configurable:!0}),t.getProtoByID=function(t,e){var i="";if(e)switch(t){case 99999:i="ClientCmdData";break;case 1e3:i="CmdLoginGameReqMsg";break;case 1001:i="CmdPingReqMsg";break;case 1300:i="CmdJumperUploadAnswerReqMsg";break;case 1303:i="CmdJumperGameOverReqMsg"}else switch(t){case 99999:i="ServerCmdData";break;case 1e3:i="CmdLoginGameRspMsg";break;case 1001:i="CmdPingRspMsg";break;case 1300:i="CmdJumperUploadAnswerRspMsg";break;case 1303:i="CmdJumperGameOverRspMsg";break;case 1399:i="CmdBroadcastJumperBC"}var s=ZJ.SocketManager.instance.ProtoBufRoot,a=s.lookupType(i);return a},t}();__reflect(ModuleUtil.prototype,"ModuleUtil");var SuperAI=function(){function t(t,e,i,s,a,o,n,r){void 0===r&&(r=1),this.WIND_FORCE_RATE=8e4,this.LIMIT_LEVEL=3,this.shotTimeoutID=0,this.PRE_PATH_CONSTANT=t,this.PRE_VELOC_CONSTANT=e,this.PRE_G_CONSTANT=i,this.BASKET_MIN_X=s,this.BASKET_MIN_Y=a,this.level=r,this.myPos=new ZJ.Vector3(o,n)}return t.prototype.setLevel=function(t){t>this.LIMIT_LEVEL?this.level=this.LIMIT_LEVEL:this.level=t},t.prototype.GameStart=function(t){var e=this;setTimeout(function(){e.shotLoop(t)},1e3)},t.prototype.GameEnd=function(){clearTimeout(this.shotTimeoutID)},t.prototype.shotLoop=function(t){var e=this;t(),this.shotTimeoutID=setTimeout(function(){e.shotLoop(t)},ZJ.MathUtil.randomRange(2500,3e3))},t.prototype.Shot=function(t,e,i,s,a){var o=t,n=e,r=this.myPos.x,h=this.myPos.y,c=o-60-(o-this.BASKET_MIN_X)/3-(n-this.BASKET_MIN_Y)/10,l=(n-h)/(o*o-r*r-2*c*o+2*c*r),p=-2*l*c,u=Math.pow(this.PRE_G_CONSTANT/(2*l*this.PRE_PATH_CONSTANT*this.PRE_PATH_CONSTANT*this.PRE_VELOC_CONSTANT),.5),d=u*(p+l*r*2),g=u*this.PRE_PATH_CONSTANT,m=d*this.PRE_PATH_CONSTANT;if(!i)return Matter.Vector.create(g,m);var _=Math.pow(2,.5),T=(o-r)/(this.PRE_PATH_CONSTANT*this.PRE_VELOC_CONSTANT*u),E=T*a*this.PRE_PATH_CONSTANT/this.WIND_FORCE_RATE;switch(s){case 1:return Matter.Vector.create(g-E/_,m+E/_);case 2:return Matter.Vector.create(g-E,m);case 3:return Matter.Vector.create(g-E/_,m-E/_);case 5:return Matter.Vector.create(g+E/_,m-E/_);case 6:return Matter.Vector.create(g+E,m);case 7:return Matter.Vector.create(g+E/_,m+E/_);default:return null}},t.prototype.resetMyPos=function(t,e){this.myPos.x=t,this.myPos.y=e},t}();__reflect(SuperAI.prototype,"SuperAI");var BasketBall=function(){function t(t,e){this.touchTop=!1,this.scoreFlag=!1,this.isScored=!1,this.missFlag=!1,this.noUseFlag=!1,this.frames=0,this.isKilling=!1,this.isCleanShot=!0,this.shotRound=0,this.body=t,this.image=e}return t}();__reflect(BasketBall.prototype,"BasketBall");var BasketMoveData=function(){function t(){this.style=0,this.cycle=0,this.pathCirclePos=[],this.pathEndCirclePos=[],this.cycleFlag=1,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.offsetX=0,this.offsetY=0,this.max_x=0,this.min_x=0,this.max_y=0,this.min_y=0,this.radius=0,this.radius_2=0,this.centerX=0,this.centerY=0,this.offset_angle=0,this.nowAngle=0,this.PATH_POINT_OFFSET=45}return t.createLine=function(e,i,s,a,o,n){var r=o/n,h=new t;h.x1=e,h.y1=i,h.x2=s,h.y2=a,h.style=1,h.cycle=r,h.offsetX=(s-e)/r,h.offsetY=(a-i)/r,h.max_x=e>s?e:s,h.min_x=e>s?s:e,h.max_y=i>a?i:a,h.min_y=i>a?a:i,h.pathEndCirclePos.push(new ZJ.Vector3(e,i)),h.pathEndCirclePos.push(new ZJ.Vector3(s,a));for(var c=h.PATH_POINT_OFFSET,l=0,p=0,u=0,d=2;!0;d++){var g=o/d;if(!(g>c)){l=g,u=d;break}p=g}var m=0,_=0;if(Math.abs(l-c)<Math.abs(p-c)?(m=l,_=u-1):(m=p,_=u-2),e==s)if(a>i)for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e,i+m*d));else for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e,i-m*d));else if(i==a)if(s>e)for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e+m*d,i));else for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e-m*d,i));else{var T=m/Math.pow(2,.5);if(s>e)if(a>i)for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e+T*d,i+T*d));else for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e+T*d,i-T*d));else if(a>i)for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e-T*d,i+T*d));else for(var d=1;_>=d;d++)h.pathCirclePos.push(new ZJ.Vector3(e-T*d,i-T*d))}return h},t.createReplayLine=function(e,i,s,a,o,n,r,h,c){var l,p=e,u=i,d=e==n?h:n,g=i==r?c:r;l=1==s?r-c:2==s?n-h:Math.sqrt(Math.pow(n-h,2)+Math.pow(r-c,2));var m=new t;m.x1=p,m.y1=u,m.x2=d,m.y2=g,m.style=1,m.cycle=(g-u)/o,m.offsetX=a,m.offsetY=o,m.max_x=n,m.min_x=h,m.max_y=r,m.min_y=c,m.pathEndCirclePos.push(new ZJ.Vector3(p,u)),m.pathEndCirclePos.push(new ZJ.Vector3(d,g));for(var _=m.PATH_POINT_OFFSET,T=0,E=0,y=0,S=2;!0;S++){var b=l/S;if(!(b>_)){T=b,y=S;break}E=b}var f=0,I=0;if(Math.abs(T-_)<Math.abs(E-_)?(f=T,I=y-1):(f=E,I=y-2),p==d)if(g>u)for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p,u+f*S));else for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p,u-f*S));else if(u==g)if(d>p)for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p+f*S,u));else for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p-f*S,u));else{var v=f/Math.pow(2,.5);if(d>p)if(g>u)for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p+v*S,u+v*S));else for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p+v*S,u-v*S));else if(g>u)for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p-v*S,u+v*S));else for(var S=1;I>=S;S++)m.pathCirclePos.push(new ZJ.Vector3(p-v*S,u-v*S))}return m},t.createCircle=function(e,i,s,a){var o=new t;o.radius=e,o.radius_2=e*e,o.centerX=i,o.centerY=s,o.style=2,o.cycle=2*Math.PI*e/a,o.offset_angle=a/e,o.offset_angle*=ZJ.MathUtil.randomRange(0,100)<50?1:-1;for(var n=o.PATH_POINT_OFFSET,r=2*Math.PI*e,h=0,c=0,l=0,p=2;!0;p++){var u=r/p;if(!(u>n)){h=u,l=p;break}c=u}var d=0,g=0;Math.abs(h-n)<Math.abs(c-n)?(d=h,g=l):(d=c,g=l-1);for(var m=d/r*2*Math.PI,p=0;g>p;p++){var _=m*p,T=i+Math.cos(_)*e,E=Math.pow(o.radius_2-Math.pow(T-i,2),.5)*(Math.floor(_/Math.PI)%2==0?1:-1)+s;o.pathCirclePos.push(new ZJ.Vector3(T,E))}return o},t.createReplayCircle=function(e,i,s,a){var o=new t;o.radius=s,o.radius_2=s*s,o.centerX=e,o.centerY=i,o.style=2,o.offset_angle=a;for(var n=o.PATH_POINT_OFFSET,r=2*Math.PI*s,h=0,c=0,l=0,p=2;!0;p++){var u=r/p;if(!(u>n)){h=u,l=p;break}c=u}var d=0,g=0;Math.abs(h-n)<Math.abs(c-n)?(d=h,g=l):(d=c,g=l-1);for(var m=d/r*2*Math.PI,p=0;g>p;p++){var _=m*p,T=e+Math.cos(_)*s,E=Math.pow(o.radius_2-Math.pow(T-e,2),.5)*(Math.floor(_/Math.PI)%2==0?1:-1)+i;o.pathCirclePos.push(new ZJ.Vector3(T,E))}return o},t}();__reflect(BasketMoveData.prototype,"BasketMoveData");var CompetitionData=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.myShot=t},t.prototype.GameStart=function(){this._startTime=LYNtools.now()},t.prototype.PackageShotData=function(t,e,i,s){var a=LYNtools.now()+i;return{timeStamp:a-this.startTime,shootData:{vx:t,vy:e,shottime:a,fingerMoveDatas:s}}},t.prototype.UnpackShotData=function(t){if(1!=t.result){var e=LYNtools.BytesToObject(t.shootData);console.log("UnpackageShotDataInside : "+JSON.stringify(e)),this.myShot({vx:e.vx,vy:e.vy,shottime:e.shottime})}},t.prototype.PackageBasketData=function(t){var e=LYNtools.now()-this.startTime;return{timeStamp:e,basketData:t}},t}();__reflect(CompetitionData.prototype,"CompetitionData");var MyCDM=function(t){function e(){var e=t.call(this)||this;if(e.isReconnect=!1,"50"==chushouGameConfig.launchMode)e.gameStyle=5,e.DoCompetitionAuthRequest();else if("60"==chushouGameConfig.launchMode){e.gameStyle=6;var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var s="https://dev-game.u17games.com:12024/getreplaydomain?gameRecordId="+chushouGameConfig.gameRecordId;i.open(s,egret.HttpMethod.GET),i.send(),i.addEventListener(egret.Event.COMPLETE,e.getConnectData,e)}return e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.DoCompetitionAuthRequest=function(){var t=this;ChushouSDK.instance.csAuthRequest(function(e){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var s="https://dev-game.u17games.com:12024/getdomain?open_id="+ChushouSDK.instance.csAuthRequestData.openUid;console.log("myUrl: "+s),i.open(s,egret.HttpMethod.GET),i.send(),i.addEventListener(egret.Event.COMPLETE,t.getConnectData,t),t.CsAuthRequestCallBack()})},e.prototype.ConnectLANServerForCompetition=function(){this.gameStyle=5;var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open("http://192.168.1.194:12010/getdomain?open_id=1",egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,this.getConnectData,this)},e.prototype.ConnectLANServerForReplay=function(){this.gameStyle=6;var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open("http://192.168.1.194:12010/getreplaydomain?gameRecordId=381740468930418",egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,this.getConnectData,this)},e.prototype.getConnectData=function(t){var e=t.currentTarget,i=JSON.parse(e.response);this.connectUrl=(1==i.type?"ws":"wss")+"://"+i.domain+":"+i.port,ZJ.SocketManager.instance.connectByUrl(this.connectUrl)},e.prototype.onConnect=function(){var t=this;return this.isReconnect?(console.log("reconnect success"),console.log(this.myData.playerId),console.log(this.myReconnectTicket),ZJ.SocketManager.instance.send(10002,{playerId:this.myData.playerId,ticket:this.myReconnectTicket}),void console.log("reconnect 123")):void(6==this.gameStyle?this.GetReplayData():5==this.gameStyle?(ModuleConfig.compile.danji?ZJ.SocketManager.instance.send(1e4,{openId:LYNtools.now().toString(),sign:"sign",timestamp:ZJ.Util.timeStamp(),appId:ModuleConfig.compile.channel_id,params:[LYNtools.now().toString(),"female","https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike116%2C5%2C5%2C116%2C38/sign=de3a406dde3f8794c7f2407cb3726591/d833c895d143ad4b9d6ce51588025aafa50f06a0.jpg"]}):this.Login10000(),this.ping11004()):ChushouSDK.instance.csAuthRequest(function(e){t.Login10000(),t.ping11004(),t.CsAuthRequestCallBack()
}))},e.prototype.extendOnData=function(t,e){switch(t){case 10002:1==e.result||3==e.result?ChushouSDK.instance.csExitGame():(0==e.result&&(this.myReconnectTicket=e.ticket),this.doAction(this.OnData10002,e));break;case 11101:this.doAction(this.OnData11101,e);break;case 11102:this.doAction(this.OnData11102,e);break;case 11110:this.doAction(this.OnData11110,e);break;case 11111:this.doAction(this.OnData11111,e);break;case 11112:this.doAction(this.OnData11112,e);break;case 11113:this.doAction(this.OnData11113,e);break;case 11114:this.doAction(this.OnData11114,e);break;case 11115:this.doAction(this.OnData11115,e);break;case 11120:this.doAction(this.OnData11120,e)}},e.prototype.reconnect10002=function(){egret.log("do Reconnect"),ZJ.SocketManager.instance.connectByUrl(this.connectUrl),this.isReconnect=!0},e.prototype.SendShotData11101=function(t,e){ZJ.SocketManager.instance.send(11101,{round:t,shootData:ZJ.Util.objToByteArray(e).bytes})},e.prototype.SendScoreData11102=function(t,e,i){ZJ.SocketManager.instance.send(11102,{round:t,addScore:e,data:ZJ.Util.objToByteArray(i).bytes})},e.prototype.GetCompetitionData11110=function(t){void 0===t&&(t=0),ZJ.SocketManager.instance.send(11110,{modeId:t})},e.prototype.CompetitionStart11111=function(){ZJ.SocketManager.instance.send(11111,{delaysecond:1800})},e.prototype.SendCompetitionShotData11112=function(t,e,i,s){ZJ.SocketManager.instance.send(11112,{millisecond:t,shootIndex:e,shootData:ZJ.Util.objToByteArray(i).bytes,round:s})},e.prototype.SendCompetitionShotResult11113=function(t,e,i,s,a){0!=this.gameStyle&&ZJ.SocketManager.instance.send(11113,{shootIndex:t,isHit:e,addScore:i,round:s,millisecond:a})},e.prototype.SendCompetitionBasketData11114=function(t,e,i){ZJ.SocketManager.instance.send(11114,{millisecond:t,round:e,basketData:ZJ.Util.objToByteArray(i).bytes})},e.prototype.GetReplayData=function(){ZJ.SocketManager.instance.send(11120,{gameRecordId:chushouGameConfig.gameRecordId})},e}(ChushouDataModel);__reflect(MyCDM.prototype,"MyCDM");var PvpData=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e,i,s){this.myShot=t,this.sbShot=e,this.scoreRefresh=i,this.correctRound=s},t.prototype.PackageStartTime=function(){return this.myStartTime=LYNtools.now(),{type:1,id:MyCDM.instance.myData.openId,time:this.myStartTime}},t.prototype.PackageShotData=function(t,e,i){var s=LYNtools.now();return{id:MyCDM.instance.myData.openId,vx:t,vy:e,shottime:s+i,time:s}},t.prototype.PackageScoreData=function(t,e,i,s,a){return{type:3,id:MyCDM.instance.myData.openId,id1:t,score1:e,id2:i,score2:s,basketcount:a,time:LYNtools.now()}},t.prototype.UnpackageTimeData=function(t){var e=new egret.ByteArray(t.processData),i=JSON.parse(e.readUTF()),s=t.playerId;egret.log("UnpackageTimeDataInside : "+JSON.stringify(i)),1==i.type&&(egret.log("exchange time"),(s&&s!=MyCDM.instance.myData.playerId||i.id!=MyCDM.instance.myData.openId)&&(this.std=this.myStartTime-i.time,egret.log("标准时间差: "+this.std)))},t.prototype.UnpackageShotData=function(t){if(1!=t.result){if(2==t.result)return void this.correctRound(t.round);var e=LYNtools.BytesToObject(t.shootData),i=t.playerId;egret.log("UnpackageShotDataInside : "+JSON.stringify(e)),i&&i==MyCDM.instance.myData.playerId||e.id==MyCDM.instance.myData.openId?(egret.log("do myshot"),this.myShot(e)):(egret.log("do sbshot"),e.shottime=e.shottime+this.std,this.sbShot(e))}},t.prototype.UnpackageScoreData=function(t){if(1!=t.result){if(2==t.result)return void this.correctRound(t.round);var e,i,s=t.scoreInfos,a=t.round;s[0].playerId==MyCDM.instance.myData.playerId?(e=s[0].score,i=s[1].score):(e=s[1].score,i=s[0].score);var o=LYNtools.BytesToObject(t.data);this.scoreRefresh({myScore:e,sbScore:i,round:a,id:o.id,seed:o.seed,time:o.time+(o.id==MyCDM.instance.myData.playerId?0:this.std),gametime:o.gametime})}},t}();__reflect(PvpData.prototype,"PvpData");var ZJ;!function(t){var e=function(t){function e(e,i,s,a){var o=t.call(this,e,i,s,a)||this;return o.data=null,o}return __extends(e,t),e}(egret.Event);t.ChannelDataEvent=e,__reflect(e.prototype,"ZJ.ChannelDataEvent")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(){}return t.FRAME=30,t.UP=0,t.DOWN=1,t.LEFT=2,t.RIGHT=3,t}();t.CommonConfig=e,__reflect(e.prototype,"ZJ.CommonConfig");var i=function(){function t(){}return t.TABLE_LOADED="TABLE_LOADED",t.SOCKET_CONNECTED="SOCKET_CONNECTED",t.SOCKET_DATA="SOCKET_DATA",t.GESTURE_DIRECT="GESTURE_DIRECT",t.CHANNEL_DATA="CHANNEL_DATA",t}();t.CommonEventName=i,__reflect(i.prototype,"ZJ.CommonEventName")}(ZJ||(ZJ={}));var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),console.log("main 1"),ChushouSDK.instance.LoadJssdk(function(){e.runGame()["catch"](function(t){console.log(t)})}),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter)},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.createGameScene()];case 1:return e.sent(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),[2]}})})},e.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return egret.ImageLoader.crossOrigin="anonymous",[4,ZJ.ResManager.instance.init(this.stage)];case 1:return e.sent(),[4,ZJ.ResManager.instance.loadGroup("realpreload")];case 2:return e.sent(),ZJ.UIManager.instance.init(this),ZJ.UIManager.instance.uiLayers=ModuleConfig.uiLayers,ZJ.UIManager.instance.uiDatas=ModuleConfig.uiDatas,t=this.GetLoadingView(),[4,ZJ.ResManager.instance.loadGroup("preload",0,t)];case 3:return e.sent(),"20"!=chushouGameConfig.launchMode?[3,5]:[4,ZJ.ResManager.instance.loadGroup("single",0)];case 4:return e.sent(),[3,15];case 5:return"30"!=chushouGameConfig.launchMode?[3,7]:[4,ZJ.ResManager.instance.loadGroup("double",0)];case 6:return e.sent(),[3,15];case 7:return"50"!=chushouGameConfig.launchMode?[3,9]:[4,ZJ.ResManager.instance.loadGroup("competition",0)];case 8:return e.sent(),[3,15];case 9:return"60"!=chushouGameConfig.launchMode?[3,12]:[4,ZJ.ResManager.instance.loadGroup("competition",0)];case 10:return e.sent(),[4,ZJ.ResManager.instance.loadGroup("replay",0)];case 11:return e.sent(),[3,15];case 12:return chushouGameConfig.launchMode?[3,15]:[4,ZJ.ResManager.instance.loadGroup("single",0)];case 13:return e.sent(),[4,ZJ.ResManager.instance.loadGroup("double",0)];case 14:e.sent(),e.label=15;case 15:return ZJ.TableManager.instance.init(),ZJ.SocketManager.instance.init(),ModuleStartUp.init(),[2]}})})},e.prototype.GetLoadingView=function(){var t=null,e=null;return ModuleConfig.compile.danji||(e=ChushouLoadingView),null!=e&&(ModuleConfig.uiDatas[UIName.Loading].viewClass=e,t=ZJ.UIManager.instance.openView(UIName.Loading)),t},e.prototype.onEnterFrame=function(){},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ZJ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){return 0},e._instance=new e,e}(egret.EventDispatcher);t.EventManager=e,__reflect(e.prototype,"ZJ.EventManager")}(ZJ||(ZJ={}));var ZJ;!function(t){var e=function(){function t(){}return t.randomRange=function(t,e,i){null==i&&(i=1e3*Math.random());var s=this.randomSeed(i);return s/=233280,Math.floor(t+s*(e-t))},t.randomSeed=function(t){return t=(9301*t+49297)%233280},t.YiYuanErCi=function(t,e,i){var s,a,o,n=[];return s=e*e-4*t*i,0>s||(a=(-1*e+Math.sqrt(s))/(2*t),o=(-1*e-Math.sqrt(s))/(2*t),n.push(a),n.push(o)),n},t}();t.MathUtil=e,__reflect(e.prototype,"ZJ.MathUtil")}(ZJ||(ZJ={}));var ChushouSDK=function(){function t(){this.gameRoomId="",this.role="",this.h5AppName="hsdailyshot",this.title="分享标题",this.image="/resource/assets/egret_icon.png",this.description="分享描述",this.enableMic="1",this.enableAudioOutput="1",this.csAuthRequestData=null,this.loadJssdkSuccess=!1,this.loadJssdkIntervalID=0}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.LoadJssdk=function(t){var e=this;if(ModuleConfig.compile.runtime){var i=document.createElement("script");i.onload=function(){e.loadJssdkSuccess=!0,t()},i.src="https://open-game.kascend.com/egretjssdk/v10505/h5game.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s),this.loadJssdkIntervalID=setInterval(function(){if(e.loadJssdkSuccess)console.log("jssdk interval clear"),clearInterval(e.loadJssdkIntervalID);else{console.log("jssdk load again");var i=document.createElement("script");i.onload=function(){e.loadJssdkSuccess=!0,t()},i.src="https://open-game.kascend.com/egretjssdk/v10505/h5game.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s)}},1e3)}else t()},t.prototype.csAuthRequest=function(t){var e=this;this.log("csAuthRequest"),csAuthRequest('{"h5AppName" : "'+this.h5AppName+'","launchMode" : "'+chushouGameConfig.launchMode+'","inviteMode" : "'+chushouGameConfig.inviteMode+'","gameRoomId" : "'+chushouGameConfig.gameRoomId+'"}',function(i){e.log("cb csAuthRequest"),e.log(i);var s=JSON.parse(i);e.csAuthRequestData=s,t&&t(s)})},t.prototype.csJoinRoom=function(t){var e=this;this.log("csJoinRoom "+this.gameRoomId),csJoinRoom('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","gameRoomId" : "'+this.gameRoomId+'","role" : "'+this.csAuthRequestData.role+'"}',function(i){e.log("cb csJoinRoom"),e.log(i.toString()),t&&t(JSON.parse(i))})},t.prototype.csQuitRoom=function(t){var e=this;this.log("csQuitRoom"),csQuitRoom('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","gameRoomId" : "'+this.gameRoomId+'"}',function(i){e.log("cb csQuitRoom"),t&&t(JSON.parse(i))})},t.prototype.csInviteToGame=function(t){var e=this;this.log("csInviteToGame"),csInviteToGame('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","gameRoomId" : "'+this.gameRoomId+'","inviteMode" : "'+chushouGameConfig.inviteMode+'","title" : "'+this.title+'","description" : "'+this.description+'","image" : "'+this.image+'"}',function(i){e.log("cb csInviteToGame"),t&&t(JSON.parse(i))})},t.prototype.csKickOutUser=function(t){var e=this;this.log("csKickOutUser"),csKickOutUser('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","targetUid" : "sl23859","gameRoomId" : "'+this.gameRoomId+'"}',function(i){e.log("cb csKickOutUser"),t&&t(JSON.parse(i))})},t.prototype.csShareRoom=function(t){var e=this;this.log("csShareRoom"),csShareRoom('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","gameRoomId" : "'+this.gameRoomId+'","title" : "'+this.title+'","description" : "'+this.description+'","image" : "'+this.image+'"}',function(i){e.log("cb csShareRoom"),t&&t(JSON.parse(i))})},t.prototype.csShareRecord=function(t){var e=this;this.log("csShareRecord"),csShareRecord('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","gameRecordId" : "119844","title" : "'+this.title+'","description" : "'+this.description+'","image" : "'+this.image+'"}',function(i){e.log("cb csShareRecord"),t&&t(JSON.parse(i))})},t.prototype.csGetFriendList=function(t){var e=this;this.log("csGetFriendList"),csGetFriendList('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","numPerPage" : "10","breakpoint" : "18823-ffgh-cc08"}',function(i){e.log("cb csGetFriendList"),t&&t(JSON.parse(i))})},t.prototype.csGetUserRelationship=function(t,e){for(var i=this,s="",a=0;a<t.length;a++)s+=t[a],a!=t.length-1&&(s+=",");this.log("csGetUserRelationship"),csGetUserRelationship('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","users" : "'+s+'"}',function(t){i.log("cb csGetUserRelationship"),e&&e(JSON.parse(t))})},t.prototype.csFollowUser=function(t,e){var i=this;this.log("csFollowUser"),csFollowUser('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","targetUid" : "'+t+'"}',function(t){i.log("cb csFollowUser"),e&&e(JSON.parse(t))})},t.prototype.csEnableMic=function(t){var e=this;this.log("csEnableMic"),csEnableMic('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","enableMic" : '+this.enableMic+"}",function(i){e.log("cb csEnableMic"),t&&t(JSON.parse(i))})},t.prototype.csEnableAudioOutput=function(t){var e=this;this.log("csEnableAudioOutput"),csEnableAudioOutput('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","enableAudioOutput" : "'+this.enableAudioOutput+'"}',function(i){e.log("cb csEnableAudioOutput"),t&&t(JSON.parse(i))})},t.prototype.onUserVolumeUpdate=function(t){var e=this;this.log("onUserVolumeUpdate"),onUserVolumeUpdate(function(i){e.log("cb onUserVolumeUpdate"),t&&t(JSON.parse(i))})},t.prototype.csExitGame=function(t){this.log("csExitGame "+this.csAuthRequestData.accessToken),this.csQuitRoom(),csExitGame('{"accessToken" : "'+this.csAuthRequestData.accessToken+'"}')},t.prototype.csNotifyLoadProgress=function(t,e){this.log("csNotifyLoadProgress");var i=typeof csNotifyLoadProgress;"function"==i?(console.log("haha doprogress"),csNotifyLoadProgress('{"total" : "100","progress" : "'+t+'"}'),console.log("haha progress done")):console.log("haha protected")},t.prototype.onNetworkStatusChange=function(t){var e=this;this.log("onNetworkStatusChange"),onNetworkStatusChange(function(i){e.log("cb onNetworkStatusChange"),t&&t(JSON.parse(i))})},t.prototype.csGetAPIVersionInfo=function(t){var e=this;this.log("csGetAPIVersionInfo"),csGetAPIVersionInfo('{"h5AppName" : "'+this.h5AppName+'","launchMode" : "'+chushouGameConfig.launchMode+'","inviteMode" : "'+chushouGameConfig.inviteMode+'","gameRoomId" : "'+this.gameRoomId+'"}',function(i){e.log("cb csGetAPIVersionInfo"),t&&t(JSON.parse(i))})},t.prototype.csInvokeRecharge=function(t,e){var i=this;this.log("csInvokeRecharge"),csInvokeRecharge('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","paymentScene" : "'+t+'"}',function(t){i.log("cb csInvokeRecharge"),e&&e(JSON.parse(t))})},t.prototype.onBalanceChanged=function(t){this.log("onBalanceChanged")},t.prototype.csPurchaseProps=function(t){var e=this;this.log("csPurchaseProps"),csPurchaseProps('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","cpOrderId" : "prop7865421","cpPropName" : "双倍积分卡","cpPropId" : "1","payAmount" : "500"}',function(i){e.log("cb csPurchaseProps"),t&&t(JSON.parse(i))})},t.prototype.csPayEntryFee=function(t,e,i,s){var a=this;this.log("csPayEntryFee"),csPayEntryFee('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","cpOrderId" : "'+t+'","cpPropName" : "'+i+'","cpPropId" : "'+e+'"}',function(t){a.log("cb csPayEntryFee"),s&&s(JSON.parse(t))})},t.prototype.csCheckEntryFee=function(t){var e=this;this.log("csCheckEntryFee"),csCheckEntryFee('{"accessToken" : "'+this.csAuthRequestData.accessToken+'"}',function(i){e.log("cb csCheckEntryFee"),t&&t(JSON.parse(i))})},t.prototype.csRecordReport=function(t,e){this.log("csRecordReport"),csRecordReport('{"accessToken" : "'+this.csAuthRequestData.accessToken+'","openUid" : "'+this.csAuthRequestData.openUid+'","gameResult" : "'+t+'" , "gameRecordId" : "'+chushouGameConfig.gameRecordId+'"}')},t.prototype.log=function(t){console.log(t)},t}();__reflect(ChushouSDK.prototype,"ChushouSDK");var xlsx;!function(t){t.cfg_c_toulan="shared/c_toulan.json",t.c_toulan_id="A",t.c_toulan_data="B",t.cfg_c_competition="shared/c_competition.json",t.c_competition_id="A",t.c_competition_time="B",t.c_competition_score="C",t.c_competition_basket_refresh="D",t.c_competition_wind_direction="E",t.c_competition_wind_force="F",t.c_competition_moving_type="G",t.c_competition_moving_speed="H",t.c_competition_moving_length="I"}(xlsx||(xlsx={}));