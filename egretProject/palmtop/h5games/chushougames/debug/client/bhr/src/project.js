require=function s(a,c,r){function l(o,t){if(!c[o]){if(!a[o]){var e="function"==typeof require&&require;if(!t&&e)return e(o,!0);if(h)return h(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var n=c[o]={exports:{}};a[o][0].call(n.exports,function(t){var e=a[o][1][t];return l(e||t)},n,n.exports,s,a,c,r)}return c[o].exports}for(var h="function"==typeof require&&require,t=0;t<r.length;t++)l(r[t]);return l}({ArrowControl:[function(t,e,o){"use strict";cc._RF.push(e,"7cf18FQrxBLrbDqGm70u68W","ArrowControl"),cc.Class({extends:cc.Component,properties:{moveTime:.2},start:function(){},onLoad:function(){var t=this.move();this.node.runAction(t)},move:function(){var t=cc.moveBy(this.moveTime,cc.v2(0,15)),e=cc.moveBy(this.moveTime,cc.v2(0,-15));return cc.repeatForever(cc.sequence(t,e))}}),cc._RF.pop()},{}],BigCar:[function(t,e,o){"use strict";cc._RF.push(e,"caf28leKphMHpKrF1VMqWLC","BigCar");var l=t("GlobalData");cc.Class({extends:cc.Component,properties:{wheels:{default:[],type:cc.Node}},onLoad:function(){this.car=this.getComponent(cc.RigidBody),this.gameControl=cc.find(l.GAME_NAME).getComponent(l.GAME_CONTROL),this.isPulled=!1,this.controlPlayer=null,this.updateTimer=0,this.initY=0,this.shouldStop=!1},onBeginContact:function(t,e,o){o.node.group==l.GROUND&&(this.initY=this.node.y),e.tag!==l.DRAG_TAG&&e.tag!==l.BIGCAR_TAG||o.node.group!==l.GROUND||null===this.controlPlayer||this.controlPlayer.stopDrag()},onPreSolve:function(t,e,o){if(e.tag==l.BIGCAR_TAG&&o.node.group!=l.WALL&&0!=o.tag){var i=this.node.convertToNodeSpace(o.node.convertToWorldSpaceAR(cc.v2(0,0))),n=this.node.getPosition(),s=o.node.getComponent(cc.RigidBody);if(null!=s&&i.y>n.y)if(this.gameControl.isPlayer(o)){var a=o.node.getComponent(l.PLAYER_CONTROL);if(a.jumping||(s.linearDamping=this.car.linearDamping),a.isOnCar=!0,!a.left&&!a.right){var c=this.node.convertToWorldSpaceAR(cc.v2(0,0)),r=a.node.convertToWorldSpaceAR(cc.v2(0,0));a.bigcarSpace=r.x-c.x,a.bigcarPrefab=this.node}}else 10<=Math.abs(this.car.linearVelocity.x)&&(s.linearVelocity=cc.v2(this.car.linearVelocity.x,s.linearVelocity.y))}},onEndContact:function(t,e,o){},start:function(){},update:function(t){for(var e=0;e<this.wheels.length;e++)this.wheels[e].rotation+=.1*this.car.linearVelocity.x;null!=this.controlPlayer&&(this.updateTimer+=t,this.updateTimer>this.controlPlayer.sendCarTime+1&&this.controlPlayer.canSendCarData&&(this.controlPlayer.sendBigCarData(this.node),this.controlPlayer.canSendCarData=!1,this.updateTimer=0)),0!=this.initY&&5<Math.abs(this.node.y-this.initY)&&this.node.setPosition(this.node.x,this.initY)}}),cc._RF.pop()},{GlobalData:"GlobalData"}],BulletBase:[function(t,e,o){"use strict";cc._RF.push(e,"736carm4nlKvpMnHXrH6G4d","BulletBase");var s=t("GlobalData");cc.Class({extends:cc.Component,properties:{speed:20,isOpen:!1,isLeft:!0,shootSpace:2,leftNode:cc.Node,rightNode:cc.Node,dTime:1},onLoad:function(){this.spaceTimer=this.shootSpace,this.defaultOpen=!1,this.isOpen&&(this.defaultOpen=!0)},start:function(){},update:function(t){if(this.isOpen){if(this.spaceTimer<this.shootSpace)return void(this.spaceTimer+=t);this.spaceTimer=0,this.shoot()}},shoot:function(){var n=this;cc.loader.loadRes(s.GAME_TOOLS+"Bullet",function(t,e){if(t)cc.log("加载子弹资源出错："+t);else{var o=cc.instantiate(e);o.setParent(n.node);var i=o.getComponent(s.BULLET);n.isLeft?(o.setPosition(n.leftNode.getPosition()),o.scaleX=-o.scaleX,i.speed=-n.speed):(o.setPosition(n.rightNode.getPosition()),i.speed=n.speed),i.destroyTime=n.dTime}})},open:function(){this.defaultOpen?this.isOpen=!1:this.isOpen=!0},close:function(){this.defaultOpen?this.isOpen=!0:this.isOpen=!1}}),cc._RF.pop()},{GlobalData:"GlobalData"}],BulletControl:[function(t,e,o){"use strict";cc._RF.push(e,"9ca96gRsntI8LKn5DQG9YxI","BulletControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{bases:{default:[],type:cc.Node},endPos:cc.Node,btn:cc.Node},onLoad:function(){for(var t in this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.isOpen=!1,this.startPos=this.btn.getPosition(),this.mControls=new Array,this.bases)this.mControls[t]=this.bases[t].getComponent("BulletBase")},start:function(){},onPreSolve:function(t,e,o){if(!this.isOpen)for(var i in this.isOpen=!0,this.mControls)this.mControls[i].open()},onEndContact:function(t,e,o){if(this.isOpen)for(var i in this.isOpen=!1,this.mControls)this.mControls[i].close()},update:function(t){if(this.isOpen){if(this.btn.y<=this.endPos.y)return void this.btn.setPosition(cc.v2(this.btn.x,this.endPos.y));this.btn.y-=250*t}else{if(this.btn.y>=this.startPos.y)return void this.btn.setPosition(cc.v2(this.btn.x,this.startPos.y));this.btn.y+=250*t}},sendShoot:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,i.NET_11010,{processData:this.gameControl.stringToBytes()})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"110b0E7jrpFJ7DtMCrGGJa1","Bullet");var a=t("GlobalData");cc.Class({extends:cc.Component,properties:{jumpHeight:400,bulGravity:5,destroyTime:10,realBullet:cc.Node},onLoad:function(){this.timer=0,this.speed=0,this.cancelDestroy=!1,this.gameControl=cc.find(a.GAME_NAME).getComponent(a.GAME_CONTROL),this.body=this.node.getComponent(cc.RigidBody)},start:function(){},update:function(t){this.cancelDestroy||(this.body.linearVelocity=cc.v2(this.speed,0),this.timer+=t,this.timer>this.destroyTime&&this.node.destroy())},onBeginContact:function(t,e,o){if(o.node.group==a.FIRE||o.node.group==a.ICE){var i=o.node.convertToWorldSpace(cc.v2(0,0)),n=this.node.convertToWorldSpace(cc.v2(0,0)),s=o.node.getComponent(a.PLAYER_CONTROL);i.y>n.y+3?(s.specialJump(this.jumpHeight),this.body.gravityScale=this.bulGravity,this.body.linearVelocity=cc.v2(0,0),this.cancelDestroy=!0,this.realBullet.active=!0,this.node.scale=cc.v2(1*this.direction(),1),this.realBullet.getComponent(a.WEAPON).startDown(this.speed),this.node.getComponent(cc.PhysicsBoxCollider).destroy(),this.node.getComponent(cc.RigidBody).destroy(),this.node.getComponent(cc.Sprite).destroy(),this.node.getChildByName("Tail").destroy()):s.playDead()}o.node.group==a.UNIDOOR&&this.boom(o)},boom:function(t){this.node.destroy(),t.node.destroy()},direction:function(){return 0<this.node.scaleX?1:-1}}),cc._RF.pop()},{GlobalData:"GlobalData"}],CloudControl:[function(t,e,o){"use strict";cc._RF.push(e,"a5ae972ScZJf5IRtbt+BFDi","CloudControl"),cc.Class({extends:cc.Component,properties:{bigCloudPos:cc.Node,normalCloudPos:cc.Node,smallCloudPos:cc.Node,bigEndPos:cc.Node,norEndPos:cc.Node,smallEndPos:cc.Node,bcSpeed:10,ncSpeed:40,scSpeed:80,bcList:{default:[],type:cc.Node},ncList:{default:[],type:cc.Node},scList:{default:[],type:cc.Node}},start:function(){},onLoad:function(){},cloudMove:function(t){for(var e in this.bcList){(o=this.bcList[e]).x+=this.bcSpeed*t,o.x<=this.bigEndPos.x&&o.setPosition(this.bigCloudPos.getPosition().x,o.y)}for(var e in this.ncList){(o=this.ncList[e]).x+=this.ncSpeed*t,o.x<=this.norEndPos.x&&o.setPosition(this.normalCloudPos.getPosition().x,o.y)}for(var e in this.scList){var o;(o=this.scList[e]).x+=this.scSpeed*t,o.x<=this.smallEndPos.x&&o.setPosition(this.smallCloudPos.getPosition().x,o.y)}},update:function(t){this.cloudMove(t)}}),cc._RF.pop()},{}],DamageControl:[function(t,e,o){"use strict";cc._RF.push(e,"017d8M+QNtFzrz4ZkeWGW0h","DamageControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{moveSpace:0,damageLen:0,game:cc.Node},start:function(){},onLoad:function(){this.initValues()},damageMove:function(t){this.node.x+=this.moveSpace*t,this.node.x>this.damageInitPos.x+this.moveLen&&(this.node.position=this.damageInitPos)},onBeginContact:function(t,e,o){o.node.active&&o.node.getComponent(i.PLAYER_CONTROL).playDead()},initValues:function(){this.damageInitPos=this.node.getPosition(),this.moveLen=this.damageLen,this.game=cc.find(i.GAME_NAME),this.gameControl=this.game.getComponent(i.GAME_CONTROL)},update:function(t){this.damageMove(t)}}),cc._RF.pop()},{GlobalData:"GlobalData"}],DoorDefender:[function(t,e,o){"use strict";cc._RF.push(e,"94a71V5Oi1NorZLut9F2hZS","DoorDefender");var s=t("GlobalData");cc.Class({extends:cc.Component,properties:{nSpeed:300,rSpeed:500,defender:cc.Node,startNode:cc.Node,endNode:cc.Node,animNode:cc.Node,waitTime:2},onLoad:function(){var t=this.node.getComponent(cc.PhysicsBoxCollider).size.width;cc.log(t),this.RUN="run",this.STAND="dj1",this.wait=!1,this.waitTimer=0,this.seePlayer=!1,this.onHead=!1,this.onHeadTimer=0,this.onHeadTime=.2,this.isDead=!1,this.body=this.defender.getComponent(cc.RigidBody),this.startPos=this.startNode.getPosition(),this.endPos=this.endNode.getPosition(),this.player=null,this.passFirst=!1,this.anim=this.animNode.getComponent(dragonBones.ArmatureDisplay)},start:function(){},playRun:function(){this.anim.animationName!=this.RUN&&this.anim.playAnimation(this.RUN)},playStand:function(){this.anim.animationName!=this.STAND&&this.anim.playAnimation(this.STAND,1)},update:function(t){if(this.isDead)this.defender.rotation=90;else if(this.onHead)this.wait?(this.body.linearVelocity=cc.v2(3*this.nSpeed,0),this.onHeadTimer+=t,this.wait=!1,this.flipAnim(-this.animNode.scaleX)):(this.body.linearVelocity=cc.v2(3*this.nSpeed,0),this.onHeadTimer+=t),this.onHeadTimer>this.onHeadTime&&(this.onHeadTimer=0,this.onHead=!1);else if(this.seePlayer){o=this.node.parent.convertToNodeSpace(this.player.children[0].convertToWorldSpace(cc.v2(0,0)));var e=this.node.parent.convertToNodeSpace(this.defender.convertToWorldSpace(cc.v2(0,0)));if(o.x>this.startPos.x&&o.x<this.endPos.x){if(this.playRun(),o.x<e.x){if(!this.passFirst)return void(this.passFirst=!0);this.rSpeed=-Math.abs(this.rSpeed),this.nSpeed=-Math.abs(this.nSpeed),this.flipAnim(1)}else if(o.x>e.x){if(this.passFirst)return void(this.passFirst=!1);this.rSpeed=Math.abs(this.rSpeed),this.nSpeed=Math.abs(this.nSpeed),this.flipAnim(-1)}this.body.linearVelocity=cc.v2(this.rSpeed,0)}else this.losePlayer()}else{var o;(o=this.node.parent.convertToNodeSpace(this.defender.convertToWorldSpace(cc.v2()))).x<this.startPos.x?(this.waiting(t,this.startPos.x),this.nSpeed=Math.abs(this.nSpeed)):o.x>this.endPos.x&&(this.waiting(t,this.endPos.x),this.nSpeed=-Math.abs(this.nSpeed)),this.wait||(this.playRun(),this.body.linearVelocity=cc.v2(this.nSpeed,0))}},waiting:function(t,e){this.playStand(),this.wait=!0,this.waitTimer+=t,this.waitTimer>this.waitTime&&(this.wait=!1,this.waitTimer=0,this.defender.setPosition(e,this.defender.getPosition().y),this.flipAnim())},onBeginContact:function(t,e,o){if(e.tag==s.DRAG_TAG||o.node.group!=s.FIRE&&o.node.group!=s.ICE||(e.tag==s.DEFENDER_HEAD_TAG?this.onHead||(this.onHead=!0):o.node.getComponent(s.PLAYER_CONTROL).playDead()),e.tag==s.DEFENDER_DEAD_TAG&&o.tag==s.CATCH_TAG){var i=o.node.getComponent(s.STONE);if(null!=i&&i.isThrowOut){this.isDead=!0,this.playStand();var n=this.node.getComponent(cc.PhysicsPolygonCollider);n.sensor=!1,n.tag=s.DRAG_TAG,n.apply()}}},seeSomethings:function(t){this.waitTimer=0,this.wait=!1,this.player=t,this.seePlayer=!0},losePlayer:function(){this.seePlayer=!1},flipAnim:function(t){this.animNode.scaleX=null==t?-this.animNode.scaleX:t}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Door:[function(t,e,o){"use strict";cc._RF.push(e,"90769ZhZOxCjalbzzZs9DR0","Door");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{defender:cc.Node},onLoad:function(){this.dControl=this.defender.getComponent(i.DOOR_DEFENDER)},start:function(){},onBeginContact:function(t,e,o){e.tag!=i.DEFENDER_RANGE_TAG||o.node.group!=i.FIRE&&o.node.group!=i.ICE||this.dControl.seeSomethings(o.node)},onEndContact:function(t,e,o){e.tag!=i.DEFENDER_RANGE_TAG||o.node.group!=i.FIRE&&o.node.group!=i.ICE||this.dControl.losePlayer()}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Flabellum:[function(t,e,o){"use strict";cc._RF.push(e,"e4e3fMq+/9Ad435XFdtrAy6","Flabellum"),cc.Class({extends:cc.Component,properties:{pos:cc.Node},onLoad:function(){},start:function(){},update:function(t){this.node.setPosition(this.pos.getPosition())}}),cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"ba610LozN5H/rKvHP0p3Uvz","Game");var l=t("GlobalData");cc.Class({extends:cc.Component,properties:{uiStart:cc.Node,star:cc.Prefab,fire:cc.Node,ice:cc.Node,fireBall:cc.Node,iceBall:cc.Node,playerFather:cc.Node,uiSelect:cc.Node,uiTop:cc.Node,uiControl:cc.Node,uiPause:cc.Node,uiPass:cc.Node,uiDead:cc.Node,level:cc.Node,levelNode:cc.Node,mountain:cc.Node,musicNode:cc.Node,netNum:cc.Node,initGold:50,levelMoveSpeed:.5,startMoveOutTime:1.5,moveOutTime:2,mFrameRate:{tooltip:"当前游戏的帧率",default:30}},onLoad:function(){this.loadPlayerNode(),this.initValues(),this.initSocketData()},start:function(){},update:function(t){this.startCountDown&&(this.timeLimit-=t,this.timeLimit<=0&&(this.timeLimit=0)),null!=this.socketManager.mBufSocket&&(this.isSingle||this.socketIsConnect()||this.uiStart.active||(this.uiStart.active=!0)),this.sendHBPTimer<this.sendHBPTime&&(this.sendHBPTimer+=t,this.sendHBPTimer>=this.sendHBPTime&&(this.sendHeartbeatPackage(),this.sendHBPTimer=0)),this.loadingNextLevel&&(this.loadTimer+=t,1<this.loadTimer&&(this.loadingNextLevel=!1))},initSocketData:function(){this.playerId=0,this.nickname="",this.roomId=0,this.matchId=""},setNetNum:function(t){this.netNumLabel.string=t+"ms",t<100?this.netNum.color=new cc.Color(31,255,0):100<=t&&t<200?this.netNum.color=new cc.Color(253,239,130):200<=t&&(this.netNum.color=new cc.Color(255,0,0))},socketIsConnect:function(){return null!=this.socketManager.mBufSocket&&1==this.socketManager.mBufSocket.readyState},gameTime:function(){var t=parseInt(this.timeLimit/60),e=parseInt(this.timeLimit%60);return e<10&&(e="0"+e),t+":"+e},initTouch:function(){this.isFire=!1,this.isIce=!1,this.fireDistance=0,this.iceDistance=0},initPlayer:function(){this.loadPlayer(-1)},initNet:function(){this.circleWood=null},setFrameRate:function(t){cc.game.setFrameRate(t)},initValues:function(){(this.gameControl=this).setFrameRate(this.mFrameRate),this.initNet(),this.playBgControl=null,this.netTimestamp=0,this.timeLimit=0,this.isReadyChange=!1,this.startCountDown=!1,this.loadingNextLevel=!1,this.loadTimer=0,this.bigCar=null,this.starControl=null,this.netPlayerControl=null,this.localPlayerControl=null,this.isShowing=!1,this.backUpFire=null,this.backUpIce=null,this.isSingle=!0,this.socketManager=cc.find("SocketManager").getComponent("SocketManager"),this.netNumLabel=this.netNum.getComponent(cc.Label),this.node1=this.levelNode.getChildByName(l.NODE1),this.node2=this.levelNode.getChildByName(l.NODE2),this.node1Pos=this.node1.getPosition(),this.node2Pos=this.node2.getPosition(),this.totalDiamond=0,this.sendHBPTimer=0,this.sendHBPTime=30,this.passDoor=null,this.starRank=new Array,this.levelLists=new Array,this.cLevelIndex=0,this.playerType=0,this.panelIsLoading=!1,this.thirdDeadGold=4,this.secondDeadGold=1,this.uiTopControl=null,this.localGold=0,null==this.getItem(l.LOCAL_GOLD)?this.changeGold(this.initGold):this.localGold=this.getItem(l.LOCAL_GOLD),this.firePosDic=new Array,this.icePosDic=new Array,this.uiDic=new Array,this.matchingLevelDic=new Array,this.initPlayer(),this.musicControl=this.musicNode.getComponent("MusicControl"),this.uc=null,this.IsDebug(),this.fireControl=null,this.iceControl=null,this.stoneList=null,this.preLevel=null,this.isInGame=!1;var e=this;this.applyCsvToArray(l.MATCHLEVEL_DATA,function(t){e.matchingLevelDic=t}),this.setKey()},IsDebug:function(){cc.director.setDisplayStats(!1)},sendHeartbeatPackage:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11004),cc.log("发送心跳包")},sendTimestamp:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11010,{processData:this.stringToBytes(this.playerType+","+l.NET_TIMESTAMP+","+this.getTimestamp())})},stringToBytes:function(t){for(var e,o,i=[],n=0;n<t.length;n++){for(e=t.charCodeAt(n),o=[];o.push(255&e),e>>=8;);i=i.concat(o.reverse())}return i},byteToString:function(t){if("string"==typeof t)return t;for(var e="",o=t,i=0;i<o.length;i++){var n=o[i].toString(2),s=n.match(/^1+?(?=0)/);if(s&&8==n.length){for(var a=s[0].length,c=o[i].toString(2).slice(7-a),r=1;r<a;r++)c+=o[r+i].toString(2).slice(2);e+=String.fromCharCode(parseInt(c,2)),i+=a-1}else e+=String.fromCharCode(o[i])}return e},isPlayer:function(t){return t.node.group==l.FIRE||t.node.group==l.ICE},getFirePos:function(){return this.fire.convertToWorldSpace(cc.v2(0,0))},getIcePos:function(){return this.ice.convertToWorldSpace(cc.v2(0,0))},getNodePos:function(t){return t.convertToWorldSpace(cc.v2(0,0))},doSomethingToPlayer:function(t){this.initTouch(),this.fireDistance=cc.pDistance(this.getNodePos(t),this.getFirePos()),this.iceDistance=cc.pDistance(this.getNodePos(t),this.getIcePos()),cc.log(this.getFirePos()+","+this.getIcePos()+","+this.getNodePos(t)),this.fireDistance<this.iceDistance?this.isFire=!0:this.isIce=!0},changeToWorldPos:function(t){return t.convertToWorldSpace(cc.v2(0,0))},ContainsWords:function(t,e){return 0<=e.indexOf(t)},showLightFrame:function(){},loadUIResImg:function(t){cc.loader.loadRes("UI/"+t,cc.SpriteFrame,function(t,e){img=e})},stupidLi:function(t,e){return Math.floor(t)/e},changeControlPlayer:function(){0==this.playerType?(this.playerType=1,this.netPlayerControl=this.gameControl.fireControl):(this.playerType=0,this.netPlayerControl=this.gameControl.iceControl)},readyToChangePlayer:function(){this.isReadyChange=!0},wantPlayAgain:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11007,{})},clearOldLevelData:function(){null!==this.level&&(this.destroyLevel(),cc.log("重新刷新关卡。。。。。。。。。。。。。。。。")),null!==this.preLevel&&(this.destroyPreLevel(),cc.log("重新刷新预加载关卡。。。。。。。。。。。。。。。。"))},backToStart:function(){var t=(""+this.gameControl.matchingLevelDic[1]).split(","),e=Math.floor(Math.random()*t.length);this.gameControl.cLevelIndex=0,this.gameControl.sendLoadLevelIndex(t[e])},restartGame:function(){this.node.active=!1;var t=this.level.name.split("el");this.loadLevel(t[1],!0)},sendRestart:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11011,{score:0,resultData:this.stringToBytes(l.NET_RESTART+","+this.playerType)})},sendPass:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11011,{score:0,resultData:this.stringToBytes(l.NET_PASS+"")})},sendLoadLevelIndex:function(t){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11010,{processData:this.stringToBytes(l.NET_LOAD_LEVEL_INDEX+","+t)}),cc.log("发送加载关卡的信息:"+t)},sendPreLoadLevelIndex:function(t){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11010,{processData:this.stringToBytes(l.NET_PRE_LOAD_LEVEL_INDEX+","+t)}),cc.log("发送预加载关卡的信息:"+t)},loadLevel:function(a,c){null!=this.fireBall&&this.fireBall.setParent(this.fireControl.fatherNode),null!=this.iceBall&&this.iceBall.setParent(this.iceControl.fatherNode),null==c&&(c=!1),this.uiStart.active=!1,this.clearAllPanel(),this.fireCount=0,this.iceCount=0;var r=this;this.musicControl.bgmC.isPlaying||this.musicControl.playBgm(),null==r.mountain&&cc.loader.loadRes(l.GAME_TOOLS+l.MOUNTAIN,function(t,e){t?cc.log(t):(r.mountain=cc.instantiate(e),cc.director.getScene().addChild(r.mountain),r.mountain.setParent(cc.find(l.GAME_BG)),r.mountain.setSiblingIndex(0),r.playBgControl=r.mountain.getComponent(l.MOUNTAIN))}),cc.loader.loadRes(l.LEVEL_PATH+a,function(t,e){if(t)cc.log("加载关卡预制体报错："+t);else{r.netNum.parent.active=!0,r.netNum.active=!0,r.isInGame=!0,r.destroyLevel(),r.level=cc.instantiate(e);var o=r.level.getComponent("LevelControl");c||r.cLevelIndex++,cc.log("当前玩耍的关卡是"+r.cLevelIndex),r.timeLimit=o.levelTime,r.totalDiamond=o.totalDiamond,r.thirdDeadGold=o.thirdDeadGold,r.secondDeadGold=o.secondDeadGold,r.stoneList=new Array(o.maxStoneCount);for(var i=0;i<r.stoneList.length;i++)r.stoneList[i]=null;r.fireCount=0,r.iceCount=0,r.changeDiamond();var n=0;for(var s in o.starRank)r.starRank[n]=o.starRank[s],n++;r.startCountDown=!0,r.level.setParent(r.setLevelParent(l.SET_LEVEL_NODE)),null==r.levelPos&&(r.levelPos=r.level.getPosition()),null!=r.uiSelect&&(r.uiSelect.active=!1),r.loadPlayer(a),r.cLevelIndex<r.matchingLevelDic.length-1&&r.readyToPreLoad()}}),r.loadUI(l.UI_CONTROL_NAME)},getLevelIndex:function(t){var e=t.name.split("el");return parseInt(e[1])},readyToPreLoad:function(){if(0===this.playerType){var t=this.cLevelIndex+1,e=(""+this.matchingLevelDic[t]).split(","),o=Math.floor(Math.random()*e.length);this.sendPreLoadLevelIndex(e[o])}},preLoadLevel:function(t){var r=this;r.cLevelIndex+1>=this.matchingLevelDic.length||(cc.log("预加载的index："+t),cc.loader.loadRes(l.LEVEL_PATH+t,function(t,e){if(t)cc.log("加载关卡预制体报错："+t);else{r.destroyPreLevel();var o=cc.instantiate(e);o.active=!1,r.preLevel=o;var i=r.preLevel.getComponent("LevelControl");r.timeLimit=i.levelTime,r.totalDiamond=i.totalDiamond,r.thirdDeadGold=i.thirdDeadGold,r.secondDeadGold=i.secondDeadGold,r.stoneList=new Array(i.maxStoneCount);for(var n=0;n<r.stoneList.length;n++)r.stoneList[n]=null;r.fireCount=0,r.iceCount=0,r.changeDiamond();var s=0;for(var a in i.starRank)r.starRank[s]=i.starRank[a],s++;r.startCountDown=!0,null!=r.preLevel.parent&&cc.log(r.preLevel.getPosition()+","+r.preLevel.parent.name);var c=r.setLevelParent(l.SET_PRELEVEL_NODE);r.preLevel.setParent(c),null==r.preLevelPos&&(r.preLevelPos=r.preLevel.getPosition()),null!=r.uiSelect&&(r.uiSelect.active=!1)}}))},setLevelParent:function(t){switch(null==t&&(t=l.SET_PRELEVEL_NODE),t){case l.SET_LEVEL_NODE:return this.node1.x<this.node2.x?this.node1:this.node2;case l.SET_PRELEVEL_NODE:return this.node1.x>this.node2.x?this.node1:this.node2}},destroyLevel:function(){null!=this.level&&(this.level.destroy(),this.level=null)},destroyPreLevel:function(){null!=this.preLevel&&(this.preLevel.destroy(),this.preLevel=null)},loadPlayerNode:function(){var o=this;cc.loader.loadRes(l.GAME_TOOLS+l.PLAYER_NODE,function(t,e){t?cc.log(t):(o.playerFather=cc.instantiate(e),o.playerFather.setParent(cc.find(l.PLAYER_NODE)))})},loadPlayer:function(t){var i=this;null==i.fire&&cc.loader.loadRes(l.GAME_TOOLS+l.FIRE_PREFAB,function(t,e){if(t)cc.log(t);else{var o=cc.instantiate(e);i.fire=o,i.backUpFire=cc.instantiate(e),i.fireBall=o.getChildByName(l.BALL),i.playerFather.addChild(o),i.fireControl=i.fireBall.getComponent(l.PLAYER_CONTROL),cc.log("角色："+i.fireControl)}}),null==i.ice&&cc.loader.loadRes(l.GAME_TOOLS+l.ICE_PREFAB,function(t,e){if(t)cc.log(t);else{var o=cc.instantiate(e);i.ice=o,i.backUpIce=cc.instantiate(e),i.iceBall=o.getChildByName(l.BALL),i.playerFather.addChild(o),i.iceControl=i.iceBall.getComponent(l.PLAYER_CONTROL)}}),null!=this.ice&&null!=this.fire&&0<t&&(this.setPos(t),this.setPlayerToDoor())},setPlayerToDoor:function(){var t=this.passDoor.fireNode.parent.convertToNodeSpaceAR(this.fireBall.convertToWorldSpaceAR(cc.v2(0,0))),e=this.passDoor.iceNode.parent.convertToNodeSpaceAR(this.iceBall.convertToWorldSpaceAR(cc.v2(0,0)));this.passDoor.fireNode.setPosition(this.passDoor.fireNode.parent.convertToNodeSpaceAR(this.firePosDic[l.FIRE_POS_DIC+this.cLevelIndex]).x,t.y),this.passDoor.iceNode.setPosition(this.passDoor.iceNode.parent.convertToNodeSpaceAR(this.icePosDic[l.ICE_POS_DIC+this.cLevelIndex]).x,e.y),this.fireBall.setParent(this.passDoor.fireNode),this.iceBall.setParent(this.passDoor.iceNode),this.fireControl.setPlayerPosition(cc.v2(0,0)),this.iceControl.setPlayerPosition(cc.v2(0,0))},playerRunToPos:function(){var t=this;this.fireControl.justRun(),this.iceControl.justRun(),setTimeout(function(){t.fireControl.stopRun(),t.iceControl.stopRun()},this.levelMoveSpeed*this.startMoveOutTime*1e3)},setPos:function(t){var e=this,o=cc.v2(e.firePosDic[l.FIRE_POS_DIC+t].x,e.firePosDic[l.FIRE_POS_DIC+t].y),i=cc.v2(e.icePosDic[l.ICE_POS_DIC+t].x,e.icePosDic[l.ICE_POS_DIC+t].y),n=e.fire.getChildByName(l.BALL),s=e.ice.getChildByName(l.BALL);null==n&&(n=cc.instantiate(this.backUpFire)),null==s&&(s=cc.instantiate(this.backUpIce)),e.setPlayerPos(e.fire,n,o),e.setPlayerPos(e.ice,s,i)},setPlayerPos:function(t,e,o){t.active=!0,e.active=!0,t.setPosition(t.parent.convertToNodeSpace(o)),t.setSiblingIndex(l.PLAYER_LAYER);var i=e.getComponent(l.PLAYER_CONTROL);for(var n in i.initPos(),i.initPlayer(),i.putThing.children)this.ContainsWords(l.BALL,i.putThing.children[n].name)||i.putThing.children[n].destroy();cc.log("球的局部坐标："+t.getPosition()+","+e.getPosition()),t.setScale(-1,1)},setPlayerParent:function(t,e){e.setParent(t)},setKey:function(){var o=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.y:var e=o.level.name.split("el");cc.log("关卡index:"+e[1])}})},clearAllPanel:function(){for(var t in this.uiDic)this.uiDic[t].active=!1},loadGameTools:function(o){var i=this;null==i.uiTop?cc.loader.loadRes(l.UI_PREFABS+"UITop",function(t,e){t?cc.log(t):(i.uiTop=cc.instantiate(e),cc.director.getScene().addChild(i.uiTop),i.isTopShow(o.name))}):(i.uiTop.setSiblingIndex(l.UI_TOOL_LAYER),i.isTopShow(o.name))},backGameTools:function(){for(var t in this.uiDic){var e=this.uiDic[t];e.active&&this.loadGameTools(e)}},savePlayerPrefab:function(){null!==this.fireControl&&null!==this.iceControl&&(this.fireControl.hidePlayer(),this.iceControl.hidePlayer(),this.fireBall.setParent(this.fire),this.iceBall.setParent(this.ice))},loadNextLevel:function(){var t=this;if(this.cLevelIndex<this.matchingLevelDic.length-1){var e=this.cLevelIndex+1,o=t.firePosDic[l.FIRE_POS_DIC+e].x-400,i=t.icePosDic[l.ICE_POS_DIC+e].x-400,n=t.fireBall.convertToWorldSpaceAR(cc.v2(0,0)).y,s=t.iceBall.convertToWorldSpaceAR(cc.v2(0,0)).y;s<n?n=s:s=n,this.savePlayerPrefab(),this.showNextLevel(),t.fireControl.setPlayerPosition(t.fireBall.parent.convertToNodeSpaceAR(cc.v2(o,n))),t.iceControl.setPlayerPosition(t.iceBall.parent.convertToNodeSpaceAR(cc.v2(i,s)))}else this.savePlayerPrefab(),this.fireControl.showPassPanel()},showNextLevel:function(){if(!this.isShowing){var e=this;e.cLevelIndex++,e.playerRunToPos(),e.preLevel.active=!0,this.isShowing=!0,this.closePhysic();var t=this.node1Pos,o=cc.v2(-this.node2Pos.x,this.node2Pos.y),i=cc.moveTo(this.levelMoveSpeed,t),n=cc.moveTo(this.levelMoveSpeed,o);this.setLevelParent(l.SET_LEVEL_NODE).runAction(n),this.setLevelParent(l.SET_PRELEVEL_NODE).runAction(i),this.playBgControl.isMoving=!0,setTimeout(function(){e.playBgControl.isMoving=!1},1e3*this.levelMoveSpeed),setTimeout(function(){e.setLevelParent(l.SET_LEVEL_NODE).setPosition(e.node2Pos),e.destroyLevel();var t=cc.instantiate(e.preLevel);t.setParent(e.setLevelParent(l.SET_LEVEL_NODE)),e.level=t,e.readyToPreLoad(),e.isShowing=!1},2*this.levelMoveSpeed*1e3)}},closePhysic:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getPhysicsManager().enabled=!1},openPhysic:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0},sendNextLevelData:function(){this.socketManager.sendData(this.socketManager.rootp11,l.NET_11011,{score:0,resultData:this.stringToBytes(l.NET_NEXTLEVEL+","+this.cLevelIndex)})},loadUI:function(o){var i=this;if(!i.panelIsLoading)if(null==i.uiDic[o])i.panelIsLoading=!0,cc.loader.loadRes(l.UI_PREFABS+o,function(t,e){t?cc.log(t):(i.uiDic[o]=cc.instantiate(e),i.uiDic[o].setParent(cc.find(l.UI)),i.loadGameTools(i.uiDic[o]),i.panelIsLoading=!1)});else{var t=i.uiDic[o];t.active=!0,t.setSiblingIndex(l.UI_LAYER),i.loadGameTools(i.uiDic[o])}},getTimestamp:function(){return(new Date).getTime()},applyCsvToArray:function(t,o){var i=this;cc.loader.loadRes(l.TEXT_PATH+t,function(t,e){t?cc.log("加载文本出错"+t):o(i.CSVToArray(e))})},CSVToArray:function(t,e){e=e||",";for(var o=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),i=[[]],n=null;n=o.exec(t);){var s=n[1];if(s.length&&s!=e&&i.push([]),n[2])var a=n[2].replace(new RegExp('""',"g"),'"');else a=n[3];i[i.length-1].push(a)}return i},getCsvLevelConfig:function(t){for(var e=this.CSVToArray(t,","),o=1;o<=e.length-1;o++)for(var i=e[o],n=0;n<i.length;n++)cc.log("i:"+o+",j:"+n+","+e[o][n])},isTopShow:function(t){var e=this;switch(t){case l.UI_CONTROL_NAME:e.uiTop.active=!1;break;case l.UI_PASS_NAME:case l.UI_DEAD_NAME:case l.UI_PAUSE_NAME:case l.UI_SELECT_NAME:e.uiTop.active=!0;break;default:e.uiTop.active=!1}e.uiTop.active=!1,cc.log(t+","+e.uiTop.active)},changeDiamond:function(){var t=this.uiDic[l.UI_CONTROL_NAME];null!=t&&t.getComponent("UITools").changeDiamond()},getStar:function(){var t=this.fireCount+this.iceCount;for(var e in this.starCount=0,this.starRank)t>=this.starRank[e]&&this.starCount++;return this.starCount},changeGold:function(t){},getItem:function(t){return cc.sys.localStorage.getItem(t)},setItem:function(t,e){cc.sys.localStorage.setItem(t,e)},showBtnLight:function(t){t.getChildByName(l.LIGHT).active=!0},hideBtnLight:function(t){t.getChildByName(l.LIGHT).active=!1},backMainPanel:function(){this.uiDic[l.UI_CONTROL_NAME].active=!1,this.uiStart.active=!0},showTips:function(i,t,e,o,n,s,a){cc.loader.loadRes(l.GAME_TOOLS+l.TIPS,function(t,e){if(t)cc.log("加载提示预制体出错");else{var o=cc.instantiate(e);o.setParent(i),o.getComponent()}})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],GlobalData:[function(t,e,o){"use strict";var i,n,s;cc._RF.push(e,"4dabbvMO/pBiohzPmI6oW5w","GlobalData"),e.exports=((n="NET_READYSTATE")in(i={GAME_NAME:"Canvas",GAME_CONTROL:"Game",FIRE_POS_DIC:"firePosDic",ICE_POS_DIC:"icePosDic",LEVEL_FIRE_NODE:"LevelFireNode",PRESS_BTN_CONTROL:"PressBtn",PLAYER_CONTROL:"PlayerControl",LEVEL_CONTROL:"LevelControl",DOOR:"Door",BULLET:"Bullet",WATERWHEEL_CONTROL:"WaterWheelControl",HANDCAR_CONTROL:"HandcarControl",HANDCAR_NODE:"HandCarNode",PLAYER_NODE:"PlayerNode",BTN_IMG:"BtnImg",LIGHT:"Light",OPEN_BG:"OpenBg",OPEN_BTN:"OpenBtn",BTN_END_POS:"BtnEndPos",PLATFORM_ENDPOS:"EndPos",PLATFORM_CONTROL:"PlatformControl",PLATFORM:"Platform",SPIKEWEED:"Spikeweed",SPIKEWEED_CONTROL:"SpikeweedControl",WOODSPIKE:"WoodSpike",UI_ATLAS:"TotalAtlas",LEVEL_BTN:"LevelBtn",LEVEL_PATH:"prefabs/Level/Level",UI_CONTROL:"prefabs/UI/UIControl",GAME_TOOLS:"prefabs/GameTools/",GAME_SPRITE:"GameSprite/",MOUNTAIN:"PlayGameBg",TIPS:"Tips",PLAYER_BALL:"PlayerBall",Ice_MagicBall:"IceMagicBall",Fire_MagicBall:"FireMagicBall",UI_PATH:"UI/",UI_PREFABS:"prefabs/UI/",TEXT_PATH:"Text/",MATCHLEVEL_DATA:"MatchLevelData",UI:"UI",GAME_BG:"GameBg",OBJECT:"Object",StarAnim:"StarAnim",LEVEL_NODE:"LevelNode",NODE1:"Node1",NODE2:"Node2",FIRE_PREFAB:"PlayerFire",ICE_PREFAB:"PlayerWater",PLAYER:"Player",BALL:"Ball",GRAVITYCAR_STAIRS:"GravityCarStairs",STAIRS:"Stairs",BALLSPAWN:"BallSpawn",STONE:"Stone",GROUND:"Ground",FIRE:"Fire",ICE:"Ice",WALL:"Wall",UNIDOOR:"UniDoor",UNIDOOR_CONTROL:"UniDoorControl",WEAPON:"Weapon",CIRCLEWOOD:"CircleWood",BIGCAR:"BigCar",UI_CONTROL_NAME:"UIControl",GRAVITYCAR_NAME:"GravityCar",UI_TOOLS_NAME:"UITools",UI_START:"UIStart",UI_DEAD_NAME:"UIDead",UI_PASS_NAME:"UIPass",UI_PAUSE_NAME:"UIPause",UI_SELECT_NAME:"UISelect",UI_FACE_NAME:"UIFaceToFace",UI_TOP_NAME:"UITop",LOCAL_GOLD:"LocalGold",DOOR_DEFENDER:"DoorDefender",TOTALDOOR_CONTROL:"TotalDoorControl",DRAG_TAG:6,CATCH_TAG:5,PLATFORM_TAG:4,PLAYER_FOOT_TAG:3,WATERWHEEL_TAG:8,HANDCAR_TAG:9,BULLET_TAG:10,Water_TAG:11,SPIKEWEED_TAG:12,BIGCAR_TAG:13,GC_TAG:14,WINDMILL_TAG:15,BALLSPAWN_TAG:16,DEFENDER_HEAD_TAG:17,DEFENDER_RANGE_TAG:18,DEFENDER_DEAD_TAG:19,PASSDOOR_TAG:20,CIRCLE_WOOD_TAG:21,NET_TIMESTAMP:100,NETTAG_CIRCLE_WOOD:101,NETTAG_BIG_CAR:102,NETTAG_CATCH_DRAG:103,NETTAG_STONE:104,NETTAG_SHOOT:105,NETTAG_BULLETPOS:106,UI_TOOL_LAYER:102,UI_LAYER:101,PLAYER_LAYER:100,LEVEL_LAYER:99,PLAYER_HEAD:200,NET_DRAG_CATCH:3,NET_LEFT:-(s=1),NET_RIGHT:1,NET_JUMP:2,NET_STAND:0,NET_ON_GROUND:4,SET_LEVEL_NODE:1,SET_PRELEVEL_NODE:2,NET_DEAD:1,NET_PASS:2,NET_RESTART:3,NET_EATSTAR:4,NET_UNIDOOR:5,NET_NEXTLEVEL:6,NET_UPDATE_MYSELF:7,NET_SET_MYSELF:8,NET_NEED_MYSELF:9,NET_LOAD_LEVEL_INDEX:10,NET_PRE_LOAD_LEVEL_INDEX:11,NET_11010:11010,NET_11011:11011,NET_11004:11004,NET_11007:11007,NET_DOORCLOSE:2,NET_READYSTATE:3})?Object.defineProperty(i,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[n]=s,i),cc._RF.pop()},{}],GravityCar:[function(t,e,o){"use strict";cc._RF.push(e,"5830fhUgDhJwZxJvZi98ae5","GravityCar");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{car:cc.Node,carMoveSpeed:50,carRotateSpeed:30,stairs:{default:[],type:cc.Node},endPos:cc.Node},onLoad:function(){for(var t in this.type=0,this.isInside=!1,this.isRotating=!1,this.carBody=this.car.getComponent(cc.RigidBody),this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.mControls=new Array,this.stairs)this.mControls[t]=this.stairs[t].getComponent(i.STAIRS);this.endRotation=this.car.rotation,this.startPos=this.car.getPosition().x},start:function(){},update:function(t){1<Math.abs(Math.abs(this.car.rotation)-Math.abs(this.endRotation))?(this.carBody.angularVelocity=this.carRotateSpeed,this.car.getPosition().x<=this.endPos.getPosition().x&&this.car.getPosition().x>this.startPos-1&&(this.carBody.linearVelocity=cc.v2(this.carMoveSpeed,0))):(this.car.getPosition().x<this.startPos?this.car.setPosition(cc.v2(this.startPos,this.car.getPosition().y)):this.car.getPosition().x>this.endPos.x&&this.car.setPosition(cc.v2(this.endPos.x,this.car.getPosition().y)),this.car.rotation=this.endRotation,this.isRotating=!1)},rotateCar:function(t){var e=t.convertToWorldSpace(cc.v2(0,0)),o=e.x,i=e.y,n=e.x,s=e.y;for(var a in this.stairs){var c=this.stairs[a].convertToWorldSpace(cc.v2(0,0)).x,r=this.stairs[a].convertToWorldSpace(cc.v2(0,0)).y;o<c&&(o=c),i<r&&(i=r),c<n&&(n=c),r<s&&(s=r)}e.x==o||e.x==n?this.isInside=!0:this.isInside=!1,e.x==n||e.y==s?this.rotateWhichDirection(2):this.rotateWhichDirection(1)},rotateWhichDirection:function(t){if(0!=Math.floor(this.car.rotation%90)||this.isInside){this.isRotating=!0;var e=Math.floor(this.car.rotation/90);switch(t){case 1:this.endRotation=90*(e+1),this.carRotateSpeed=Math.abs(this.carRotateSpeed),this.carMoveSpeed=Math.abs(this.carMoveSpeed);break;case 2:this.endRotation=90*(e-1),this.carRotateSpeed=-Math.abs(this.carRotateSpeed),this.carMoveSpeed=-Math.abs(this.carMoveSpeed)}}else this.isRotating=!1}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Ground:[function(t,e,o){"use strict";cc._RF.push(e,"84f819Ih3VLvq183ZrNhxdG","Ground"),cc.Class({extends:cc.Component,properties:{},start:function(){},onLoad:function(){cc.director.getCollisionManager().enabled=!0},update:function(t){},onCollisionEnter:function(){cc.log("1111")}}),cc._RF.pop()},{}],HandcarControl:[function(t,e,o){"use strict";cc._RF.push(e,"c391bxadRFKXbiNAMCOykF/","HandcarControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{waterWheel:cc.Node,carSpeed:1,waitTime:1,car:cc.Node,endPosNode:cc.Node},onLoad:function(){this.initValues()},start:function(){},initValues:function(){this.move=!1,this.startPos=this.car.getPosition(),this.cSpeed=0,this.endPos=this.endPosNode.getPosition(),this.wwc=this.waterWheel.getComponent(i.WATERWHEEL_CONTROL),this.waitTimer=0,this.carBody=this.car.getComponent(cc.RigidBody)},open:function(){this.move=!0},close:function(){this.move=!1},moveCar:function(t){var e=this.car.getPosition().x;if(this.endPos.x>this.startPos.x){if(e>this.endPos.x+1||e<this.startPos.x)return this.cSpeed=0,this.waitTimer+=t,this.carBody.linearVelocity=cc.v2(0,0),void(this.waitTimer>=this.waitTime&&(this.waitTimer=0,this.car.getPosition().x>=this.endPos.x?this.car.setPosition(this.endPos):this.car.setPosition(this.startPos),this.carSpeed=-this.carSpeed))}else if(this.endPos.x<this.startPos.x&&(e>this.startPos.x+1||e<this.endPos.x))return this.cSpeed=0,this.waitTimer+=t,this.carBody.linearVelocity=cc.v2(0,0),void(this.waitTimer>=this.waitTime&&(this.waitTimer=0,this.car.getPosition().x>=this.startPos.x?this.car.setPosition(this.startPos):this.car.setPosition(this.endPos),this.carSpeed=-this.carSpeed));this.cSpeed=this.wwc.cSpeed*this.carSpeed,this.carBody.linearVelocity=cc.v2(this.cSpeed,0)},stopCar:function(){this.cSpeed=0,this.carBody.linearVelocity=cc.v2(0,0),this.waitTimer=0},update:function(t){this.move?this.moveCar(t):this.stopCar()}}),cc._RF.pop()},{GlobalData:"GlobalData"}],LevelBtn:[function(t,e,o){"use strict";cc._RF.push(e,"d403eORHWRM+Le0YNpWehoa","LevelBtn");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{levelIndex:0},start:function(){this.initValues()},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL);var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.cLevelIndex=t.levelIndex,t.gameControl.loadLevel(t.levelIndex),t.gameControl.socketManager.sendData(t.gameControl.socketManager.rootp11,11002,{})})},setIndex:function(t){this.levelIndex=t}}),cc._RF.pop()},{GlobalData:"GlobalData"}],LevelControl:[function(t,e,o){"use strict";cc._RF.push(e,"1dc94p0CLhKrLKzVSAWS2f8","LevelControl"),cc.Class({extends:cc.Component,properties:{levelTime:300,totalDiamond:6,starRank:{default:[],type:cc.Integer},thirdDeadGold:4,secondDeadGold:1,maxStoneCount:5},start:function(){},onLoad:function(){var t=this.node.name.split("el");this.levelIndex=t[1]},update:function(t){}}),cc._RF.pop()},{}],MusicControl:[function(t,e,o){"use strict";cc._RF.push(e,"a3294LJ5cFLBY4JjJutbd8m","MusicControl"),cc.Class({extends:cc.Component,properties:{bgm:cc.Node,gold:cc.Node,dead:cc.Node},start:function(){},onLoad:function(){this.initBgm(),this.initGold(),this.initDead()},initBgm:function(){this.bgmC=this.bgm.getComponent(cc.AudioSource)},initGold:function(){this.goldC=this.gold.getComponent(cc.AudioSource)},initDead:function(){this.deadC=this.dead.getComponent(cc.AudioSource)},setMute:function(){this.goldC.mute=!this.goldC.mute,this.deadC.mute=!this.deadC.mute},setBgmMute:function(){this.bgmC.mute=!this.bgmC.mute},playBgm:function(){this.bgmC.play()},playDead:function(){this.bgmC.stop(),this.deadC.play()},playGold:function(){this.goldC.play()},isMute:function(){return!(!this.deadC.mute||!this.goldC.mute)},isBgmMute:function(){return!!this.bgmC.mute}}),cc._RF.pop()},{}],NumBtn:[function(t,e,o){"use strict";cc._RF.push(e,"7cae5UFfZRJyopTRJAtvMGs","NumBtn");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{levelIndex:cc.Label,uiFaceToFace:cc.Node},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.ufc=this.uiFaceToFace.getComponent(i.UI_FACE_NAME),this.initBtn()},initBtn:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){t.ufc.pushNum(t.levelIndex.string),t.gameControl.showBtnLight(t.node)}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.node)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(){t.gameControl.hideBtnLight(t.node)})},start:function(){}}),cc._RF.pop()},{GlobalData:"GlobalData"}],PlatformControl:[function(t,e,o){"use strict";cc._RF.push(e,"c10b83scq5OQaaX7m/PsU/8","PlatformControl");var s=t("GlobalData");cc.Class({extends:cc.Component,properties:{moveSpeed:0,rotateSeed:.1,tpb:cc.Node,bpb:cc.Node,moveNode:cc.Node},start:function(){},onLoad:function(){this.initValues()},initValues:function(){this.cMoveSpeed=0,this.isOpen=!1,this.pause=!1,this.moveNode=null,this.rotateAnim=null,this.body=this.node.getComponent(cc.RigidBody),this.player=null,this.startPos=this.node.getPosition(),this.endPos=this.node.parent.getChildByName(s.PLATFORM_ENDPOS),this.startRotation=this.node.rotation,this.endRotation=this.endPos.rotation,this.space=cc.pDistance(this.startPos,this.endPos.getPosition());var t=this.node.getChildren()[0].getChildren();this.bigGear=t[0],this.smallGear=t[t.length-1],null!=this.tpb&&null!=this.bpb&&(this.tpbC=this.tpb.getComponent(s.PRESS_BTN_CONTROL),this.bpbC=this.bpb.getComponent(s.PRESS_BTN_CONTROL))},open:function(){null!=this.endPos&&(this.isOpen=!0,this.pause=!1,this.cMoveSpeed=this.rotateSeed*(cc.pDistance(this.node.getPosition(),this.endPos.getPosition())/this.space),this.rotateAnim=cc.rotateTo(this.cMoveSpeed,this.endRotation),this.node.runAction(this.rotateAnim))},close:function(){null!=this.startPos&&(this.isOpen=!1,this.pause=!1,this.cMoveSpeed=this.rotateSeed*(cc.pDistance(this.node.getPosition(),this.startPos)/this.space),this.rotateAnim=cc.rotateTo(this.cMoveSpeed,this.startRotation),this.node.runAction(this.rotateAnim))},onBeginContact:function(t,e,o){o.tag==s.PLAYER_HEAD&&this.platformPause(o.node)&&(this.pause=!0)},onEndContact:function(t,e,o){o.tag==s.PLAYER_HEAD&&this.platformPause(o.node)&&(this.pause=!1)},platformPause:function(t){if(t.group==s.FIRE||t.group==s.ICE){var e=(this.player=t).convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.convertToWorldSpaceAR(cc.v2(0,0)),i=Math.abs(o.x-e.x),n=.6*this.node.getComponent(cc.PhysicsBoxCollider).size.width;if(e.y>o.y&&n<i)return!1}return!0},platformMove:function(t){this.body.linearVelocity=cc.v2(t,this.body.linearVelocity.y),this.bigGear.rotation+=t,this.smallGear.rotation-=t},platformUp:function(t){this.body.linearVelocity=cc.v2(this.body.linearVelocity.x,t),this.bigGear.rotation+=t,this.smallGear.rotation-=t},update:function(t){this.pause?this.body.linearVelocity=cc.v2(0,0):(this.endPos.x>this.startPos.x?this.isOpen?this.node.getPosition().x<this.endPos.x?this.platformMove(-this.moveSpeed):this.platformMove(0):this.node.getPosition().x>this.startPos.x?this.platformMove(this.moveSpeed):this.platformMove(0):this.endPos.x<this.startPos.x&&(this.isOpen?this.node.getPosition().x>this.endPos.x?this.platformMove(-this.moveSpeed):this.platformMove(0):this.node.getPosition().x<this.startPos.x?this.platformMove(this.moveSpeed):this.platformMove(0)),this.endPos.y>this.startPos.y?this.isOpen?this.node.getPosition().y<this.endPos.y?this.platformUp(this.moveSpeed):this.platformUp(0):this.node.getPosition().y>this.startPos.y?this.platformUp(-this.moveSpeed):this.platformUp(0):this.endPos.y<this.startPos.y&&(this.isOpen?this.node.getPosition().y>this.endPos.y?this.platformUp(-this.moveSpeed):this.platformUp(0):this.node.getPosition().y<this.startPos.y?this.platformUp(this.moveSpeed):this.platformUp(0)))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],PlayGameBg:[function(t,e,o){"use strict";cc._RF.push(e,"8f16eetFVRD/rFU9esbXdsa","PlayGameBg"),cc.Class({extends:cc.Component,properties:{farNode:cc.Node,normalNode:cc.Node,nearNode:cc.Node,farSpeed:10,normalSpeed:20,nearSpeed:30},onLoad:function(){this.isMoving=!1,this.initX=1919,this.changePosX=-1919},start:function(){},update:function(t){this.isMoving&&(this.nodeMove(this.nearNode,this.nearSpeed),this.checkPos(this.nearNode),this.nodeMove(this.normalNode,this.normalSpeed),this.checkPos(this.normalNode),this.nodeMove(this.farNode,this.farSpeed),this.checkPos(this.farNode))},nodeMove:function(t,e){var o=t.getChildren();for(var i in o)o[i].x-=e},checkPos:function(t){var e=t.getChildren()[0],o=t.getChildren()[1];if(e.x<=this.changePosX||o.x<=this.changePosX){if(e.x<o.x)return void e.setPosition(cc.v2(o.x+this.initX+1,e.y));o.setPosition(cc.v2(e.x+this.initX+1,o.y))}}}),cc._RF.pop()},{}],PlayerBall:[function(t,e,o){"use strict";cc._RF.push(e,"a625cEkRT9KDKRcxQuqdVOy","PlayerBall"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.becomeBallTime=0,this.timer=0,this.isBall=!1,this.player=null},start:function(){},update:function(t){this.isBall&&(this.timer+=t,this.timer>this.becomeBallTime&&this.returnPlayer())},becomeBall:function(t,e){this.becomeBallTime=t,this.player=e,this.isBall=!0},returnPlayer:function(){this.isBall=!1,this.node.rotation=0,this.player.returnPlayer()}}),cc._RF.pop()},{}],PlayerControl:[function(t,e,o){"use strict";cc._RF.push(e,"0dd90JPwgJHiKcaLWVnlp8Q","PlayerControl");var m=t("GlobalData");cc.Class({extends:cc.Component,properties:{walkSpeed:0,dragSpeed:0,jumpHeight:680,jumpTime:0,isStand:!1,playerType:0,animObj:cc.Node,arrow:cc.Node,oneFootIsLeft:!1,fatherNode:cc.Node,catchPos:cc.Node,dragPos:cc.Node,becomeBallTime:5,catchSpace:100,cutSpace:110,idleSpace:3,changeProbability:.7,putThing:cc.Node,throwPower:cc.v2(1e3,500),mySelf:cc.Node},start:function(){},onLoad:function(){this.InitValues(),this.setKey()},onEnable:function(){},update:function(t){if(this.isDead||(this.justRunning?(this.playRunAnim(),this.stones=null):(this.walk(),this.toChangeAnim&&this.changeIdleByTime(),!this.justRunning&&this.anim.animationName==this.RUN&&Math.abs(this.body.linearVelocity.x)<=1&&this.playDj1(),1<=Math.abs(this.body.linearVelocity.x)&&this.anim.animationName==this.DJ1&&!this.jumping&&this.playRun())),this.updateTimer<=this.updateTime?this.updateTimer+=t:(this.updateStone(),this.updateTimer=0),this.sendCarTimer+=t,this.sendCarTimer>this.sendCarTime&&!this.canSendCarData&&(this.canSendCarData=!0,this.sendCarTimer=0),this.jump&&(this.playJump(),this.jump=!1),this.gameControl.isInGame&&this.gameControl.playerType==this.playerType&&!this.isOnHead){var e=this;this.sendPlayerData(this.direction)}if((this.left||this.right)&&(this.isOnHead=!1,this.isOnCar=!1),this.isBall&&(this.ballTimer+=t,this.ballTimer>this.becomeBallTime&&this.returnPlayer()),this.body.linearVelocity.y<-200&&(this.playDown(),this.stopDrag()),null!==this.bigcarSpace&&(this.updateOnHeadPlayerPos(this.bigcarPrefab,this.bigcarSpace,!0),this.bigcarSpace=null),null!==this.stoneSpace&&(this.updateOnHeadPlayerPos(this.stonePrefab,this.stoneSpace,!0),this.stoneSpace=null),this.isputUp)this.catchBox.setPosition(this.catchPos.getPosition());else if(this.isDrag){var o=this.dragBox.getComponent(cc.PhysicsPolygonCollider);if(null!=o&&o.tag==m.DOOR_DEFENDER){var i=0,n=0;for(var s in o.points)i>o.points[s].y&&(i=o.points[s].y),n<o.points[s].y&&(n=o.points[s].y);var a=n-i;if(0<a){var c=-a;return void this.dragBox.setPosition(c,this.dragBox.getPosition().y)}}else if(this.gameControl.ContainsWords(m.BIGCAR,this.dragBox.name)){var r=this.dragBox.getComponent(cc.RigidBody),l=this.dragBox.getComponent(m.BIGCAR);r.linearVelocity=cc.v2(this.body.linearVelocity.x,r.linearVelocity.y);var h=this.dragBox.convertToWorldSpaceAR(cc.v2(0,0)),d=this.node.convertToWorldSpaceAR(cc.v2(0,0));null==(l.controlPlayer=this).playerDragCarSpace&&(this.playerDragCarSpace=h.x-d.x);var p=this.dragBox.parent.convertToNodeSpaceAR(cc.v2(d.x+this.playerDragCarSpace,h.y));return this.dragBox.setPosition(p),void(Math.abs(h.x-d.x)>this.cutSpace&&!this.isNetPlayer()&&(this.stopDrag(),this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11010,{processData:this.gameControl.stringToBytes(this.gameControl.playerType+","+m.NET_DRAG_CATCH+","+e.node.getPosition().x+","+e.node.getPosition().y+",,0")})))}var u=this.dragBox.getComponent(cc.RigidBody);u.linearVelocity=cc.v2(this.body.linearVelocity.x,u.linearVelocity.y)}},updateParentPosition:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.node.parent.setPosition(this.node.parent.parent.convertToNodeSpaceAR(t)),this.node.setPosition(this.node.parent.convertToNodeSpaceAR(t))},initPos:function(){this.node.setParent(this.fatherNode),this.node.setPosition(cc.v2(0,0))},setPlayerPosition:function(t){var e=this.node;(0<e.parent.scaleX&&0<t.x||e.parent.scaleX<0&&t.x<0)&&(t=cc.v2(-t.x,t.y)),e.setPosition(t)},setPlayerNotOnHeadPosition:function(t){this.node.setPosition(t)},initPlayer:function(){this.knockWall=!1,this.wallIsLeft=!1,this.isDead=!1,this.isBelow=!1,this.isOnCar=!1,this.toChangeAnim=!0,this.isOnHead=!1,this.jumping=!1,this.jumpIsCD=!1,this.canCatch=!1,this.catchBox=null,this.catchBoxParnet=null,this.catchScale=cc.v2(0,0),this.canDrag=!1,this.dragBox=null,this.dragBoxParnet=null,this.dragScale=cc.v2(0,0),this.touchStone=!1,this.isDrag=!1,this.isputUp=!1,this.isPush=!1,this.left=!1,this.right=!1,this.moveSpeed=0,this.jump=!1,this.cHeight=0,this.jumpAction=null,this.body.linearVelocity=cc.v2(0,0),this.body.linearDamping=0,this.updateTime=1,this.updateTimer=0,this.sendCarTime=1,this.sendCarTimer=0,this.canSendOnTheGround=!0,this.initBigCar(),this.initStone(),this.canSendCarData=!1,this.stones=new Array,cc.log("初始化石头列表111")},initBigCar:function(){this.playerDragCarSpace=null,this.bigcarSpace=null,this.bigcarPrefab=null},initStone:function(){this.playerDragStoneSpace=null,this.stoneSpace=null,this.stonePrefab=null},sendPlayerData:function(t){if(this.gameControl.socketIsConnect()&&this.canSendOnTheGround){if(this.isBelow)var e=this.gameControl.netPlayerControl.node,o=e.convertToWorldSpaceAR(cc.v2(0,0)),i=+o.x+","+o.y+","+e.parent.scaleX+","+e.getComponent(m.PLAYER_CONTROL).body.linearVelocity.x+",0";var n=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11010,{processData:this.gameControl.stringToBytes(this.playerType+","+t+","+n.x+","+n.y+","+this.body.linearVelocity.x+","+this.body.linearVelocity.y+","+i)})}},addStone:function(t){if(!this.gameControl.isSingle&&this.playerType===this.gameControl.playerType&&this.playerType===this.gameControl.playerType){for(var e in this.stones)if(t==this.stones[e])return;this.stones.push(t)}},updateStone:function(){if(!this.gameControl.isSingle&&!this.gameControl.justRunning)for(var t in this.stones){var e=this.stones[t].getComponent(m.STONE);e.stoneType==this.playerType&&e.sendStoneData()}},sendStoneData:function(){if(!this.gameControl.isSingle&&!this.gameControl.justRunning)for(var t in this.stones){this.stones[t].getComponent(m.STONE).sendStoneData()}},needToUpdateYourSelf:function(t){this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(m.NET_NEED_MYSELF+","+t)})},updateAll:function(){this.sendGetPosData()},sendGetPosData:function(t){null==t&&(t=this.playerType),this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(m.NET_UPDATE_MYSELF+","+t)})},sendNetPlayerData:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(m.NET_SET_MYSELF+","+this.gameControl.netPlayerControl.playerType+","+this.gameControl.netPlayerControl.node.x+","+this.gameControl.netPlayerControl.node.y)}),this.sendStoneData(),null!=this.gameControl.bigCar&&this.sendBigCarData(this.gameControl.bigCar)},getPosData:function(t){(0<this.node.parent.scaleX&&0<t.x||this.node.parent.scaleX<0&&t.x<0)&&(t=cc.v2(-t.x,t.y)),this.setPlayerPosition(t)},InitValues:function(){this.DJ1="stand_1",this.DJ2="stand_2",this.RUN="run",this.DOWN="jump_3",this.JUMP="jump_1",this.JUMP2="jump_2",this.DIE1="die_1",this.DIE2="die_2",this.PUSH1="push_1",this.PUSH2="push_2",this.PUSH3="push_3",this.CATCH1="catch_1",this.CATCH2="catch_2",this.CATCH3="catch_3",this.CATCH4="catch_4",this.CATCH5="catch_5",this.direction=0,this.mySelf=this.node,this.onWaterWheel=!1,this.justRunning=!1,this.isTreading=!1,this.stairObj=null,this.ballTimer=0,this.isEnterBallSpawn=!1,this.isBall=!1,this.newBall=null,this.initScale=cc.v2(0,0),this.onHeadPlayerSpace=0,this.initGravity=0,this.wwc=null,this.rePlayerPos=null,this.fatherNode=this.node.parent,this.body=this.node.getComponent(cc.RigidBody),this.yLv=this.body.linearVelocity.y,this.gameControl=cc.find(m.GAME_NAME).getComponent(m.GAME_CONTROL),this.openPhysic(),this.anim=this.animObj.getComponent(dragonBones.ArmatureDisplay),this.playNextAnim(),this.playDj1(),this.anotherPlayer=null,this.initPlayer()},becomeBall:function(){if(!this.isBall){var i=this;this.isBall=!0;var t=m.Fire_MagicBall;1===this.playerType&&(t=m.Ice_MagicBall),null==this.newBall&&cc.loader.loadRes(m.GAME_TOOLS+t,function(t,e){if(t)cc.log("加载铁球出错："+t);else{i.node.active=!1,i.initScale=cc.v2(i.node.scaleX,i.node.scaleY),i.newBall=cc.instantiate(e),i.initScale=cc.v2(i.node.parent.scaleX,i.node.parent.scaleY);var o=-i.node.parent.scaleX;i.newBall.setParent(i.node.parent),i.newBall.setPosition(i.node.getPosition()),i.node.parent.scaleX=Math.abs(i.node.parent.scaleX),i.newBall.scaleX=o,i.node.setParent(i.newBall),i.newBall.name=i.node.group+m.BALL,i.newBall.getComponent(m.PLAYER_BALL).becomeBall(i.becomeBallTime,i.node.getComponent(m.PLAYER_CONTROL))}})}},returnPlayer:function(){this.ballTimer=0,this.isBall=!1,this.node.active=!0,this.leftExit(),this.rightExit(),this.fatherNode.scaleX=Math.abs(this.fatherNode.scaleX),this.node.setParent(this.fatherNode);var t=this.newBall.convertToWorldSpaceAR(cc.v2(0,0)),e=this.fatherNode.convertToNodeSpaceAR(t);this.node.setPosition(e),this.newBall.active=!1,this.newBall.destroy(),this.newBall=null},walk:function(){if(!this.onWaterWheel||!this.isBall){var t=this.body.linearVelocity.x,e=this.body.linearVelocity.y,o=this.walkSpeed;if(this.isDrag&&this.gameControl.ContainsWords(m.BIGCAR,this.dragBox.name)&&(o=this.dragSpeed),this.left)this.body.linearVelocity=cc.v2(-o,e);else if(this.right)this.body.linearVelocity=cc.v2(o,e);else if(this.isStand){var i=t/t;this.body.linearVelocity=cc.v2(i,e)}else this.body.linearVelocity=cc.v2(0,e)}},playNextAnim:function(){this.anim.addEventListener(dragonBones.EventObject.COMPLETE,this.playWhichAnim,this)},playWhichAnim:function(){switch(this.anim.animationName){case this.JUMP:return this.playJump2;case this.JUMP2:return this.playDown;case this.DOWN:return this.playDj1}},onBeginContact:function(t,e,o){var i=o.node.group;if(!this.justRunning&&(i==m.GROUND||i==m.FIRE||i==m.ICE||o.tag==m.WINDMILL_TAG||o.tag==m.GC_TAG||i==m.UNIDOOR)&&this.body.linearVelocity.y<=0){this.jumping=!1;var n=e.node.convertToWorldSpaceAR(cc.v2(0,0)),s=o.node.convertToWorldSpaceAR(cc.v2(0,0));if(n.y>s.y){if(i!=m.GROUND||this.isStand||this.isNetPlayer()||this.sendPlayerData(m.NET_ON_GROUND),this.isStand=!0,Math.abs(this.body.linearVelocity.x)<=0?this.playDj1():(this.isPush=!1,this.playRun()),o.tag==m.WINDMILL_TAG&&this.playDj1(),o.tag==m.GC_TAG){this.playDj1(),this.isTreading=!0;var a=this.node.convertToWorldSpaceAR(cc.v2(0,0)),c=o.node.convertToWorldSpaceAR(cc.v2(0,0));o.node!=this.stairObj&&a.y>c.y&&(this.stairObj=o.node,o.node.getComponent(m.STAIRS).rotateCar())}this.oneFootIsLeft=!1}}if(this.gameControl.ContainsWords(m.STONE,o.node.name)&&(this.touchStone=!0,o.node.getComponent(m.STONE).stoneType=this.playerType,this.addStone(o.node)),o.tag==m.BALLSPAWN_TAG&&(this.isEnterBallSpawn=!0,this.catchBoxParnet=o.node),o.tag==m.SPIKEWEED_TAG&&this.playDead(),this.gameControl.ContainsWords(m.BIGCAR,o.node.name)&&(o.node.getComponents(cc.RigidBody).linearVelocity=cc.v2(0,0)),this.canCatch||this.canDrag||o.tag!=m.CATCH_TAG||null!=this.catchBox&&(null==this.catchBox||""!=this.catchBox.name)||this.catchThing(o.node),o.tag===m.DRAG_TAG&&!this.isDrag){this.dragThing(o.node);var r=o.node.convertToWorldSpaceAR(cc.v2(0,0));10<Math.abs(this.body.linearVelocity.x)&&this.node.convertToWorldSpaceAR(cc.v2(0,0)).y<r.y&&(this.isPush=!0,this.playRun())}},catchThing:function(t){this.canCatch=!0,this.catchBox=t,this.catchBoxParnet=t.parent},dragThing:function(t){this.canDrag=!0,this.dragBox=t,this.dragScale=this.dragBox.scale,this.dragBoxParnet=t.parent,this.gameControl.ContainsWords(m.BIGCAR,this.dragBox.name)&&this.openBigCar()},updatePlayerBody:function(t){this.gameControl.ContainsWords(m.BIGCAR,t.name)?this.body.linearDamping=t.getComponent(m.BIGCAR).car.linearDamping:this.gameControl.ContainsWords(m.STONE,t.name)&&(this.body.linearDamping=t.getComponent(m.STONE).body.linearDamping)},updateOnHeadPlayerPos:function(t,e,o){if(null===e&&(e=this.space),!this.touchStone){var i=cc.v2(t.convertToWorldSpaceAR(cc.v2(0,0)).x+e,0);o?this.setPlayerNotOnHeadPosition(cc.v2(this.node.parent.convertToNodeSpaceAR(i).x,this.node.y)):this.setPlayerPosition(cc.v2(this.node.parent.convertToNodeSpaceAR(i).x,this.node.y))}},onPreSolve:function(t,e,o){var i=o.node.group;this.node.convertToWorldSpaceAR(cc.v2(0,0));if(i==m.FIRE||i==m.ICE){var n=e.node.convertToWorldSpaceAR(cc.v2(0,0)),s=o.node.convertToWorldSpaceAR(cc.v2(0,0));n.y>s.y+3?this.left||this.right||(this.isOnHead=!0,this.body.linearVelocity=cc.v2(.8*o.node.getComponent(m.PLAYER_CONTROL).body.linearVelocity.x,this.body.linearVelocity.y)):n.y<s.y-3&&(this.isBelow=!0)}if(o.tag!=m.CIRCLE_WOOD_TAG||this.isNetPlayer()||this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11010,{processData:this.gameControl.stringToBytes(m.NETTAG_CIRCLE_WOOD+","+this.gameControl.playerType+","+o.node.x+","+o.node.y+","+o.node.name+","+o.node.getComponent(cc.RigidBody).linearVelocity.x+","+o.node.getComponent(cc.RigidBody).linearVelocity.y)}),(o.tag==m.CATCH_TAG||o.tag==m.DRAG_TAG)&&!this.isNetPlayer()&&this.isBigCar(o)){var a=o.node.getComponent(m.BIGCAR);if(a.isPulled&&null!=a.controlPlayer&&a.controlPlayer!=this)return;(a.controlPlayer=this).canSendCarData&&!o.node.getComponent(m.BIGCAR).isPulled&&(this.canSendCarData=!1,this.sendBigCarData(o.node))}if(o.tag!=m.WINDMILL_TAG&&o.tag!=m.GC_TAG||this.left||this.right||this.jump||(this.body.linearVelocity=cc.v2(o.node.getComponent(cc.RigidBody).linearVelocity.x,this.body.linearVelocity.y)),o.tag==m.WATERWHEEL_TAG&&this.isStand){this.wwc!=o.node.getComponent(m.WATERWHEEL_CONTROL)&&(this.wwc=o.node.getComponent(m.WATERWHEEL_CONTROL));var c=this.node.parent.convertToNodeSpace(this.wwc.carNode.convertToWorldSpace(cc.v2(0,0)));this.isStand=!0,c.x>this.node.getPosition().x&&(this.onWaterWheel=!0,this.body.linearVelocity=cc.v2(0,0)),this.left?this.wwc.leftRotate():this.right?this.wwc.rightRotate():this.wwc.stopRotate()}if(!this.gameControl.ContainsWords(m.PLATFORM,o.node.name)||this.left||this.right||(this.body.linearVelocity=cc.v2(o.node.getComponent(m.PLATFORM_CONTROL).body.linearVelocity.x,this.body.linearVelocity.y)),this.gameControl.ContainsWords(m.STONE,o.node.name)){var r=o.node.convertToWorldSpaceAR(cc.v2(0,0));(n=this.node.convertToWorldSpaceAR(cc.v2(0,0))).y>r.y&&!this.left&&!this.right&&(this.stoneSpace=n.x-r.x,this.stonePrefab=o.node)}if(!this.left&&!this.right&&o.tag==m.HANDCAR_TAG){var l=o.node.parent.getComponent(m.HANDCAR_CONTROL);this.body.linearVelocity=cc.v2(l.cSpeed,0)}},isBigCar:function(t){return!!this.gameControl.ContainsWords(m.BIGCAR,t.node.name)},sendBigCarData:function(t){null!=t&&this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11010,{processData:this.gameControl.stringToBytes(m.NETTAG_BIG_CAR+","+this.gameControl.playerType+","+t.x+","+t.y+","+t.name+","+t.getComponent(cc.RigidBody).linearVelocity.x+","+t.getComponent(cc.RigidBody).linearVelocity.y)})},onPostSolve:function(t,e,o){o.tag==m.CATCH_TAG&&(null==this.catchBox||null!=this.catchBox&&""==this.catchBox.name)&&(this.canCatch=!0,this.catchBox=o.node,this.catchBoxParnet=o.node.parent)},onEndContact:function(t,e,o){var i=o.node.group,n=e.node.convertToWorldSpaceAR(cc.v2(0,0)),s=o.node.convertToWorldSpaceAR(cc.v2(0,0));if(i==m.GROUND&&n.y>s.y&&(this.oneFootIsLeft?this.isStand=!1:this.oneFootIsLeft=!0),o.tag==m.BIGCAR_TAG){this.isOnCar=!1;var a=this.node.convertToWorldSpaceAR(cc.v2(0,0)),c=o.node.convertToWorldSpaceAR(cc.v2(0,0));a.y>c.y&&(this.body.linearDamping=0)}o.tag==m.BALLSPAWN_TAG&&(this.isEnterBallSpawn=!1),i!=m.FIRE&&i!=m.ICE||(this.isBelow=!1),this.gameControl.ContainsWords(m.STONE,o.node.name)&&(this.touchStone=!1),o.tag==m.GC_TAG&&(this.stairObj=null)},playDead:function(){!this.gameControl.isSingle&&this.isNetPlayer()||(this.showDeadPanel(),this.isNetPlayer()||this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,m.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(m.NET_DEAD+","+this.playerType)}))},justRun:function(){this.justRunning=!0,this.closePhysic(),this.playRunAnim()},stopRun:function(){var t=this;this.playRunAnim(),this.fatherNode.active=!0;var e=cc.moveTo(this.gameControl.moveOutTime,this.node.x-400,this.node.y);this.node.runAction(e),t.gameControl.bigCar=null,setTimeout(function(){t.initPlayer(),t.leftExit(),t.rightExit(),t.justRunning=!1,t.playDj1(),t.gameControl.setPlayerToDoor(),t.gameControl.bigCar=t.gameControl.level.getChildByName(m.OBJECT).getChildByName(m.BIGCAR),t.openPhysic()},1e3*this.gameControl.moveOutTime)},closePhysic:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getPhysicsManager().enabled=!1},openPhysic:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0},showDeadPanel:function(){if(!this.isDead){this.isDead=!0;var t=this;this.gameControl.musicControl.playDead(),this.anim.playAnimation(this.DIE1,1),setTimeout(function(){t.anim.playAnimation(t.DIE2,1)},500),setTimeout(function(){t.hidePlayer(),t.gameControl.loadUI(m.UI_DEAD_NAME)},2e3)}},hidePlayer:function(){this.node.setPosition(9999,9999)},showPassPanel:function(){this.gameControl.loadUI(m.UI_PASS_NAME),this.gameControl.fireControl.hidePlayer(),this.gameControl.iceControl.hidePlayer()},isNetPlayer:function(){return this.playerType!=this.gameControl.playerType},dragMove:function(){var t=this.dragBox.convertToWorldSpaceAR(cc.v2(0,0)),e=this.node.convertToWorldSpaceAR(cc.v2(0,0));if(Math.abs(t.x-e.x)<this.catchSpace){if(this.isDrag=!0,this.gameControl.ContainsWords(m.BIGCAR,this.dragBox.name))this.openBigCar();else if(this.gameControl.ContainsWords(m.STONE,this.dragBox.name)){this.dragBox.getComponent(m.STONE).dragByPlayer()}this.updatePlayerBody(this.dragBox)}},openBigCar:function(){this.dragBox.getComponent(m.BIGCAR).isPulled=!0},closeBigCar:function(){this.dragBox.getComponent(m.BIGCAR).isPulled=!1},stopDrag:function(){if(this.isDrag&&(this.isDrag=!1),null!=this.dragBox){if(this.gameControl.ContainsWords(m.BIGCAR,this.dragBox.name))this.closeBigCar(),this.playerDragCarSpace=null;else if(this.gameControl.ContainsWords(m.STONE,this.dragBox.name)){this.dragBox.getComponent(m.STONE).stopDrag()}this.body.linearDamping=0,this.dragBox.setParent(this.dragBoxParnet),this.dragBox.scale=this.dragScale,this.dragBox.setSiblingIndex(0),this.canDrag=!1,this.dragBox=null,this.gameControl.uc.changeCatchImg(this.isDrag)}},putUp:function(){var t=this.catchBox.convertToWorldSpace(cc.v2(0,0)),e=this.node.convertToWorldSpace(cc.v2(0,0));if(Math.abs(t.x-e.x)<this.catchSpace||this.isEnterBallSpawn){this.isputUp=!0;var o=this.catchBox.getComponent(cc.RigidBody);null!=o&&(this.initGravity=o.gravityScale,o.gravityScale=0),this.catchBox.group==m.WEAPON&&this.catchBox.getComponent(m.WEAPON).putUpWeapon(this),this.catchScale=this.catchBox.scale,this.catchBox.scale=this.playerDirection()*this.catchBox.scale/this.node.scale,this.catchBox.setParent(this.putThing),this.catchBox.setPosition(this.catchPos.getPosition())}},throwOut:function(){if(this.isputUp=!1,null!=this.catchBox){var t=this.catchBox.getComponent(cc.RigidBody);null!=t&&(t.gravityScale=this.initGravity),t.linearVelocity=cc.v2(-this.node.parent.scaleX*this.throwPower.x,this.throwPower.y),this.catchBox.group==m.WEAPON?this.catchBox.getComponent(m.WEAPON).throwOutWeapon():null!=this.catchBox.getComponent(m.STONE)&&(this.catchBox.getComponent(m.STONE).isThrowOut=!0),this.catchBox.setParent(this.catchBoxParnet),this.catchBox.scale=this.catchScale,cc.log(this.catchBox.scale),this.catchBox.setSiblingIndex(0),this.canCatch=!1,this.catchBox=null,this.gameControl.uc.changeCatchImg(!1)}},canControl:function(){return!(this.gameControl.isSingle||!this.isNetPlayer())},setKey:function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.a:if(0==e.playerType&&!e.left){if(e.canControl())return;e.leftClick()}break;case cc.KEY.d:if(0==e.playerType&&!e.right){if(e.canControl())return;e.rightClick()}break;case cc.KEY.w:if(0==e.playerType){if(e.canControl())return;e.upClick()}break;case cc.KEY.s:if(e.canControl())return;e.gameControl.isSingle?null!=e.gameControl.uc&&0==e.playerType&&e.gameControl.uc.catchSomething(0,!0):null!=e.gameControl.uc&&0==e.playerType&&e.playerType==e.gameControl.playerType&&e.gameControl.uc.catchSomething(0,!0);break;case cc.KEY.up:if(e.canControl())return;1==e.playerType&&e.upClick();break;case cc.KEY.left:if(e.canControl())return;1!=e.playerType||e.left||e.leftClick();break;case cc.KEY.right:if(e.canControl())return;1!=e.playerType||e.right||e.rightClick();break;case cc.KEY.down:if(e.canControl())return;e.gameControl.isSingle?1!=e.playerType||null==e.catchBox&&null==e.dragBox&&!e.isEnterBallSpawn||e.gameControl.uc.catchSomething(1,!0):e.gameControl.playerType!=e.playerType||1!=e.playerType||null==e.catchBox&&null==e.dragBox&&!e.isEnterBallSpawn||e.gameControl.uc.catchSomething(1,!0);break;case cc.KEY.space:1==e.playerType&&e.gameControl.changeControlPlayer(),null!=e.gameControl.uc&&e.gameControl.uc.switchPlayer();break;case cc.KEY.o:cc.log(e.playerType+":父节点的名字是："+e.node.parent.name),cc.log(e.playerType+":"+e.node.convertToWorldSpaceAR(cc.v2(0,0)).x+","+e.node.convertToWorldSpaceAR(cc.v2(0,0)).y)}}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){switch(t.keyCode){case cc.KEY.a:e.right||e.leftExit();break;case cc.KEY.d:e.left||e.rightExit();break;case cc.KEY.left:e.leftExit();case cc.KEY.right:e.rightExit()}})},setArrow:function(t){t!=this.playerType?this.arrow.active=!1:this.arrow.active=!0},leftClick:function(){this.isBall||this.left||(this.rightExit(),this.flip(1),this.direction=-1,this.left=!0,this.playRun())},rightClick:function(){this.isBall||this.right||(this.leftExit(),this.flip(-1),this.direction=1,this.right=!0,this.playRun())},leftExit:function(){this.isBall||(this.left=!1,this.isPush=!1,this.direction=m.NET_STAND,this.body.linearVelocity=cc.v2(0,this.body.linearVelocity.y),this.playDj1())},rightExit:function(){this.isBall||(this.right=!1,this.isPush=!1,this.direction=m.NET_STAND,this.body.linearVelocity=cc.v2(0,this.body.linearVelocity.y),this.playDj1())},playerStop:function(){this.leftExit(),this.rightExit()},playDj1:function(){if(this.anim.animationName!=this.DJ1&&!this.isDead&&!this.justRunning){this.isDrag?this.anim.playAnimation(this.CATCH2,1):this.anim.playAnimation(this.DJ1)}},playDj2:function(){var t=this;t.anim.playAnimation(t.DJ2,1),setTimeout(function(){t.playDj1()},1e3)},changeIdleByTime:function(){if(this.isStand&&0===this.body.linearVelocity.x&&!this.isDrag){var t=this;this.toChangeAnim=!1,setTimeout(function(){t.toChangeAnim=!0,Math.random()>1-t.changeProbability&&0===t.body.linearVelocity.x&&t.playDj2()},1e3*this.idleSpace)}},playRun:function(){this.isStand&&(this.left||this.right)&&!this.isDead&&this.body.linearVelocity.y<50&&(this.isDrag?this.playDragAnim():this.isPush?this.playPushAnim():this.playRunAnim())},playDragAnim:function(){if(this.anim.animationName!=this.CATCH3){var t=this;this.anim.animationName==this.CATCH2?t.playCatchOrPush():(this.anim.playAnimation(this.CATCH1,1),setTimeout(function(){t.playCatchOrPush()},200))}},playCatchOrPush:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0)),e=this.dragBox.convertToWorldSpaceAR(cc.v2(0,0)),o=this;t.x<e.x?this.left?o.anim.playAnimation(o.CATCH3):this.right&&o.anim.playAnimation(o.PUSH2):t.x>e.x&&(this.left?o.anim.playAnimation(o.PUSH2):this.right&&o.anim.playAnimation(o.CATCH3))},playPushAnim:function(){var t=this;this.anim.animationName==this.CATCH2?t.anim.playAnimation(t.PUSH2):this.anim.animationName!=this.PUSH2&&(this.anim.playAnimation(this.PUSH1,1),setTimeout(function(){t.jumping||t.anim.playAnimation(t.PUSH2)},200))},playRunAnim:function(){this.isDrag||this.anim.animationName==this.RUN?this.isDrag&&this.anim.playAnimation(this.RUN):this.anim.playAnimation(this.RUN)},playJump:function(){this.body.linearDamping=0,this.body.linearVelocity=cc.v2(this.body.linearVelocity.x,this.cHeight),this.anim.playAnimation(this.JUMP,1)},playJump2:function(){this.anim.animationName!=this.JUMP2&&this.anim.playAnimation(this.JUMP2,1)},specialJump:function(t){this.body.linearVelocity=cc.v2(this.body.linearVelocity.x,t),this.anim.playAnimation(this.JUMP,1)},playDown:function(){this.anim.animationName==this.DOWN||this.isStand||this.anim.playAnimation(this.DOWN,1)},upClick:function(){this.isBall||this.isDead||(this.isPush=!1,this.onWaterWheel&&(this.justJump(),this.jumping=!0,this.sendPlayerData(m.NET_JUMP)),0===this.body.linearVelocity.y&&(this.isStand=!0),!this.isStand||this.isBelow||this.jumpIsCD||(this.jumping=!0,this.onWaterWheel=!1,this.cHeight=this.jumpHeight,this.jump=!0,this.isStand=!1,this.isTreading=!1,this.sendPlayerData(m.NET_JUMP)),this.stopDrag())},isDowning:function(){return this.body.linearVelocity.y<-50},justJump:function(){this.jumping=!0,this.onWaterWheel=!1,this.cHeight=this.jumpHeight,this.jump=!0,this.isStand=!1,null!=this.wwc&&this.wwc.stopRotate(),this.playJump(),this.stopDrag()},justCatchDrag:function(t,e){if(""==t||0==e)return this.stopDrag(),void this.throwOut();var o=this.gameControl.level.getChildByName(m.OBJECT).getChildByName(t);e==m.DRAG_TAG?(this.isOnCar=!1,this.isDrag=!0,this.dragThing(o),this.dragMove(),this.updatePlayerBody(this.dragBox)):e==m.CATCH_TAG&&(this.isputUp=!0,this.catchThing(o))},playerDirection:function(){return 0<this.node.parent.scaleX?-1:1},flip:function(t){this.isDrag||this.justRunning||this.isDead||(this.updateParentPosition(),0<t?this.node.parent.setScale(1,1):this.node.parent.setScale(-1,1))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],PlayerNodeControl:[function(t,e,o){"use strict";cc._RF.push(e,"d60a3I3oaRPYZCP2PKFDNxu","PlayerNodeControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{firePos:{default:[],type:cc.Node},icePos:{default:[],type:cc.Node}},start:function(){},onLoad:function(){this.initValues()},initValues:function(){for(var t in this.myArray=[],this.myArray=this.node.getChildren(),this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.myArray){var e=this.myArray[t],o=e.name.split("Node");this.gameControl.ContainsWords(i.LEVEL_FIRE_NODE,e.name)?this.gameControl.firePosDic[i.FIRE_POS_DIC+o[1]]=e.convertToWorldSpaceAR(cc.v2(0,0)):this.gameControl.icePosDic[i.ICE_POS_DIC+o[1]]=e.convertToWorldSpaceAR(cc.v2(0,0))}}}),cc._RF.pop()},{GlobalData:"GlobalData"}],PressBtn:[function(t,e,o){"use strict";cc._RF.push(e,"d0e88Qsq+JKRY1Q4uIQdTzD","PressBtn");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{btn:cc.Node,endPos:cc.Node,game:cc.Node,platforms:{default:[],type:cc.Node},moveSpeed:0,anOtherPress:!1},start:function(){},onLoad:function(){this.game=cc.find(i.GAME_NAME),this.gameControl=this.game.getComponent(i.GAME_CONTROL),this.initValues()},initValues:function(){this.press=!1,this.playerCollider=null,this.btnInitPos=this.btn.getPosition(),this.btnEndPos=this.endPos.getPosition(),this.whichMachine(this.platforms[0].name)},whichMachine:function(t){if(this.mControls=new Array(this.platforms.length),this.gameControl.ContainsWords(i.PLATFORM,t))for(var e in this.platforms)this.mControls[e]=this.platforms[e].getComponent(i.PLATFORM_CONTROL);else if(this.gameControl.ContainsWords(i.SPIKEWEED,t))for(var e in this.platforms)this.mControls[e]=this.platforms[e].getComponent(i.SPIKEWEED_CONTROL);else if(this.gameControl.ContainsWords(i.WOODSPIKE,t))for(var e in this.platforms)this.mControls[e]=this.platforms[e].getComponent(i.WOODSPIKE)},onPostSolve:function(t,e,o){if(this.anOtherPress)this.press=!0;else{if(!this.press)for(var i in this.mControls)this.mControls[i].open();null==this.playerCollider&&(this.playerCollider=o.node),this.press=!0}},onEndContact:function(t,e,o){if(this.anOtherPress)this.press=!1;else{if(this.playerCollider==o.node){if(this.press)for(var i in this.mControls)this.mControls[i].close();this.playerCollider=null}this.press=!1}},update:function(t){this.press?this.btn.y>this.btnEndPos.y?this.btn.y-=this.moveSpeed*t:this.btn.setPosition(cc.v2(this.btn.x,this.btnEndPos.y)):this.btn.y<this.btnInitPos.y?this.btn.y+=this.moveSpeed*t:this.btn.setPosition(cc.v2(this.btn.x,this.btnInitPos.y))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],SocketManager:[function(t,e,o){"use strict";cc._RF.push(e,"90e65E/5HtFvIxSiMfTrvzK","SocketManager");var l=t("GlobalData");cc.Class({extends:cc.Component,properties:{updatePlayerSpace:30,playerStopTime:300,maxDelayTime:{default:2e3,tooltip:"超高延迟的临界值"}},onLoad:function(){this.initValues(),this.root=null,this.rootp11=null,this.mProtobuf=null,this.mBufSocket=null,this.isConnect=!1,this.toConnect=!0,this.socketIsClosed=!1,this.testProtobuf()},start:function(){},initValues:function(){this.ip="ws://dev-game.u17games.com:",this.port="12011",this.sendTSTime=.5,this.sendTSTimer=.5,this.gameControl=cc.find(l.GAME_NAME).getComponent(l.GAME_CONTROL),this.lastPos=cc.v2(0,0),this.updateIsCD=!1,this.updatePlayerTime=0,this.updateTime=0,this.getPlayerData=!1,this.playerScaleX=0},testProtobuf:function(){cc.sys.isNative&&(cc.log("jsb.fileUtils="+jsb.fileUtils),jsb.fileUtils.addSearchPath("res/raw-assets/resources",!0));var o=this,t=protobuf;this.mProtobuf=protobuf;t.load("p10.proto",function(t,e){if(t)throw t;o.root=e,cc.log("加载protobuf完毕，开始测试protobuf..."),o.setSocketListener()});t.load("p11.proto",function(t,e){if(t)throw t;o.rootp11=e,cc.log("加载protobuf完毕，开始测试protobuf...")})},createData:function(t,e,o){var i=t.lookup(e),n=i.create(o);return i.encode(n).finish()},int32ToUint8:function(t){var e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=255&t,e},int16ToUint8:function(t){var e=new Uint8Array(2);return e[0]=t>>8&255,e[1]=255&t,e},uint8ToInt32:function(t){var e=new Int32Array(1);return e[0]=(255&t[0])<<24,e[0]=e[0]|(255&t[1])<<16,e[0]=e[0]|(255&t[2])<<8,e[0]=e[0]|255&t[3],e[0]},uint8ToInt16:function(t){var e=new Int16Array(1);return e[0]=(255&t[0])<<8,e[0]=e[0]|255&t[1],e[0]},sendData:function(t,e,o,i){var n="cs_"+e,s=this.createData(t,n,o);null!=i&&i();for(var a=this.int32ToUint8(s.byteLength),c=(e=this.int16ToUint8(e),a.length),r=e.length,l=s.length,h=new Uint8Array(c+r+l),d=0;d<c;d++)h[d]=a[d];for(var p=0;p<r;p++)h[c+p]=e[p];for(var u=0;u<l;u++)h[c+r+u]=s[u];this.mBufSocket.send(h)},getData:function(t){},setSocketListener:function(t){var s=this;this.mBufSocket=new WebSocket(s.ip+s.port),this.mBufSocket.binaryType="arraybuffer",this.mBufSocket.addEventListener("open",function(t){s.isConnect=!0,s.socketIsClosed=!1,cc.log("服务器已连接上")}),this.mBufSocket.addEventListener("message",function(t){var e=new Uint8Array(t.data),o="sc_"+s.uint8ToInt16(e.subarray(4,6)),i=s.root.lookup(o);null==i&&(i=s.rootp11.lookup(o));var n=i.decode(e.subarray(6));s.scToDo(o,n)}),this.mBufSocket.addEventListener("error",function(t){cc.log("Message from server"+t.data),cc.log("链接socket发生错误")}),this.mBufSocket.addEventListener("close",function(t){s.isConnect=!1,s.toConnect=!0,s.socketIsClosed=!0,cc.log("关闭socket")})},scToDo:function(t,e){switch(t){case"sc_10000":this.gameControl.playerId=e.playerId,this.gameControl.nickname=e.nickname,cc.log("登陆成功"),cc.log(e);break;case"sc_10001":this.gameControl.roomId=e.roomId,this.gameControl.matchId=e.matchId,cc.log("房间创建成功"),cc.log(e);break;case"sc_11002":cc.log("准备开始游戏"),cc.log(e.result);break;case"sc_11003":cc.log("开始游戏"),this.gameControl.isSingle=!1,this.gameControl.clearOldLevelData(),0===this.gameControl.playerType&&this.gameControl.backToStart();break;case"sc_11010":var o=(r=this.gameControl.byteToString(e.processData).split(","))[0];if(o==this.gameControl.playerType&&r[1]==l.NET_TIMESTAMP){this.getPlayerData=!1,this.updateTime=this.gameControl.getTimestamp();var i=(new Date).getTime()-parseInt(r[2]);this.gameControl.setNetNum(i)}if(r[0]==l.NET_LOAD_LEVEL_INDEX&&(this.gameControl.loadLevel(parseInt(r[1])),cc.log("收到加载关卡的信息:"+parseInt(r[1]))),r[0]==l.NET_PRE_LOAD_LEVEL_INDEX&&(this.gameControl.preLoadLevel(parseInt(r[1])),cc.log("收到预加载关卡的信息:"+parseInt(r[1]))),null!=this.gameControl.netPlayerControl&&!this.gameControl.netPlayerControl.justRunning)if(o==l.NETTAG_STONE){var n=this.gameControl.level.getChildByName(l.OBJECT),s=this.getTool(n,r[6]);this.updateTool(s,cc.v2(r[2],r[3]),cc.v2(r[4],r[5]),r[7])}else if(o!=this.gameControl.playerType&&o<2){if(this.updatePlayerTime=this.gameControl.getTimestamp(),r[1]==l.NET_RIGHT)this.gameControl.netPlayerControl.rightClick();else if(r[1]==l.NET_LEFT)this.gameControl.netPlayerControl.leftClick();else if(r[1]==l.NET_JUMP)this.gameControl.netPlayerControl.justJump();else if(r[1]==l.NET_DRAG_CATCH)this.gameControl.netPlayerControl.justCatchDrag(r[4],r[5]);else if(r[1]==l.NET_STAND){if(null!=this.gameControl.netPlayerControl){var a=Math.abs(this.gameControl.netPlayerControl.mySelf.x-r[2]);if((!this.gameControl.netPlayerControl.isOnHead||50<a)&&!this.gameControl.netPlayerControl.jumping)if(this.gameControl.netPlayerControl.isOnCar?100<Math.abs(this.gameControl.netPlayerControl.node.convertToWorldSpaceAR(cc.v2(0,0)).y-r[3])&&this.updatePlayer(this.gameControl.netPlayerControl.mySelf,cc.v2(r[2],r[3]),this.gameControl.netPlayerControl.body,cc.v2(r[4],r[5])):this.updatePlayer(this.gameControl.netPlayerControl.mySelf,cc.v2(r[2],r[3]),this.gameControl.netPlayerControl.body,cc.v2(r[4],r[5])),null!=r[6]&&null!=r[7]&&!this.gameControl.localPlayerControl.left&&!this.gameControl.localPlayerControl.right)50<(a=Math.abs(this.gameControl.localPlayerControl.node.x-r[6]))&&(this.gameControl.localPlayerControl.rePlayerPos=cc.v2(r[6],r[7]),this.gameControl.localPlayerControl.jumping||this.updatePlayer(this.gameControl.localPlayerControl.node,cc.v2(r[6],r[7]),this.gameControl.localPlayerControl.body,cc.v2(r[9],r[10])));this.gameControl.netPlayerControl.leftExit(),this.gameControl.netPlayerControl.rightExit()}}else if(r[1]==l.NET_ON_GROUND){a=Math.abs(this.gameControl.netPlayerControl.mySelf.x-r[2]);this.gameControl.netPlayerControl.isOnHead&&!(50<a)||this.gameControl.netPlayerControl.jumping||this.gameControl.netPlayerControl.isOnCar||this.updatePlayer(this.gameControl.netPlayerControl.mySelf,cc.v2(r[2],r[3]),this.gameControl.netPlayerControl.body,cc.v2(r[4],r[5]))}}else if(r[1]!=this.gameControl.playerType&&null!=this.gameControl.level){n=this.gameControl.level.getChildByName(l.OBJECT);var c=null;o==l.NETTAG_CIRCLE_WOOD?(c=this.getTool(n,r[4]),this.updateTool(c,cc.v2(r[2],r[3]),cc.v2(r[5],r[6]))):o==l.NETTAG_BIG_CAR?(c=this.getTool(n,r[4]),this.updateTool(c,cc.v2(r[2],r[3]),cc.v2(r[5],r[6]))):o==l.NETTAG_CATCH_DRAG&&(c=this.getTool(n,r[4]),this.updateTool(c,cc.v2(r[2],r[3]),cc.v2(r[5],r[6])))}break;case"sc_11011":var r;n=this.gameControl.level.getChildByName(l.OBJECT);if((r=this.gameControl.byteToString(e.resultData).split(","))[1]!=this.gameControl.playerType)if(r[0]==l.NET_DEAD){if(0==r[1])return void this.gameControl.fireControl.showDeadPanel();this.gameControl.iceControl.showDeadPanel()}else if(r[0]==l.NET_RESTART)this.gameControl.restartGame();else if(r[0]==l.NET_PASS)this.gameControl.loadNextLevel();else if(r[0]==l.NET_EATSTAR)this.gameControl.starControl.netToEatGold(this.gameControl.netPlayerControl);else if(r[0]==l.NET_UNIDOOR){this.getTool(n,r[2]).getChildByName("Door").getComponent(l.UNIDOOR_CONTROL).doorDown()}else r[0]==l.NET_UPDATE_MYSELF&&this.gameControl.netPlayerControl.sendNetPlayerData();else r[1]==this.gameControl.playerType&&(r[0]==l.NET_NEED_MYSELF?this.gameControl.localPlayerControl.updateAll():r[0]==l.NET_SET_MYSELF&&this.gameControl.localPlayerControl.getPosData(cc.v2(r[2],r[3])));break;case"sc_11007":cc.log("房间返回信息："+e.result),e.result==l.NET_DOORCLOSE&&(this.gameControl.uiStart.active=!0)}},getTool:function(t,e){var o=null;for(var i in t.children)if(t.children[i].name==e){o=t.children[i];break}return o},updateTool:function(t,e,o,i){var n=t.getPosition();10<cc.pDistance(n,e)&&t.setPosition(e);var s=t.getComponent(cc.RigidBody);null!=o&&null!=s&&(s.linearVelocity=o),null!=i&&(t.rotation=i)},updatePlayer:function(t,e,o,i){t.getComponent(l.PLAYER_CONTROL);var n=t.parent.convertToNodeSpaceAR(e);t.setPosition(n),null!=o&&(o.linearVelocity=i)},updateOnHead:function(t,e,o,i){0<t.parent.scaleX&&0<e.x||t.parent.scaleX<0&&e.x<0||(t.setPosition(e),null!=o&&(o.linearVelocity=i),cc.log("Onhead"))},update:function(t){this.isConnect&&(this.sendTSTimer+=t,this.sendTSTimer>=this.sendTSTime&&(this.gameControl.sendTimestamp(),this.sendTSTimer=0)),0!=this.updatePlayerTime&&this.gameControl.getTimestamp()-this.updatePlayerTime>this.playerStopTime&&null!=this.gameControl.netPlayerControl&&this.gameControl.netPlayerControl.playerStop(),0!=this.updateTime&&this.gameControl.getTimestamp()-this.updateTime>this.maxDelayTime&&!this.getPlayerData&&null!=this.gameControl.localPlayerControl&&(this.gameControl.setNetNum(this.maxDelayTime),this.getPlayerData=!0,this.gameControl.localPlayerControl.updateAll())}}),cc._RF.pop()},{GlobalData:"GlobalData"}],SpikeDoor:[function(t,e,o){"use strict";cc._RF.push(e,"24f245qr5dC8bVJ8b7LQanv","SpikeDoor");t("GlobalData");cc.Class({extends:cc.Component,properties:{rotateSpeed:50,angular:180},start:function(){this.isDown=!1,this.endRotation=this.node.rotation+this.angular,this.body=this.node.getComponent(cc.RigidBody)},onBeginContact:function(t,e,o){0!=o.tag&&(this.isDown=!0)},update:function(t){this.isDown&&this.node.rotation<this.endRotation&&(this.body.angularVelocity=this.rotateSpeed)}}),cc._RF.pop()},{GlobalData:"GlobalData"}],SpikeweedControl:[function(t,e,o){"use strict";cc._RF.push(e,"33141cZUsdISb8aJkrfzcSi","SpikeweedControl");t("GlobalData");cc.Class({extends:cc.Component,properties:{isShow:!1,realObj:cc.Node,endPos:cc.Node,moveSpeed:20},onLoad:function(){this.initValues(),this.isShow&&this.realObj.setPosition(cc.v2(this.realObj.x,this.endPos.y))},initValues:function(){this.startPos=cc.v2(0,-40),this.isMove=this.isShow,this.body=this.realObj.getComponent(cc.RigidBody)},start:function(){},open:function(){this.isShow?this.isMove=!1:this.isMove=!0},close:function(){this.isShow?this.isMove=!0:this.isMove=!1},update:function(t){this.isMove?this.realObj.y<=this.endPos.y&&(this.body.linearVelocity=cc.v2(0,this.moveSpeed)):this.realObj.y>=this.startPos.y&&(this.body.linearVelocity=cc.v2(0,-this.moveSpeed))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],SprinklerControl:[function(t,e,o){"use strict";cc._RF.push(e,"6cd7erFPSND95crSeHcZmqG","SprinklerControl");var n=t("GlobalData");cc.Class({extends:cc.Component,properties:{waterNode:cc.Node,timeSpace:2},onLoad:function(){this.gameControl=cc.find(n.GAME_NAME).getComponent(n.GAME_CONTROL),this.timer=0,this.downing=!1},start:function(){},update:function(t){if(this.gameControl.fireControl.justRunning)this.timer=0;else if(this.timer+=t,this.timer>this.timeSpace&&!this.downing){this.createWater(),this.timer=0,this.downing=!0;var e=this;setTimeout(function(){e.downing=!1},.5*this.timeSpace*1e3)}},createWater:function(){var i=this;cc.loader.loadRes(n.GAME_TOOLS+"Water",function(t,e){if(t)cc.log("加载水滴出错:"+t);else{var o=cc.instantiate(e);o.setParent(i.node),o.setPosition(i.waterNode.getPosition())}})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Stairs:[function(t,e,o){"use strict";cc._RF.push(e,"a4d2c9XtzFJ/7xEFnwe0Sa7","Stairs");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{pos:cc.Node,car:cc.Node},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.carControl=this.car.getComponent(i.GRAVITYCAR_NAME)},start:function(){},update:function(t){this.node.setPosition(this.pos.getPosition())},onBeginContact:function(t,e,o){o.node.group==i.FIRE||(o.node.group,i.ICE)},onEndContact:function(t,e,o){},rotateCar:function(){this.carControl.rotateCar(this.node)}}),cc._RF.pop()},{GlobalData:"GlobalData"}],StarControl:[function(t,e,o){"use strict";cc._RF.push(e,"9ecb5umoc5M6qWe7QmIjc52","StarControl");t("PlayerControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{door:cc.Node,flyTime:.5},start:function(){},onLoad:function(){this.initValues(),this.isFirePlayer(),this.loadStarImg()},loadStarImg:function(){var o=this;this.isFire?cc.loader.loadRes(i.GAME_SPRITE+"DiamondFire",cc.SpriteFrame,function(t,e){t?cc.log(t):o.node.getComponent(cc.Sprite).spriteFrame=e}):cc.loader.loadRes(i.GAME_SPRITE+"DiamondWater",cc.SpriteFrame,function(t,e){t?cc.log(t):o.node.getComponent(cc.Sprite).spriteFrame=e})},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.doorControl=this.door.getComponent(i.TOTALDOOR_CONTROL),this.player=null,this.createStarAnimNode()},createStarAnimNode:function(){var n=this;cc.loader.loadRes(i.GAME_TOOLS+i.StarAnim,function(t,e){if(t)cc.log("加载星星动画出错:"+t);else{var o=cc.instantiate(e);o.setParent(n.node.parent);var i=n.node.parent.getChildByName("StaicStar");o.setPosition(i.x-60,i.y-20),n.starAnim=o.getComponent(cc.Animation)}})},onBeginContact:function(t,e,o){this.player!=o.node&&(this.gameControl.isSingle?this.isFire&&(this.gameControl.ContainsWords("Fire",o.node.name)||o.node.group==i.FIRE)?this.eatGold(o.node):this.isFire||!this.gameControl.ContainsWords("Ice",o.node.name)&&o.node.group!=i.ICE||this.eatGold(o.node):this.isFire&&(this.gameControl.ContainsWords("Fire",o.node.name)||o.node.group==i.FIRE)&&this.gameControl.playerType==this.gameControl.fireControl.playerType?(this.eatGold(o.node),this.sendEatGoldData()):this.isFire||!this.gameControl.ContainsWords("Ice",o.node.name)&&o.node.group!=i.ICE||this.gameControl.playerType!=this.gameControl.iceControl.playerType||(this.eatGold(o.node),this.sendEatGoldData()))},setKey:function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.o:e.eatGold(e.gameControl.fireBall),e.sendEatGoldData()}})},eatGold:function(t){this.gameControl.musicControl.playGold(),this.player=t;var e=this;if(this.isFire){var o=cc.moveTo(this.flyTime,this.doorControl.fireStar.getPosition());this.node.runAction(cc.sequence(o,cc.callFunc(function(){e.starAnim.play(),e.doorControl.eatStar()})))}else{o=cc.moveTo(this.flyTime,this.doorControl.iceStar.getPosition());this.node.runAction(cc.sequence(o,cc.callFunc(function(){e.starAnim.play(),e.doorControl.eatStar()})))}},netToEatGold:function(t){if(0==t.playerType){this.doorControl.eatStar();var e=cc.moveTo(this.flyTime,this.doorControl.fireStar.getPosition());this.node.runAction(e)}else{this.doorControl.eatStar();e=cc.moveTo(this.flyTime,this.doorControl.iceStar.getPosition());this.node.runAction(e)}},sendEatGoldData:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,i.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(i.NET_EATSTAR+","+this.gameControl.playerType)})},update:function(){},isFirePlayer:function(){this.isFire=this.gameControl.ContainsWords("Fire",this.node.name),0!=this.gameControl.playerType||this.isFire?1==this.gameControl.playerType&&this.isFire&&(this.gameControl.starControl=this):this.gameControl.starControl=this}}),cc._RF.pop()},{GlobalData:"GlobalData",PlayerControl:"PlayerControl"}],StickControl:[function(t,e,o){"use strict";cc._RF.push(e,"29a25jNoExJ5Y/L6fvcbC/V","StickControl");var s=t("GlobalData");cc.Class({extends:cc.Component,properties:{angleTime:.2,isOpen:!1,mechanisms:{default:[],type:cc.Node}},start:function(){},onLoad:function(){this.initValues()},initValues:function(){this.gameControl=cc.find(s.GAME_NAME).getComponent(s.GAME_CONTROL),this.isRotating=!1,this.oIndex=0,this.cIndex=0,this.mControl=new Array,this.whichMechanism()},whichMechanism:function(){var t=0;switch(this.gameControl.ContainsWords(s.PLATFORM,this.mechanisms[0].name)&&(t=0),t){case 0:for(var e in this.mechanisms)this.mControl[e]=this.mechanisms[e].getComponent(s.PLATFORM_CONTROL);break;default:cc.log("未找到该机关！！！")}},onBeginContact:function(t,e,o){},onPreSolve:function(t,e,o){var i=o.node.group;if(i==s.FIRE||i==s.ICE){var n=o.node.getComponent(s.PLAYER_CONTROL).body;50<n.linearVelocity.x&&this.node.rotation<=45?(this.node.getComponent(cc.RigidBody).angularVelocity=450,this.cIndex=0):45<this.node.rotation&&0==this.oIndex?(this.oIndex++,this.isOpen?this.close():this.open()):n.linearVelocity.x<-50&&-45<=this.node.rotation?(this.node.getComponent(cc.RigidBody).angularVelocity=-450,this.oIndex=0):this.node.rotation<-45&&0==this.cIndex&&(this.cIndex++,this.isOpen?this.open():this.close())}},open:function(){for(var t in this.mControl)this.mControl[t].open(this.node)},close:function(){for(var t in this.mControl)this.mControl[t].close()}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Stone:[function(t,e,o){"use strict";cc._RF.push(e,"6a0e1bWoX9DK7FYGRA9fYps","Stone");var c=t("GlobalData");cc.Class({extends:cc.Component,properties:{stoneType:0},onLoad:function(){this.isThrowOut=!1,this.initValues()},initValues:function(){this.gameControl=cc.find(c.GAME_NAME).getComponent(c.GAME_CONTROL),this.body=this.node.getComponent(cc.RigidBody),this.body.enabledContactListener=!0,this.body.bullet=!0,this.playerPrefab=null,this.stoneCarSpace=null,this.carPrefab=null,this.isDrag=!1},start:function(){},dragByPlayer:function(){this.isDrag=!0},stopDrag:function(){this.isDrag=!1},onBeginContact:function(t,e,o){this.gameControl.ContainsWords(c.STONE,o.node.name)&&(o.node.getComponent(c.STONE).stoneType=this.stoneType),this.gameControl.ContainsWords(c.BALL,o.node.name)&&(this.playerPrefab=o.node)},onPreSolve:function(t,e,o){if(this.gameControl.ContainsWords(c.BIGCAR,o.node.name)&&this.node.convertToWorldSpaceAR(cc.v2(0,0)).y>o.node.convertToWorldSpaceAR(cc.v2(0,0)).y){var i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),n=o.node.convertToWorldSpaceAR(cc.v2(0,0));null===this.stoneCarSpace&&(this.stoneCarSpace=i.x-n.x),this.carPrefab=o.node}},onEndContact:function(t,e,o){},sendStoneData:function(){0===this.body.linearVelocity.x&&this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,c.NET_11010,{processData:this.gameControl.stringToBytes(c.NETTAG_STONE+","+this.stoneType+","+this.node.x+","+this.node.y+","+this.body.linearVelocity.x+","+this.body.linearVelocity.y+","+this.node.name+","+this.node.rotation)})},update:function(t){if(null!==this.stoneCarSpace){if(null!==this.playerPrefab){var e=this.playerPrefab.getComponent(c.PLAYER_CONTROL),o=cc.pDistance(cc.v2(this.playerPrefab.convertToWorldSpaceAR(cc.v2(0,0))),cc.v2(this.node.convertToWorldSpaceAR(cc.v2(0,0)))),i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),n=e.node.convertToWorldSpaceAR(cc.v2(0,0));if((e.left&&n.x>i.x&&n.y<i.y||e.right&&n.x<i.x&&n.y<i.y)&&o<100||this.isDrag)return void(this.stoneCarSpace=null)}if(.05<Math.abs(1-Math.abs(this.node.rotation/90)))return;if(!this.isDrag){var s=this.carPrefab.convertToWorldSpaceAR(cc.v2(0,0)),a=this.node.parent.convertToNodeSpaceAR(cc.v2(s.x+this.stoneCarSpace,0));this.node.setPosition(a.x,this.node.y),this.stoneCarSpace=null}}}}),cc._RF.pop()},{GlobalData:"GlobalData"}],TotalDoorControl:[function(t,e,o){"use strict";cc._RF.push(e,"83911gu9btDDJ7IqVU5vRge","TotalDoorControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{waitTime:2,door:cc.Node,doorEndPos:cc.Node,doorUpSpeed:50,fireNode:cc.Node,iceNode:cc.Node,fireStar:cc.Node,iceStar:cc.Node},start:function(){},onLoad:function(){this.initValues()},initValues:function(){this.waitTime=.5,this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.node.name="Door"+this.gameControl.cLevelIndex,this.gameControl.passDoor=this,cc.log(this.gameControl.passDoor.node.name),this.timer=0,this.startTime=!1,this.doorBody=this.door.getComponent(cc.RigidBody),this.quick=!1,this.doorStartPos=this.door.getPosition(),this.canPass=!1,this.isOpen=!1,this.rising=!1,this.downing=!1,this.fireBody=null,this.iceBody=null,this.enterCount=0,this.starCount=0,this.nPass=!1,this.nTimer=0,this.isSend=!1,this.quickPass()},onBeginContact:function(t,e,o){e.tag==i.PASSDOOR_TAG&&(o.node.group==i.FIRE&&this.fireBody!=o.node?(this.enterCount++,this.fireBody=o.node):o.node.group==i.ICE&&this.iceBody!=o.node&&(this.enterCount++,this.iceBody=o.node))},onEndContact:function(t,e,o){e.tag==i.PASSDOOR_TAG&&(o.node.group==i.FIRE&&null!=this.fireBody?(this.fireBody=null,this.playerLeave(this.gameControl.fire,o.node)):o.node.group==i.ICE&&null!=this.iceBody&&(this.iceBody=null,this.playerLeave(this.gameControl.ice,o.node)))},playerLeave:function(t,e){this.enterCount--},riseDoor:function(){if(this.doorBody.linearVelocity=cc.v2(0,this.doorUpSpeed),this.door.y>=this.doorEndPos.y){this.door.setPosition(this.door.x,this.doorEndPos.y),this.rising=!1;var t=this.door.getComponent(cc.PhysicsBoxCollider);t.sensor=!0,t.apply()}},downDoor:function(){this.doorBody.linearVelocity=cc.v2(0,-this.doorUpSpeed),this.door.y<=this.doorStartPos.y&&(this.door.setPosition(this.door.x,this.doorStartPos.y),this.downing=!1)},update:function(t){this.rising?this.riseDoor():this.downing&&this.downDoor(),2<=this.enterCount&&this.canPass?this.startTime=!0:(this.startTime=!1,this.timer=0),this.startTime&&(this.timer+=t),(this.timer>=this.waitTime||this.quick)&&(this.gameControl.isSingle?this.gameControl.loadNextLevel():0==this.gameControl.playerType&&(this.isSend||(this.gameControl.sendPass(),this.isSend=!0,cc.log("发送通关"+this.node.name))),this.timer=0,this.startTime=!1,this.quick=!1)},eatStar:function(){this.starCount++,2<=this.starCount&&(this.canPass=!0,this.rising=!0)},playerIsEnterDoor:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0)).x,e=Math.abs(this.gameControl.fireBall.convertToWorldSpaceAR(cc.v2(0,0)).x-t),o=Math.abs(this.gameControl.iceBall.convertToWorldSpaceAR(cc.v2(0,0)).x-t);return e<50&&o<50},quickPass:function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.p:e.quick=!0}})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],TotalPressControl:[function(t,e,o){"use strict";cc._RF.push(e,"8d9aba5rAFCD7qIz89c1OZw","TotalPressControl"),cc.Class({extends:cc.Component,properties:{tBtn:cc.Node,bBtn:cc.Node},start:function(){},onLoad:function(){this.tControl=this.tBtn.getComponent("PressBtn"),this.bControl=this.bBtn.getComponent("PressBtn")},update:function(t){this.tControl.press&&(this.tControl.anOtherPress=!0),this.bControl.press&&(this.bControl.anOtherPress=!0),this.tControl.press||(this.bControl.anOtherPress=!1),this.bControl.press||(this.tControl.anOtherPress=!1)}}),cc._RF.pop()},{}],UIFaceToFace:[function(t,e,o){"use strict";cc._RF.push(e,"3928eMVLrZLU4zFmnd+R3vJ","UIFaceToFace");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{enterNumLists:{type:cc.Label,default:[]},btnParent:cc.Node,resetBtn:cc.Node,delBtn:cc.Node,createRoomBtn:cc.Node,joinRoomBtn:cc.Node,closeBtn:cc.Node,tips:cc.Label},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.initValues(),this.initBtn()},onEnable:function(){this.tips.node.active=!1,this.resetNum()},initValues:function(){this.oString=Math.random(0,100001)},initBtn:function(){var t=this;this.resetBtn.on(cc.Node.EventType.TOUCH_START,function(){t.resetNum(),t.gameControl.showBtnLight(t.resetBtn)}),this.resetBtn.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.resetBtn)}),this.resetBtn.on(cc.Node.EventType.TOUCH_MOVE,function(){t.gameControl.hideBtnLight(t.resetBtn)}),this.delBtn.on(cc.Node.EventType.TOUCH_START,function(){t.delLastNum(),t.gameControl.showBtnLight(t.delBtn)}),this.delBtn.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.delBtn)}),this.delBtn.on(cc.Node.EventType.TOUCH_MOVE,function(){t.gameControl.hideBtnLight(t.delBtn)}),this.createRoomBtn.on(cc.Node.EventType.TOUCH_START,function(){t.playMatching(),t.gameControl.showBtnLight(t.createRoomBtn),t.showTips("正在等待朋友加入...")}),this.createRoomBtn.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.createRoomBtn)}),this.createRoomBtn.on(cc.Node.EventType.TOUCH_MOVE,function(){t.gameControl.hideBtnLight(t.createRoomBtn)}),this.joinRoomBtn.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.showBtnLight(t.joinRoomBtn),t.showTips("正在加入..."),setTimeout(function(){t.joinMatching()},500)}),this.joinRoomBtn.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.joinRoomBtn)}),this.joinRoomBtn.on(cc.Node.EventType.TOUCH_MOVE,function(){t.gameControl.hideBtnLight(t.joinRoomBtn)}),this.closeBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1})},showTips:function(t){this.tips.node.active=!0,this.tips.string=t},resetNum:function(){for(var t in this.enterNumLists)this.enterNumLists[t].string=""},delLastNum:function(){for(var t=this.enterNumLists.length-1;0<=t;t--)if(""!==this.enterNumLists[t].string){this.enterNumLists[t].string="";break}},pushNum:function(t){for(var e in this.enterNumLists)if(""===this.enterNumLists[e].string)return void(this.enterNumLists[e].string=t)},start:function(){},connectSocket:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.root,1e4,{openId:""+this.oString,sign:""+Math.random(0,10001),timestamp:Math.random(0,10001),appId:Math.random(0,10001),params:"Hello world"}),cc.log("发送！！")},playMatching:function(){this.connectSocket();var t="";for(var e in this.enterNumLists)t+=this.enterNumLists[e].string;this.gameControl.socketManager.sendData(this.gameControl.socketManager.root,10001,{gameMode:2,matchType:1,matchId:t}),this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,11002,{})},joinMatching:function(){this.connectSocket();var t="";for(var e in this.enterNumLists)t+=this.enterNumLists[e].string;this.gameControl.socketManager.sendData(this.gameControl.socketManager.root,10001,{gameMode:2,matchType:1,matchId:t}),this.gameControl.playerType=1,this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,11002,{})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UIPass:[function(t,e,o){"use strict";cc._RF.push(e,"5bbcbqwcThDa7DChB7vu4HG","UIPass");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{mainMenuBtn:cc.Node,nextBtn:cc.Node,starList:{default:[],type:cc.Node}},start:function(){},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.initBtn(),this.initValues()},onEnable:function(){},initValues:function(){},initBtn:function(){var t=this;t.mainMenuBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1,t.gameControl.backMainPanel()}),t.nextBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1,t.gameControl.wantPlayAgain()})},update:function(t){}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"4bd916C2BVAkbiU3fVTQ2sB","UIPause");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{closeBtn:cc.Node,mainMenuBtn:cc.Node,restartBtn:cc.Node,fireDiamond:cc.Label,iceDiamond:cc.Label,title:cc.Label,musicBtn:cc.Node,bgmBtn:cc.Node,voiceBtn:cc.Node,btnMoveTime:.2},start:function(){},initValues:function(){this.bgmBtnImg=this.bgmBtn.getChildByName(i.OPEN_BTN),this.bgmOpenBg=this.bgmBtn.getChildByName(i.OPEN_BG).getComponent(cc.Sprite),this.bgmBtnStartPos=this.bgmBtnImg.getPosition(),this.bgmBtnEndPos=this.bgmBtn.getChildByName(i.BTN_END_POS).getPosition(),this.voiceBtnImg=this.voiceBtn.getChildByName(i.OPEN_BTN),this.voiceOpenBg=this.voiceBtn.getChildByName(i.OPEN_BG).getComponent(cc.Sprite),this.voiceBtnStartPos=this.voiceBtnImg.getPosition(),this.voiceBtnEndPos=this.voiceBtn.getChildByName(i.BTN_END_POS).getPosition()},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.initValues(),this.initMusicPanel(),this.initBtn(),this.initMusicBtn()},initMusicPanel:function(){this.gameControl.musicControl.isMute()||(this.changeTxt(this.voiceBtn,!0),this.voiceBtnImg.setPosition(this.voiceBtnEndPos),this.voiceBtn.getChildByName(i.OPEN_BG).getComponent(cc.Sprite).fillRange=1),this.gameControl.musicControl.isBgmMute()||(this.changeTxt(this.bgmBtn,!0),this.bgmBtnImg.setPosition(this.bgmBtnEndPos),this.bgmBtn.getChildByName(i.OPEN_BG).getComponent(cc.Sprite).fillRange=1)},onEnable:function(){this.title.string="菜单",this.fireDiamond.string=this.gameControl.fireCount,this.iceDiamond.string=this.gameControl.iceCount,this.updateMusicText()},initBtn:function(){var t=this;t.closeBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1,t.gameControl.backGameTools()}),t.mainMenuBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1,t.gameControl.backMainPanel()}),t.restartBtn.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.restartGame(),t.gameControl.sendRestart()}),t.bgmBtn.on(cc.Node.EventType.TOUCH_START,function(){t.changeBgm()}),t.voiceBtn.on(cc.Node.EventType.TOUCH_START,function(){t.changeVoice()})},initMusicBtn:function(){var t=this;this.musicText=this.musicBtn.getChildByName("Label").getComponent(cc.Label),this.updateMusicText(),this.musicBtn.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.musicControl.setMute(),t.updateMusicText()})},updateMusicText:function(){this.gameControl.musicControl.isMute()?this.musicText.string="打开音乐":this.musicText.string="关闭音乐"},changeBgm:function(){this.gameControl.musicControl.setBgmMute();var t=null;this.gameControl.musicControl.isBgmMute()?(this.changeTxt(this.bgmBtn,!1),t=cc.moveTo(this.btnMoveTime,this.bgmBtnStartPos)):(this.changeTxt(this.bgmBtn,!0),t=cc.moveTo(this.btnMoveTime,this.bgmBtnEndPos)),this.bgmBtnImg.runAction(t)},changeTxt:function(t,e){e?(t.getChildByName("On").active=!0,t.getChildByName("Off").active=!1):(t.getChildByName("On").active=!1,t.getChildByName("Off").active=!0)},changeVoice:function(){this.gameControl.musicControl.setMute();var t=null,e=null;this.gameControl.musicControl.isMute()?(e=this.voiceBtnStartPos,this.changeTxt(this.voiceBtn,!1)):(e=this.voiceBtnEndPos,this.changeTxt(this.voiceBtn,!0)),t=cc.moveTo(this.btnMoveTime,e),this.voiceBtnImg.runAction(t)},update:function(t){var e;if(this.gameControl.musicControl.isBgmMute()&&0!==this.bgmOpenBg.fillRange)(e=.7)<(o=1-Math.abs((this.bgmBtnImg.x-this.bgmBtnEndPos.x)/(this.bgmBtnStartPos.x-this.bgmBtnEndPos.x)))&&(o=e),this.bgmOpenBg.fillRange=o;else if(!this.gameControl.musicControl.isBgmMute()&&1!==this.bgmOpenBg.fillRange){(o=Math.abs((this.bgmBtnImg.x-this.bgmBtnStartPos.x)/(this.bgmBtnStartPos.x-this.bgmBtnEndPos.x)))<(i=.3)&&(o=i),this.bgmOpenBg.fillRange=o}if(this.gameControl.musicControl.isMute()&&0!==this.voiceOpenBg.fillRange)(e=.7)<(o=1-Math.abs((this.voiceBtnImg.x-this.voiceBtnEndPos.x)/(this.voiceBtnStartPos.x-this.voiceBtnEndPos.x)))&&(o=e),this.voiceOpenBg.fillRange=o;else if(!this.gameControl.musicControl.isMute()&&1!==this.voiceOpenBg.fillRange){var o,i;(o=Math.abs((this.voiceBtnImg.x-this.voiceBtnStartPos.x)/(this.voiceBtnStartPos.x-this.voiceBtnEndPos.x)))<(i=.3)&&(o=i),this.voiceOpenBg.fillRange=o}}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UISelect:[function(t,e,o){"use strict";cc._RF.push(e,"12a43bwl0lEW5/4F2vw5/ot","UISelect");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{levelBtns:{default:[],type:cc.Node},musicBtn:cc.Node,levelText:cc.Node,goBtn:cc.Node},start:function(){},onLoad:function(){this.initValues()},onEnable:function(){this.updateMusicImg(),this.gameControl.isInGame=!1},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.gameControl.uiSelect=this.node,this.gameControl.uiDic[this.node.name]=this.node,this.initLevelBtn(),this.initMusicBtn(),this.initBtn()},initBtn:function(){var o=this;this.goBtn.on(cc.Node.EventType.TOUCH_START,function(){var t=o.levelText.getComponent(cc.EditBox).string,e=parseInt(t);o.gameControl.loadLevel(e)})},initMusicBtn:function(){var t=this;this.updateMusicImg(),t.musicBtn.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.musicControl.setMute(),t.updateMusicImg()})},updateMusicImg:function(){var o=this;o.musicImg=o.musicBtn.getChildByName("Bg").getChildByName("Img").getComponent(cc.Sprite),o.gameControl.musicControl.isMute()?cc.loader.loadRes("UI/UIVoice2",cc.SpriteFrame,function(t,e){t?cc.log("音乐图片加载错误："+t):o.musicImg.spriteFrame=e}):cc.loader.loadRes("UI/UIVoice1",cc.SpriteFrame,function(t,e){t?cc.log("音乐图片加载错误："+t):o.musicImg.spriteFrame=e})},initLevelBtn:function(){for(var t=this.node.getChildByName("LevelContent"),e=t.getChildrenCount(),o=1;o<e+1;o++){t.getChildByName("Level"+o).addComponent(i.LEVEL_BTN).setIndex(o)}}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UIStart:[function(t,e,o){"use strict";cc._RF.push(e,"9485bwD41NLAqfiyOpURaSi","UIStart");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{createBtn:cc.Node,reConnectBtn:cc.Node,animNode:cc.Node,iceAnimNode:cc.Node,showAnotherAnimRange:.3,showAnotherAnimSpace:4,openFacePanelBtn:cc.Node,facePanel:cc.Node},start:function(){},onLoad:function(){this.initValues()},onEnable:function(){null!==this.gameControl.socketManager.mBufSocket&&(this.gameControl.socketManager.mBufSocket.close(),this.gameControl.socketManager.setSocketListener()),this.gameControl.savePlayerPrefab(),this.facePanel.active=!1,this.gameControl.netNum.active=!1},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.anim=this.animNode.getComponent(dragonBones.ArmatureDisplay),this.ianim=this.iceAnimNode.getComponent(dragonBones.ArmatureDisplay),this.playPlayerAnim(),this.reSendTimer=0,this.reSendTime=3,this.oString=Math.random(0,100001);var t=this;t.createBtn.on(cc.Node.EventType.TOUCH_START,function(){t.playSingle()}),t.reConnectBtn.on(cc.Node.EventType.TOUCH_START,function(){t.connectSocket()}),t.openFacePanelBtn.on(cc.Node.EventType.TOUCH_START,function(){t.facePanel.active=!0,t.gameControl.showBtnLight(t.openFacePanelBtn)}),t.openFacePanelBtn.on(cc.Node.EventType.TOUCH_END,function(){t.gameControl.hideBtnLight(t.openFacePanelBtn)})},playPlayerAnim:function(){var t=this,e=Math.random(),o=1;e>1-this.showAnotherAnimRange&&(o=2),null!==this.anim&&("stand_2"!=this.anim.animationName?this.anim.playAnimation("stand_"+o,1):this.anim.playAnimation("stand_1",1)),(e=Math.random())>1-this.showAnotherAnimRange&&(o=2),null!==this.ianim&&("stand_2"!=this.ianim.animationName?this.ianim.playAnimation("stand_"+o,1):this.ianim.playAnimation("stand_1",1)),setTimeout(function(){t.playPlayerAnim()},1e3*t.showAnotherAnimSpace)},playSingle:function(){this.gameControl.isSingle=!0,this.gameControl.loadUI(i.UI_SELECT_NAME),this.node.active=!1},connectSocket:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.root,1e4,{openId:""+this.oString,sign:""+Math.random(0,10001),timestamp:Math.random(0,10001),appId:Math.random(0,10001),params:"Hello world"}),cc.log("发送！！")},update:function(t){this.gameControl.socketManager.isConnect?this.startToConnect():this.gameControl.socketManager.socketIsClosed&&(this.reSendTimer+=t,this.reSendTimer>this.reSendTime&&(this.reSendTimer=0,this.gameControl.socketManager.setSocketListener(),cc.log("断线重连！！")))},startToConnect:function(){this.gameControl.socketManager.toConnect&&(this.connectSocket(),this.gameControl.socketManager.toConnect=!1,cc.log("开始连接服务端"))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UITools:[function(t,e,o){"use strict";cc._RF.push(e,"1b13dbdHT1MPJy4ea3DBUZF","UITools");var r=t("GlobalData");cc.Class({extends:cc.Component,properties:{btnAnimTime:.1,leftBtn:cc.Node,rightBtn:cc.Node,upBtn:cc.Node,catchBtn:cc.Node,switchBtn:cc.Node,highFrameRate:cc.Node,playerFire:cc.Node,playerWater:cc.Node,game:cc.Node,pauseBtn:cc.Node,gameTimeTxt:cc.Label,fdCount:cc.Label,idCount:cc.Label,bar:cc.Sprite,starList:{default:[],type:cc.Node}},start:function(){},onLoad:function(){this.initValues(),this.initBtn()},onEnable:function(){this.updateState()},btnClickAnim:function(t){return cc.scaleTo(this.btnAnimTime,t.scaleX+.2,t.scaleY+.2)},updateState:function(){1==this.gameControl.playerType?(this.changePlayerImg(),this.gameControl.netPlayerControl=this.gameControl.fireControl,this.gameControl.localPlayerControl=this.gameControl.iceControl):(this.gameControl.netPlayerControl=this.gameControl.iceControl,this.gameControl.localPlayerControl=this.gameControl.fireControl)},initValues:function(){this.game=cc.find(r.GAME_NAME),this.gameControl=this.game.getComponent(r.GAME_CONTROL),(this.gameControl.uc=this).fdCount.string="X0",this.idCount.string="X0",this.gameControl.isSingle&&(this.switchBtn.active=!0)},initBtn:function(){this.fireControl=this.gameControl.fireBall.getComponent("PlayerControl"),this.iceControl=this.gameControl.iceBall.getComponent("PlayerControl");var t=this;t.leftBtn.on(cc.Node.EventType.TOUCH_START,function(){t.leftBtnDown()}),t.leftBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.leftBtnUp()}),t.leftBtn.on(cc.Node.EventType.TOUCH_END,function(){t.leftBtnUp()}),t.rightBtn.on(cc.Node.EventType.TOUCH_START,function(){t.rightBtnDown()}),t.rightBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.rightBtnUp()}),t.rightBtn.on(cc.Node.EventType.TOUCH_END,function(){t.rightBtnUp()}),t.upBtn.on(cc.Node.EventType.TOUCH_START,function(){t.jumpBtnDown()}),t.upBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.jumpBtnUp()}),t.upBtn.on(cc.Node.EventType.TOUCH_END,function(){t.jumpBtnUp()}),t.catchBtn.on(cc.Node.EventType.TOUCH_START,function(){t.catchBtnDown()}),t.catchBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.catchBtnUp()}),t.catchBtn.on(cc.Node.EventType.TOUCH_END,function(){t.catchBtnUp()}),t.switchBtn.on(cc.Node.EventType.TOUCH_START,function(){t.switchPlayer()}),t.pauseBtn.on(cc.Node.EventType.TOUCH_START,function(){t.pauseBtnDown()}),t.pauseBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.pauseBtnUp()}),t.pauseBtn.on(cc.Node.EventType.TOUCH_END,function(){t.pauseBtnUp()}),t.highFrameRate.on(cc.Node.EventType.TOUCH_START,function(){t.changeFrameRate()})},leftBtnDown:function(){0===this.gameControl.playerType?this.fireControl.leftClick():this.iceControl.leftClick(),this.btnClickImg(this.leftBtn)},leftBtnUp:function(){this.fireControl.leftExit(),this.iceControl.leftExit(),this.btnUpImg(this.leftBtn)},rightBtnDown:function(){0===this.gameControl.playerType?this.fireControl.rightClick():this.iceControl.rightClick(),this.btnClickImg(this.rightBtn)},rightBtnUp:function(){this.fireControl.rightExit(),this.iceControl.rightExit(),this.btnUpImg(this.rightBtn)},catchBtnDown:function(){this.btnClickImg(this.catchBtn),this.catchSomething(this.gameControl.playerType,!0)},catchBtnUp:function(){this.btnUpImg(this.catchBtn)},jumpBtnDown:function(){0===this.gameControl.playerType?this.fireControl.upClick():this.iceControl.upClick(),this.btnClickImg(this.upBtn)},jumpBtnUp:function(){this.btnUpImg(this.upBtn)},pauseBtnDown:function(){this.gameControl.loadUI(r.UI_PAUSE_NAME),this.btnClickImg(this.pauseBtn)},pauseBtnUp:function(){this.btnUpImg(this.pauseBtn)},btnClickImg:function(o){var t=o.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame.name.split("-");cc.loader.loadRes(r.UI_PATH+t[0]+"-Click",cc.SpriteFrame,function(t,e){t?cc.log("加载图片出错"):(o.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame=e,o.getChildByName(r.LIGHT).active=!0)})},btnUpImg:function(o){var t=o.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame.name.split("-");cc.loader.loadRes(r.UI_PATH+t[0]+"-Normal",cc.SpriteFrame,function(t,e){t?cc.log("加载图片出错"):(o.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame=e,o.getChildByName(r.LIGHT).active=!1)})},changeCatchImg:function(t){var e="MThrowImg-Normal";t&&(e="MDragImg-Normal");var o=this;cc.loader.loadRes(r.UI_PATH+e,cc.SpriteFrame,function(t,e){t?cc.log(t):o.catchBtn.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame=e})},changeFrameRate:function(){this.gameControl.setFrameRate(60)},switchPlayer:function(){this.gameControl.changeControlPlayer(),this.changePlayerImg()},changePlayerImg:function(){var o=this.switchBtn.getChildByName("BtnFire"),i=this.switchBtn.getChildByName("BtnIce"),n=cc.v2(.9,.9),s=cc.v2(1.1,1.1);1==this.gameControl.playerType?(cc.loader.loadRes("UI/UIWaterBtn",cc.SpriteFrame,function(t,e){t?cc.log(t):(i.getComponent(cc.Sprite).spriteFrame=e,i.setScale(s))}),cc.loader.loadRes("UI/UIFireBtnBg",cc.SpriteFrame,function(t,e){t?cc.log(t):(o.getComponent(cc.Sprite).spriteFrame=e,o.setScale(n))})):(cc.loader.loadRes("UI/UIFireBtn",cc.SpriteFrame,function(t,e){t?cc.log(t):(o.getComponent(cc.Sprite).spriteFrame=e,o.setScale(s))}),cc.loader.loadRes("UI/UIWaterBtnBg",cc.SpriteFrame,function(t,e){t?cc.log(t):(i.getComponent(cc.Sprite).spriteFrame=e,i.setScale(n))})),this.fireControl.setArrow(this.gameControl.playerType),this.iceControl.setArrow(this.gameControl.playerType)},catchSomething:function(t,e){var o=this;if(0==t){if(o.fireControl.isEnterBallSpawn&&!o.fireControl.isputUp)return void o.addBallToPlayer(o.fireControl);if(o.playerCatchOrDrag(o.fireControl),e){var i=0,n="";null==(s=null)?(s=o.gameControl.fireControl.dragBox,i=r.DRAG_TAG):(s=o.gameControl.fireControl.catchBox,i=r.CATCH_TAG),null!=s&&(n=s.name),o.sendDragData(t,s,o.gameControl.fireControl.node,n,i)}}else{if(o.iceControl.isEnterBallSpawn&&!o.iceControl.isputUp)return void o.addBallToPlayer(o.iceControl);if(o.playerCatchOrDrag(o.iceControl),e){var s;i=0,n="";null==(s=null)?(s=o.gameControl.iceControl.dragBox,i=r.DRAG_TAG):(s=o.gameControl.iceControl.catchBox,i=r.CATCH_TAG),null!=s&&(n=s.name),o.sendDragData(t,s,o.gameControl.iceControl.node,n,i)}}},sendDragData:function(t,e,o,i,n){var s=cc.v2(1e5,0),a=cc.v2(0,0),c=this;null!=e&&(s=e.convertToWorldSpaceAR(cc.v2(0,0)),a=o.convertToWorldSpaceAR(cc.v2(0,0))),Math.abs(s.x-a.x)>o.getComponent(r.PLAYER_CONTROL).catchSpace&&(i=""),""===i?cc.loader.loadRes(r.UI_PATH+"MThrowImg-Click",cc.SpriteFrame,function(t,e){t?cc.log("加载图片出错"):c.catchBtn.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame=e}):cc.loader.loadRes(r.UI_PATH+"MDragImg-Click",cc.SpriteFrame,function(t,e){t?cc.log("加载图片出错"):c.catchBtn.getChildByName(r.BTN_IMG).getComponent(cc.Sprite).spriteFrame=e}),c.gameControl.socketManager.sendData(c.gameControl.socketManager.rootp11,r.NET_11010,{processData:c.gameControl.stringToBytes(t+","+r.NET_DRAG_CATCH+","+c.node.x+","+c.node.y+","+i+","+n)})},addBallToPlayer:function(n){var s=this;n.canCatch=!0,cc.loader.loadRes(r.GAME_TOOLS+r.STONE,function(t,e){if(t)cc.log("加载石头堆出错:"+t);else{var o=null;for(var i in s.gameControl.stoneList)if(null==s.gameControl.stoneList[i]){o=cc.instantiate(e),s.gameControl.stoneList[i]=o;break}if(null==o)o=cc.instantiate(e),s.gameControl.stoneList[0].destroy(),s.gameControl.stoneList.splice(0,1),s.gameControl.stoneList.push(o);n.catchScale=o.scale,s.playerCatchOrDrag(n,o)}})},playerCatchOrDrag:function(t,e){null!=e&&(t.catchBox=e),t.canCatch&&null!=t.catchBox?t.isputUp?t.throwOut():t.putUp():t.canDrag&&null!=t.dragBox&&(t.isDrag?t.stopDrag():t.dragMove())},changeDiamond:function(){for(var t in this.starList)this.starList[t].active=!1;this.fdCount.string="X"+this.gameControl.fireCount,this.idCount.string="X"+this.gameControl.iceCount;var e=parseInt(this.gameControl.fireCount+this.gameControl.iceCount),o=1,i=1,n=0;for(var t in this.gameControl.starRank){if(e<this.gameControl.starRank[t]){i=this.gameControl.starRank[t],o=t;break}this.starList[n].active=!0,n++}var s=e/((3-o)*i);this.bar.fillRange=s},update:function(t){this.gameTimeTxt.string=this.gameControl.gameTime()}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UITop:[function(t,e,o){"use strict";cc._RF.push(e,"3590dWGUNFFYJ6wwS3sTG8+","UITop");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{gold:cc.Label,addGoldBtn:cc.Node},start:function(){},onLoad:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),(this.gameControl.uiTopControl=this).gameControl.changeGold(0)},showGold:function(t){this.gold.string=t},setBtn:function(){this.addGoldBtn.on(cc.Node.EventType.TOUCH_START,function(){})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UiDead:[function(t,e,o){"use strict";cc._RF.push(e,"02bc2Lr6ahE5Y3Bgzg4SGce","UiDead");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{mainMenuBtn:cc.Node,restarBtn:cc.Node,fireAnimNode:cc.Node,iceAnimNode:cc.Node},start:function(){},onLoad:function(){this.initBtn(),this.initAnim()},onEnable:function(){this.playDeadAnim()},playDeadAnim:function(){this.fireAnimNode.active=!1,this.iceAnimNode.active=!1,null!=this.gameControl.fireControl&&this.gameControl.fireControl.isDead?(this.fireAnimNode.active=!0,this.fireAnim.playAnimation("die_2",1)):(this.iceAnimNode.active=!0,this.iceAnim.playAnimation("die_2",1))},initAnim:function(){this.fireAnim=this.fireAnimNode.getComponent(dragonBones.ArmatureDisplay),this.iceAnim=this.iceAnimNode.getComponent(dragonBones.ArmatureDisplay)},initBtn:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.goldCount=0;var t=this;t.mainMenuBtn.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1,t.gameControl.backMainPanel()}),t.restarBtn.on(cc.Node.EventType.TOUCH_START,function(){t.gameControl.restartGame(),t.gameControl.sendRestart()})}}),cc._RF.pop()},{GlobalData:"GlobalData"}],UniDoorControl:[function(t,e,o){"use strict";cc._RF.push(e,"a106bLAQKlJW7JTj2wd6Mgs","UniDoorControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{isLeft:!0,downSpeed:0,accDs:0,gear:cc.Node},onLoad:function(){this.initValues()},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.startRotation=this.node.rotation,this.leftEndPos=this.node.rotation-90,this.rightEndPos=this.node.rotation+90,this.down=!1,this.cDownSpeed=this.downSpeed,this.body=this.node.getComponent(cc.RigidBody),this.gearBody=this.gear.getComponent(cc.RigidBody),this.stringAnim=this.node.parent.getChildByName("String").getComponent(dragonBones.ArmatureDisplay)},start:function(){},onBeginContact:function(t,e,o){o.node.group!=i.FIRE&&o.node.group!=i.ICE||this.down||(this.pushDoor(o.node),this.node.group=i.GROUND),o.node.group==i.WEAPON&&this.node.destroy()},pushDoor:function(t){if(!this.down){var e=t.getComponent(i.PLAYER_CONTROL);t.convertToWorldSpaceAR(cc.v2(0,0)),this.node.convertToWorldSpaceAR(cc.v2(0,0));this.isLeft?e.body.linearVelocity.x<0&&(this.sendPushDoor(),this.playStringAnim(),this.down=!0,this.cDownSpeed=-this.downSpeed,this.accDs=-this.accDs):0<e.body.linearVelocity.x&&(this.sendPushDoor(),this.playStringAnim(),this.down=!0,this.cDownSpeed=this.downSpeed,this.accDs=Math.abs(this.accDs))}cc.log(this.node.group)},playStringAnim:function(){this.stringAnim.playAnimation("newAnimation",1)},setKey:function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.o:e.doorDown(),e.sendPushDoor()}})},doorDown:function(){this.down||(this.isLeft?(this.down=!0,this.cDownSpeed=-this.downSpeed,this.accDs=-this.accDs):(this.down=!0,this.cDownSpeed=this.downSpeed,this.accDs=Math.abs(this.accDs)),this.playStringAnim())},sendPushDoor:function(){this.gameControl.socketManager.sendData(this.gameControl.socketManager.rootp11,i.NET_11011,{score:0,resultData:this.gameControl.stringToBytes(i.NET_UNIDOOR+","+this.gameControl.playerType+","+this.node.parent.name)})},update:function(t){this.node.rotation>=this.startRotation+90||this.node.rotation<=this.startRotation-90||this.down&&(this.isLeft&&this.node.rotation>this.leftEndPos?(this.cDownSpeed+=this.accDs,this.body.angularVelocity=this.cDownSpeed,this.gearBody.angularVelocity=this.cDownSpeed):!this.isLeft&&this.node.rotation<this.rightEndPos&&(this.cDownSpeed+=this.accDs,this.body.angularVelocity=this.cDownSpeed,this.gearBody.angularVelocity=this.cDownSpeed))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],WaterControl:[function(t,e,o){"use strict";cc._RF.push(e,"38e37/sye1N2K3cCYo2iGMZ","WaterControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.waterAnim=this.node.getComponent(cc.Animation)},start:function(){},update:function(t){},onBeginContact:function(t,e,o){if(o.node.group==i.FIRE||o.node.group==i.ICE){o.node.getComponent(i.PLAYER_CONTROL).becomeBall(),this.node.destroy()}else{e=this;this.waterAnim.play(),setTimeout(function(){e.node.destroy()},500)}}}),cc._RF.pop()},{GlobalData:"GlobalData"}],WaterWheelControl:[function(t,e,o){"use strict";cc._RF.push(e,"a0b94qMUXFOH4DJUrR36HFD","WaterWheelControl");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{waterWheel:cc.Node,accRotateSpeed:5,rotateSpeed:20,cars:{default:[],type:cc.Node},carNode:cc.Node,handcarStopTime:1},start:function(){},onLoad:function(){this.initValues()},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.lRotate=!1,this.rRotate=!1,this.cSpeed=0,this.whichMechanism()},whichMechanism:function(){var t=0;switch(this.mControl=new Array,this.gameControl.ContainsWords(i.HANDCAR_NODE,this.cars[0].name)&&(t=0),t){case 0:for(var e in this.cars)this.mControl[e]=this.cars[e].getComponent(i.HANDCAR_CONTROL);break;default:cc.log("未找到该机关！！！")}},leftRotate:function(){if(!this.lRotate)for(var t in this.stopRotate(),this.lRotate=!0,this.mControl)this.mControl[t].open()},rightRotate:function(){if(!this.rRotate)for(var t in this.stopRotate(),this.rRotate=!0,this.mControl)this.mControl[t].open()},stopRotate:function(){for(var t in this.cSpeed=0,this.lRotate=!1,this.rRotate=!1,this.mControl)this.mControl[t].close()},update:function(t){this.lRotate?(this.cSpeed-=this.accRotateSpeed,Math.abs(this.cSpeed)>this.rotateSpeed&&(this.cSpeed=-this.rotateSpeed),this.waterWheel.rotation-=this.cSpeed*t):this.rRotate?(this.cSpeed+=this.accRotateSpeed,this.cSpeed>this.rotateSpeed&&(this.cSpeed=this.rotateSpeed),this.waterWheel.rotation-=this.rotateSpeed*t):this.cSpeed<0?(this.cSpeed+=this.accRotateSpeed,0<=this.cSpeed&&(this.cSpeed=0)):0<this.cSpeed&&(this.cSpeed-=this.accRotateSpeed,this.cSpeed<=0&&(this.cSpeed=0),this.waterWheel.rotation-=this.rotateSpeed*t)}}),cc._RF.pop()},{GlobalData:"GlobalData"}],Weapon:[function(t,e,o){"use strict";cc._RF.push(e,"099c3fZ+UFDTbDDft5ABIvS","Weapon");var i=t("GlobalData");cc.Class({extends:cc.Component,properties:{isPutUp:!1,isThrowOut:!1,downDamping:20,boomAnim:cc.Animation},onLoad:function(){this.initValues()},initValues:function(){this.gameControl=cc.find(i.GAME_NAME).getComponent(i.GAME_CONTROL),this.down=!1,this.bulletXSpeed=0,this.playerControl=null,this.body=this.getComponent(cc.RigidBody)},start:function(){},onBeginContact:function(t,e,o){this.isThrowOut&&(this.body.linearVelocity=cc.v2(0,0),this.body.gravityScale=0,o.node.group==i.FIRE||o.node.group==i.ICE?this.bigBang(this.playerControl.playDead):this.bigBang(this.destroyNode),this.isThrowOut=!1),!this.isPutUp||o.node.group!=i.FIRE&&o.node.group!=i.ICE||(this.bigBang(this.playerControl.playDead),this.playerControl.isputUp=!1,this.isPutUp=!1)},bigBang:function(t){this.boomAnim.play(),this.boomAnim.on("finished",t,this)},destroyNode:function(){this.node.destroy()},putUpWeapon:function(t){this.node.getComponent(cc.PhysicsPolygonCollider).sensor=!0,this.isPutUp=!0,this.playerControl=t},throwOutWeapon:function(){this.isThrowOut=!0},startDown:function(t){this.isPutUp||(this.down=!0,this.bulletXSpeed=t)},update:function(t){this.down&&(this.bulletXSpeed-=this.downDamping,this.bulletXSpeed<=0&&(this.bulletXSpeed=0,this.down=!1),this.body.linearVelocity=cc.v2(this.bulletXSpeed,this.body.linearVelocity.y))}}),cc._RF.pop()},{GlobalData:"GlobalData"}],WindMillCar:[function(t,e,o){"use strict";cc._RF.push(e,"3ee1bQpb0xAsLAZcNHNCCUO","WindMillCar"),cc.Class({extends:cc.Component,properties:{car:cc.Node,carMoveSpeed:50,carRotateSpeed:30,stairs:{default:[],type:cc.Node}},onLoad:function(){this.carBody=this.car.getComponent(cc.RigidBody)},start:function(){},update:function(t){this.carBody.angularVelocity=this.carRotateSpeed},stairsPos:function(){}}),cc._RF.pop()},{}],WoodSpike:[function(t,e,o){"use strict";cc._RF.push(e,"c9043yu3GxOSrOh2ZQ5T4BD","WoodSpike"),cc.Class({extends:cc.Component,properties:{realObj:cc.Node,endPos:cc.Node,rotateSpeed:45},onLoad:function(){this.initValues()},initValues:function(){this.rotate=!1,this.startRotation=this.realObj.rotation,this.body=this.realObj.getComponent(cc.RigidBody)},start:function(){},open:function(){this.rotate=!0},close:function(){this.rotate=!1},update:function(t){this.rotate?this.realObj.rotation<this.endPos.rotation&&(this.body.angularVelocity=this.rotateSpeed):this.realObj.rotation>this.startRotation&&(this.body.angularVelocity=-this.rotateSpeed)}}),cc._RF.pop()},{}]},{},["ArrowControl","Game","GlobalData","BigCar","Bullet","BulletBase","BulletControl","Weapon","CloudControl","DamageControl","Door","DoorDefender","GravityCar","Stairs","Ground","LevelControl","PlatformControl","PressBtn","StickControl","TotalPressControl","PlayGameBg","PlayerControl","PlayerNodeControl","SpikeDoor","SpikeweedControl","PlayerBall","SprinklerControl","WaterControl","StarControl","Stone","TotalDoorControl","UniDoorControl","HandcarControl","WaterWheelControl","Flabellum","WindMillCar","WoodSpike","LevelBtn","MusicControl","NumBtn","UIFaceToFace","UIPass","UIPause","UISelect","UIStart","UITools","UITop","UiDead","SocketManager"]);